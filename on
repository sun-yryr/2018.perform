[1mdiff --git a/.circleci/config.yml b/.circleci/config.yml[m
[1mindex 569d3ce..0f00f9f 100644[m
[1m--- a/.circleci/config.yml[m
[1m+++ b/.circleci/config.yml[m
[36m@@ -1,60 +1,60 @@[m
[31m-# Javascript Node CircleCI 2.0 configuration file[m
[31m-#[m
[31m-# Check https://circleci.com/docs/2.0/language-javascript/ for more details[m
[31m-#[m
[31m-version: 2[m
[31m-jobs:[m
[31m-  build:[m
[31m-    working_directory: ~/2018.perform/[m
[31m-    docker:[m
[31m-      - image: circleci/node:7.10[m
[31m-    steps:[m
[31m-      - checkout[m
[31m-      - add_ssh_keys:[m
[31m-          fingerprints:[m
[31m-              - "1a:a6:fc:8f:09:ba:34:32:a0:ca:d8:97:de:ea:b0:35"[m
[31m-      - run: [m
[31m-          name: ssh setup [m
[31m-          command: |[m
[31m-              sudo apt-get update -y && sudo apt-get install -y --fix-missing ssh rsync[m
[31m-              ssh-keyscan ${AZURE_DEVELOP} >> ~/.ssh/known_hosts[m
[31m-              ssh-keyscan ${AZURE_PRODUCT} >> ~/.ssh/known_hosts[m
[31m-      - deploy:[m
[31m-          name: deploy develop branch[m
[31m-          command: |[m
[31m-              echo ${CIRCLE_BRANCH},${USER_NAME},${PRODUCTION_SERVER},${DEVELOPMENT_SERVER}[m
[31m-              if [ "${CIRCLE_BRANCH}" == "master" ]; then[m
[31m-                export SERVER=kfes@${AZURE_PRODUCT}[m
[31m-                rsync -av --delete ./scripts/setup.develop.sh ${SERVER}:/home/kfes/dep/setup.sh 2>&1 >/dev/null[m
[31m-                rsync -av --delete ./static ${SERVER}:/home/kfes/dep 2>&1 >/dev/null[m
[31m-                rsync -av --delete ./bot ${SERVER}:/home/kfes/dep 2>&1 >/dev/null[m
[31m-                rsync -av --delete ./api-server ${SERVER}:/home/kfes/dep 2>&1 >/dev/null[m
[31m-                ssh ${SERVER} 'bash /home/kfes/dep/setup.sh $CIRCLECI_DEPLOY_NUM'[m
[31m-              else[m
[31m-                export SERVER=kfes@${AZURE_DEVELOP}[m
[31m-                rsync -av --delete ./scripts/setup.develop.sh ${SERVER}:/home/kfes/dep/setup.sh 2>&1 >/dev/null[m
[31m-                rsync -av --delete ./static ${SERVER}:/home/kfes/dep 2>&1 >/dev/null[m
[31m-                ssh ${SERVER} 'bash /home/kfes/dep/setup.sh $CIRCLECI_DEPLOY_NUM'[m
[31m-              fi[m
[31m-[m
[31m-  test:[m
[31m-    working_directory: ~/2018.perform/[m
[31m-        #    working_directory: ~/api-server[m
[31m-    docker:[m
[31m-      - image: circleci/node:7.10[m
[31m-    steps:[m
[31m-      - checkout[m
[31m-      - restore_cache:[m
[31m-          keys:[m
[31m-          - v1-dependencies-{{ checksum "api-server/package.json" }}[m
[31m-          - v1-dependencies-[m
[31m-      - run: [m
[31m-          name: test express server[m
[31m-          working_directory: ~/2018.perform/api-server[m
[31m-          command: yarn test[m
[31m-[m
[31m-workflows:[m
[31m-  version: 2[m
[31m-  build_and_test:[m
[31m-    jobs:[m
[31m-      - build[m
[32m+[m[32m# Javascript Node CircleCI 2.0 configuration file[m[41m[m
[32m+[m[32m#[m[41m[m
[32m+[m[32m# Check https://circleci.com/docs/2.0/language-javascript/ for more details[m[41m[m
[32m+[m[32m#[m[41m[m
[32m+[m[32mversion: 2[m[41m[m
[32m+[m[32mjobs:[m[41m[m
[32m+[m[32m  build:[m[41m[m
[32m+[m[32m    working_directory: ~/2018.perform/[m[41m[m
[32m+[m[32m    docker:[m[41m[m
[32m+[m[32m      - image: circleci/node:7.10[m[41m[m
[32m+[m[32m    steps:[m[41m[m
[32m+[m[32m      - checkout[m[41m[m
[32m+[m[32m      - add_ssh_keys:[m[41m[m
[32m+[m[32m          fingerprints:[m[41m[m
[32m+[m[32m              - "1a:a6:fc:8f:09:ba:34:32:a0:ca:d8:97:de:ea:b0:35"[m[41m[m
[32m+[m[32m      - run:[m[41m [m
[32m+[m[32m          name: ssh setup[m[41m [m
[32m+[m[32m          command: |[m[41m[m
[32m+[m[32m              sudo apt-get update -y && sudo apt-get install -y --fix-missing ssh rsync[m[41m[m
[32m+[m[32m              ssh-keyscan ${AZURE_DEVELOP} >> ~/.ssh/known_hosts[m[41m[m
[32m+[m[32m              ssh-keyscan ${AZURE_PRODUCT} >> ~/.ssh/known_hosts[m[41m[m
[32m+[m[32m      - deploy:[m[41m[m
[32m+[m[32m          name: deploy develop branch[m[41m[m
[32m+[m[32m          command: |[m[41m[m
[32m+[m[32m              echo ${CIRCLE_BRANCH},${USER_NAME},${PRODUCTION_SERVER},${DEVELOPMENT_SERVER}[m[41m[m
[32m+[m[32m              if [ "${CIRCLE_BRANCH}" == "master" ]; then[m[41m[m
[32m+[m[32m                export SERVER=kfes@${AZURE_PRODUCT}[m[41m[m
[32m+[m[32m                rsync -av --delete ./scripts/setup.develop.sh ${SERVER}:/home/kfes/dep/setup.sh 2>&1 >/dev/null[m[41m[m
[32m+[m[32m                rsync -av --delete ./static ${SERVER}:/home/kfes/dep 2>&1 >/dev/null[m[41m[m
[32m+[m[32m                rsync -av --delete ./bot ${SERVER}:/home/kfes/dep 2>&1 >/dev/null[m[41m[m
[32m+[m[32m                rsync -av --delete ./api-server ${SERVER}:/home/kfes/dep 2>&1 >/dev/null[m[41m[m
[32m+[m[32m                ssh ${SERVER} 'bash /home/kfes/dep/setup.sh $CIRCLECI_DEPLOY_NUM'[m[41m[m
[32m+[m[32m              else[m[41m[m
[32m+[m[32m                export SERVER=kfes@${AZURE_DEVELOP}[m[41m[m
[32m+[m[32m                rsync -av --delete ./scripts/setup.develop.sh ${SERVER}:/home/kfes/dep/setup.sh 2>&1 >/dev/null[m[41m[m
[32m+[m[32m                rsync -av --delete ./static ${SERVER}:/home/kfes/dep 2>&1 >/dev/null[m[41m[m
[32m+[m[32m                ssh ${SERVER} 'bash /home/kfes/dep/setup.sh $CIRCLECI_DEPLOY_NUM'[m[41m[m
[32m+[m[32m              fi[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  test:[m[41m[m
[32m+[m[32m    working_directory: ~/2018.perform/[m[41m[m
[32m+[m[32m        #    working_directory: ~/api-server[m[41m[m
[32m+[m[32m    docker:[m[41m[m
[32m+[m[32m      - image: circleci/node:7.10[m[41m[m
[32m+[m[32m    steps:[m[41m[m
[32m+[m[32m      - checkout[m[41m[m
[32m+[m[32m      - restore_cache:[m[41m[m
[32m+[m[32m          keys:[m[41m[m
[32m+[m[32m          - v1-dependencies-{{ checksum "api-server/package.json" }}[m[41m[m
[32m+[m[32m          - v1-dependencies-[m[41m[m
[32m+[m[32m      - run:[m[41m [m
[32m+[m[32m          name: test express server[m[41m[m
[32m+[m[32m          working_directory: ~/2018.perform/api-server[m[41m[m
[32m+[m[32m          command: yarn test[m[41m[m
[32m+[m[41m[m
[32m+[m[32mworkflows:[m[41m[m
[32m+[m[32m  version: 2[m[41m[m
[32m+[m[32m  build_and_test:[m[41m[m
[32m+[m[32m    jobs:[m[41m[m
[32m+[m[32m      - build[m[41m[m
[1mdiff --git a/.gitignore b/.gitignore[m
[1mindex c8776b3..19c4ce7 100644[m
[1m--- a/.gitignore[m
[1m+++ b/.gitignore[m
[36m@@ -1,97 +1,97 @@[m
[31m-# [m
[31m-/logs[m
[31m-*.swp[m
[31m-[m
[31m-# Created by https://www.gitignore.io/api/node[m
[31m-[m
[31m-static/db.json[m
[31m-public*[m
[31m-.*[m
[31m-### Node ###[m
[31m-# Logs[m
[31m-logs[m
[31m-*.log[m
[31m-npm-debug.log*[m
[31m-yarn-debug.log*[m
[31m-yarn-error.log*[m
[31m-public*[m
[31m-# Runtime data[m
[31m-pids[m
[31m-*.pid[m
[31m-*.seed[m
[31m-*.pid.lock[m
[31m-[m
[31m-# Directory for instrumented libs generated by jscoverage/JSCover[m
[31m-lib-cov[m
[31m-[m
[31m-# Coverage directory used by tools like istanbul[m
[31m-coverage[m
[31m-[m
[31m-# nyc test coverage[m
[31m-.nyc_output[m
[31m-[m
[31m-# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)[m
[31m-.grunt[m
[31m-[m
[31m-# Bower dependency directory (https://bower.io/)[m
[31m-bower_components[m
[31m-[m
[31m-# node-waf configuration[m
[31m-.lock-wscript[m
[31m-[m
[31m-# Compiled binary addons (https://nodejs.org/api/addons.html)[m
[31m-build/Release[m
[31m-[m
[31m-# Dependency directories[m
[31m-node_modules/[m
[31m-jspm_packages/[m
[31m-[m
[31m-# TypeScript v1 declaration files[m
[31m-typings/[m
[31m-[m
[31m-# Optional npm cache directory[m
[31m-.npm[m
[31m-[m
[31m-# Optional eslint cache[m
[31m-.eslintcache[m
[31m-[m
[31m-# Optional REPL history[m
[31m-.node_repl_history[m
[31m-[m
[31m-# Output of 'npm pack'[m
[31m-*.tgz[m
[31m-[m
[31m-# Yarn Integrity file[m
[31m-.yarn-integrity[m
[31m-[m
[31m-# dotenv environment variables file[m
[31m-.env[m
[31m-[m
[31m-# parcel-bundler cache (https://parceljs.org/)[m
[31m-.cache[m
[31m-[m
[31m-# next.js build output[m
[31m-.next[m
[31m-[m
[31m-# nuxt.js build output[m
[31m-.nuxt[m
[31m-[m
[31m-# vuepress build output[m
[31m-.vuepress/dist[m
[31m-[m
[31m-# Serverless directories[m
[31m-.serverless[m
[31m-[m
[31m-[m
[31m-# End of https://www.gitignore.io/api/node[m
[31m-node_modules[m
[31m-package-lock.json[m
[31m-workspace/[m
[31m-bootstrap[m
[31m-account.json[m
[31m-shop.json[m
[31m-private/[m
[31m-*.env[m
[31m-public[m
[31m-db.json[m
[31m-.*.sw*[m
[32m+[m[32m#[m[41m [m
[32m+[m[32m/logs[m[41m[m
[32m+[m[32m*.swp[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Created by https://www.gitignore.io/api/node[m[41m[m
[32m+[m[41m[m
[32m+[m[32mstatic/db.json[m[41m[m
[32m+[m[32mpublic*[m[41m[m
[32m+[m[32m.*[m[41m[m
[32m+[m[32m### Node ###[m[41m[m
[32m+[m[32m# Logs[m[41m[m
[32m+[m[32mlogs[m[41m[m
[32m+[m[32m*.log[m[41m[m
[32m+[m[32mnpm-debug.log*[m[41m[m
[32m+[m[32myarn-debug.log*[m[41m[m
[32m+[m[32myarn-error.log*[m[41m[m
[32m+[m[32mpublic*[m[41m[m
[32m+[m[32m# Runtime data[m[41m[m
[32m+[m[32mpids[m[41m[m
[32m+[m[32m*.pid[m[41m[m
[32m+[m[32m*.seed[m[41m[m
[32m+[m[32m*.pid.lock[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Directory for instrumented libs generated by jscoverage/JSCover[m[41m[m
[32m+[m[32mlib-cov[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Coverage directory used by tools like istanbul[m[41m[m
[32m+[m[32mcoverage[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# nyc test coverage[m[41m[m
[32m+[m[32m.nyc_output[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)[m[41m[m
[32m+[m[32m.grunt[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Bower dependency directory (https://bower.io/)[m[41m[m
[32m+[m[32mbower_components[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# node-waf configuration[m[41m[m
[32m+[m[32m.lock-wscript[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Compiled binary addons (https://nodejs.org/api/addons.html)[m[41m[m
[32m+[m[32mbuild/Release[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Dependency directories[m[41m[m
[32m+[m[32mnode_modules/[m[41m[m
[32m+[m[32mjspm_packages/[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# TypeScript v1 declaration files[m[41m[m
[32m+[m[32mtypings/[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Optional npm cache directory[m[41m[m
[32m+[m[32m.npm[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Optional eslint cache[m[41m[m
[32m+[m[32m.eslintcache[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Optional REPL history[m[41m[m
[32m+[m[32m.node_repl_history[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Output of 'npm pack'[m[41m[m
[32m+[m[32m*.tgz[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Yarn Integrity file[m[41m[m
[32m+[m[32m.yarn-integrity[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# dotenv environment variables file[m[41m[m
[32m+[m[32m.env[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# parcel-bundler cache (https://parceljs.org/)[m[41m[m
[32m+[m[32m.cache[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# next.js build output[m[41m[m
[32m+[m[32m.next[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# nuxt.js build output[m[41m[m
[32m+[m[32m.nuxt[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# vuepress build output[m[41m[m
[32m+[m[32m.vuepress/dist[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Serverless directories[m[41m[m
[32m+[m[32m.serverless[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# End of https://www.gitignore.io/api/node[m[41m[m
[32m+[m[32mnode_modules[m[41m[m
[32m+[m[32mpackage-lock.json[m[41m[m
[32m+[m[32mworkspace/[m[41m[m
[32m+[m[32mbootstrap[m[41m[m
[32m+[m[32maccount.json[m[41m[m
[32m+[m[32mshop.json[m[41m[m
[32m+[m[32mprivate/[m[41m[m
[32m+[m[32m*.env[m[41m[m
[32m+[m[32mpublic[m[41m[m
[32m+[m[32mdb.json[m[41m[m
[32m+[m[32m.*.sw*[m[41m[m
[1mdiff --git a/api-server/package.json b/api-server/package.json[m
[1mindex ec62c39..a1b2aa8 100644[m
[1m--- a/api-server/package.json[m
[1m+++ b/api-server/package.json[m
[36m@@ -1,30 +1,30 @@[m
[31m-{[m
[31m-  "name": "api-server",[m
[31m-  "version": "0.0.0",[m
[31m-  "private": true,[m
[31m-  "scripts": {[m
[31m-    "start": "node ./bin/www",[m
[31m-    "yr": "nodemon ./bin/www",[m
[31m-    "test": "node ./test/test.js"[m
[31m-  },[m
[31m-  "dependencies": {[m
[31m-    "cheerio-httpcli": "^0.7.3",[m
[31m-    "cookie-parser": "~1.4.3",[m
[31m-    "crypto": "^1.0.1",[m
[31m-    "debug": "~2.6.9",[m
[31m-    "dialogflow": "^0.6.0",[m
[31m-    "dropbox-v2-api": "^2.1.17",[m
[31m-    "express": "~4.16.0",[m
[31m-    "express-fluent-logger": "^0.3.0",[m
[31m-    "fluent-logger": "latest",[m
[31m-    "hbs": "~4.0.1",[m
[31m-    "http-errors": "~1.6.2",[m
[31m-    "moment": "^2.22.2",[m
[31m-    "morgan": "~1.9.0",[m
[31m-    "mysql": "^2.16.0",[m
[31m-    "nodemon": "^1.18.4",[m
[31m-    "request": "^2.88.0",[m
[31m-    "supertest": "^3.1.0"[m
[31m-  },[m
[31m-  "devDependencies": {}[m
[31m-}[m
[32m+[m[32m{[m[41m[m
[32m+[m[32m  "name": "api-server",[m[41m[m
[32m+[m[32m  "version": "0.0.0",[m[41m[m
[32m+[m[32m  "private": true,[m[41m[m
[32m+[m[32m  "scripts": {[m[41m[m
[32m+[m[32m    "start": "node ./bin/www",[m[41m[m
[32m+[m[32m    "yr": "nodemon ./bin/www",[m[41m[m
[32m+[m[32m    "test": "node ./test/test.js"[m[41m[m
[32m+[m[32m  },[m[41m[m
[32m+[m[32m  "dependencies": {[m[41m[m
[32m+[m[32m    "cheerio-httpcli": "^0.7.3",[m[41m[m
[32m+[m[32m    "cookie-parser": "~1.4.3",[m[41m[m
[32m+[m[32m    "crypto": "^1.0.1",[m[41m[m
[32m+[m[32m    "debug": "~2.6.9",[m[41m[m
[32m+[m[32m    "dialogflow": "^0.6.0",[m[41m[m
[32m+[m[32m    "dropbox-v2-api": "^2.1.17",[m[41m[m
[32m+[m[32m    "express": "~4.16.0",[m[41m[m
[32m+[m[32m    "express-fluent-logger": "^0.3.0",[m[41m[m
[32m+[m[32m    "fluent-logger": "latest",[m[41m[m
[32m+[m[32m    "hbs": "~4.0.1",[m[41m[m
[32m+[m[32m    "http-errors": "~1.6.2",[m[41m[m
[32m+[m[32m    "moment": "^2.22.2",[m[41m[m
[32m+[m[32m    "morgan": "~1.9.0",[m[41m[m
[32m+[m[32m    "mysql": "^2.16.0",[m[41m[m
[32m+[m[32m    "nodemon": "^1.18.4",[m[41m[m
[32m+[m[32m    "request": "^2.88.0",[m[41m[m
[32m+[m[32m    "supertest": "^3.1.0"[m[41m[m
[32m+[m[32m  },[m[41m[m
[32m+[m[32m  "devDependencies": {}[m[41m[m
[32m+[m[32m}[m[41m[m
[1mdiff --git a/api-server/routes/beacondb.js b/api-server/routes/beacondb.js[m
[1mindex c91aa27..6a760cf 100644[m
[1m--- a/api-server/routes/beacondb.js[m
[1m+++ b/api-server/routes/beacondb.js[m
[36m@@ -1,87 +1,87 @@[m
[31m-var express = require('express');[m
[31m-var router = express.Router();[m
[31m-var request = require('request');[m
[31m-var moment = require('moment');[m
[31m-var connection = require('./mysqlConnection');[m
[31m-[m
[31m-const INSERT = 'INSERT INTO BeaconData (BEACONID, MESSAGE, PLACE) VALUES ("{id}", "{msg}", "{place}")';[m
[31m-const UPDATE = 'UPDATE BeaconData SET MESSAGE = "{msg}" WHERE PLACE = "{place}"';[m
[31m-const U = 'UPDATE BeaconData SET MESSAGE = "{msg}" WHERE PLACE IS NOT NULL'[m
[31m-[m
[31m-/* MAIN */[m
[31m-router.post('/create', function(req, res, next) {[m
[31m-    //bodyの受け取り[m
[31m-    var body = req.body;[m
[31m-    var query = INSERT.replace("{id}", body.beaconid)[m
[31m-        .replace("{msg}", body.message)[m
[31m-        .replace("{place}", body.place);[m
[31m-    console.log(query);[m
[31m-    connection.query(query, function(err, rows) {[m
[31m-        console.log(rows);[m
[31m-        if (err) {[m
[31m-            res.status(403);[m
[31m-            res.send(err);[m
[31m-        } else {[m
[31m-            res.status(200);[m
[31m-            res.send(rows);[m
[31m-        }[m
[31m-    });[m
[31m-});[m
[31m-[m
[31m-router.post('/update', function(req, res, next) {[m
[31m-    //bodyの受け取り[m
[31m-    var body = req.body;[m
[31m-    var query = UPDATE.replace("{msg}", body.message)[m
[31m-        .replace("{place}", body.place);[m
[31m-    if (body.place == "ALL") {[m
[31m-        query = U.replace("{msg}", body.message);[m
[31m-    }[m
[31m-    connection.query(query, function(err, rows) {[m
[31m-        console.log(rows);[m
[31m-        if (err) {[m
[31m-            res.status(403);[m
[31m-            res.send(err);[m
[31m-        } else {[m
[31m-            res.status(200);[m
[31m-            res.send(rows);[m
[31m-        }[m
[31m-    });[m
[31m-});[m
[31m-[m
[31m-router.post('/delete', function(req, res, next) {[m
[31m-    var query = 'DELETE FROM BeaconData WHERE BEACONID = "{id}"'[m
[31m-        .replace("{id}", req.body.beaconid);[m
[31m-    connection.query(query, function(err, rows) {[m
[31m-        if (err) {[m
[31m-            res.status(403);[m
[31m-            res.send(err);[m
[31m-        } else {[m
[31m-            res.status(200);[m
[31m-            res.send(rows);[m
[31m-        }[m
[31m-    });[m
[31m-});[m
[31m-[m
[31m-router.get('/get', function(req, res, next) {[m
[31m-    var query = "SELECT * FROM BeaconData";[m
[31m-    connection.query(query, function(err, rows) {[m
[31m-        if (err) {[m
[31m-            res.status(403);[m
[31m-            res.send(err);[m
[31m-        } else {[m
[31m-            var msg = [];[m
[31m-            for(var i=0; i<rows.length; i++) {[m
[31m-                var tmp = {[m
[31m-                    "beaconid": rows[i]["BEACONID"],[m
[31m-                    "message": rows[i]["MESSAGE"],[m
[31m-                    "place": rows[i]["PLACE"][m
[31m-                };[m
[31m-                msg.push(tmp);[m
[31m-            }[m
[31m-            res.status(200);[m
[31m-            res.send(msg);[m
[31m-        }[m
[31m-    })[m
[31m-});[m
[31m-[m
[31m-module.exports = router;[m
[32m+[m[32mvar express = require('express');[m[41m[m
[32m+[m[32mvar router = express.Router();[m[41m[m
[32m+[m[32mvar request = require('request');[m[41m[m
[32m+[m[32mvar moment = require('moment');[m[41m[m
[32m+[m[32mvar connection = require('./mysqlConnection');[m[41m[m
[32m+[m[41m[m
[32m+[m[32mconst INSERT = 'INSERT INTO BeaconData (BEACONID, MESSAGE, PLACE) VALUES ("{id}", "{msg}", "{place}")';[m[41m[m
[32m+[m[32mconst UPDATE = 'UPDATE BeaconData SET MESSAGE = "{msg}" WHERE PLACE = "{place}"';[m[41m[m
[32m+[m[32mconst U = 'UPDATE BeaconData SET MESSAGE = "{msg}" WHERE PLACE IS NOT NULL'[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/* MAIN */[m[41m[m
[32m+[m[32mrouter.post('/create', function(req, res, next) {[m[41m[m
[32m+[m[32m    //bodyの受け取り[m[41m[m
[32m+[m[32m    var body = req.body;[m[41m[m
[32m+[m[32m    var query = INSERT.replace("{id}", body.beaconid)[m[41m[m
[32m+[m[32m        .replace("{msg}", body.message)[m[41m[m
[32m+[m[32m        .replace("{place}", body.place);[m[41m[m
[32m+[m[32m    console.log(query);[m[41m[m
[32m+[m[32m    connection.query(query, function(err, rows) {[m[41m[m
[32m+[m[32m        console.log(rows);[m[41m[m
[32m+[m[32m        if (err) {[m[41m[m
[32m+[m[32m            res.status(403);[m[41m[m
[32m+[m[32m            res.send(err);[m[41m[m
[32m+[m[32m        } else {[m[41m[m
[32m+[m[32m            res.status(200);[m[41m[m
[32m+[m[32m            res.send(rows);[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mrouter.post('/update', function(req, res, next) {[m[41m[m
[32m+[m[32m    //bodyの受け取り[m[41m[m
[32m+[m[32m    var body = req.body;[m[41m[m
[32m+[m[32m    var query = UPDATE.replace("{msg}", body.message)[m[41m[m
[32m+[m[32m        .replace("{place}", body.place);[m[41m[m
[32m+[m[32m    if (body.place == "ALL") {[m[41m[m
[32m+[m[32m        query = U.replace("{msg}", body.message);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    connection.query(query, function(err, rows) {[m[41m[m
[32m+[m[32m        console.log(rows);[m[41m[m
[32m+[m[32m        if (err) {[m[41m[m
[32m+[m[32m            res.status(403);[m[41m[m
[32m+[m[32m            res.send(err);[m[41m[m
[32m+[m[32m        } else {[m[41m[m
[32m+[m[32m            res.status(200);[m[41m[m
[32m+[m[32m            res.send(rows);[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mrouter.post('/delete', function(req, res, next) {[m[41m[m
[32m+[m[32m    var query = 'DELETE FROM BeaconData WHERE BEACONID = "{id}"'[m[41m[m
[32m+[m[32m        .replace("{id}", req.body.beaconid);[m[41m[m
[32m+[m[32m    connection.query(query, function(err, rows) {[m[41m[m
[32m+[m[32m        if (err) {[m[41m[m
[32m+[m[32m            res.status(403);[m[41m[m
[32m+[m[32m            res.send(err);[m[41m[m
[32m+[m[32m        } else {[m[41m[m
[32m+[m[32m            res.status(200);[m[41m[m
[32m+[m[32m            res.send(rows);[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mrouter.get('/get', function(req, res, next) {[m[41m[m
[32m+[m[32m    var query = "SELECT * FROM BeaconData";[m[41m[m
[32m+[m[32m    connection.query(query, function(err, rows) {[m[41m[m
[32m+[m[32m        if (err) {[m[41m[m
[32m+[m[32m            res.status(403);[m[41m[m
[32m+[m[32m            res.send(err);[m[41m[m
[32m+[m[32m        } else {[m[41m[m
[32m+[m[32m            var msg = [];[m[41m[m
[32m+[m[32m            for(var i=0; i<rows.length; i++) {[m[41m[m
[32m+[m[32m                var tmp = {[m[41m[m
[32m+[m[32m                    "beaconid": rows[i]["BEACONID"],[m[41m[m
[32m+[m[32m                    "message": rows[i]["MESSAGE"],[m[41m[m
[32m+[m[32m                    "place": rows[i]["PLACE"][m[41m[m
[32m+[m[32m                };[m[41m[m
[32m+[m[32m                msg.push(tmp);[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m            res.status(200);[m[41m[m
[32m+[m[32m            res.send(msg);[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    })[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mmodule.exports = router;[m[41m[m
[1mdiff --git a/api-server/routes/boothID.json b/api-server/routes/boothID.json[m
[1mindex 19a85bf..d923d56 100644[m
[1m--- a/api-server/routes/boothID.json[m
[1m+++ b/api-server/routes/boothID.json[m
[36m@@ -1,64 +1,64 @@[m
[31m-{[m
[31m-	"OutsideA1": "v4E",[m
[31m-	"OutsideA2": "abd",[m
[31m-	"OutsideA3": "c4C",[m
[31m-	"OutsideA4": "cm",[m
[31m-	"OutsideA5": "htb",[m
[31m-	"OutsideB1": "c2D",[m
[31m-	"OutsideB2": "hb",[m
[31m-	"OutsideB3": "v2AC",[m
[31m-	"OutsideB4": "bsk",[m
[31m-	"OutsideC1": "v5E",[m
[31m-	"OutsideC2": "v2M",[m
[31m-	"OutsideD1": "fb",[m
[31m-	"OutsideD2": "bd",[m
[31m-	"OutsideD3": "kusa",[m
[31m-	"OutsideD4": "sw",[m
[31m-	"OutsideD5": "yku",[m
[31m-	"OutsideD6": "vb",[m
[31m-	"OutsideD7": "fs",[m
[31m-	"OutsideD8": "1AC",[m
[31m-	"OutsideE1": "hl",[m
[31m-	"OutsideE2": "v5C",[m
[31m-	"OutsideE3": "c4J",[m
[31m-	"OutsideE4": "tnf",[m
[31m-	"OutsideE5": "v3D",[m
[31m-	"OutsideE6": "cyc",[m
[31m-	"OutsideF1": "c2C",[m
[31m-	"OutsideF2": "c4M",[m
[31m-	"OutsideF3": "v5E",[m
[31m-	"Inside211": "mada",[m
[31m-	"Inside212": "mada",[m
[31m-	"Inside213": "mada",[m
[31m-	"Inside214": "mada",[m
[31m-	"Inside221": "mada",[m
[31m-	"Inside222": "mada",[m
[31m-	"Inside223": "mada",[m
[31m-	"Inside224": "mada",[m
[31m-	"Inside225": "mada",[m
[31m-	"Inside231": "mada",[m
[31m-	"Inside232": "mada",[m
[31m-	"Inside233": "mada",[m
[31m-	"Inside234": "mada",[m
[31m-	"Inside235": "mada",[m
[31m-	"Inside241": "mada",[m
[31m-	"Inside242": "mada",[m
[31m-	"Inside243": "mada",[m
[31m-	"Inside244": "mada",[m
[31m-	"Inside245": "mada",[m
[31m-	"Inside311": "mada",[m
[31m-	"Inside312": "mada",[m
[31m-	"Inside321": "mada",[m
[31m-	"Inside322": "mada",[m
[31m-	"Inside331": "mada",[m
[31m-	"Inside332": "mada",[m
[31m-	"Inside341": "mada",[m
[31m-	"Inside342": "mada",[m
[31m-	"Inside511": "mada",[m
[31m-	"Inside512": "mada",[m
[31m-	"Inside521": "mada",[m
[31m-	"Inside811": "mada",[m
[31m-	"Inside812": "mada",[m
[31m-	"Inside821": "mada",[m
[31m-	"Inside822": "mada"[m
[32m+[m[32m{[m[41m[m
[32m+[m	[32m"OutsideA1": "v4E",[m[41m[m
[32m+[m	[32m"OutsideA2": "abd",[m[41m[m
[32m+[m	[32m"OutsideA3": "c4C",[m[41m[m
[32m+[m	[32m"OutsideA4": "cm",[m[41m[m
[32m+[m	[32m"OutsideA5": "htb",[m[41m[m
[32m+[m	[32m"OutsideB1": "c2D",[m[41m[m
[32m+[m	[32m"OutsideB2": "hb",[m[41m[m
[32m+[m	[32m"OutsideB3": "v2AC",[m[41m[m
[32m+[m	[32m"OutsideB4": "bsk",[m[41m[m
[32m+[m	[32m"OutsideC1": "v5E",[m[41m[m
[32m+[m	[32m"OutsideC2": "v2M",[m[41m[m
[32m+[m	[32m"OutsideD1": "fb",[m[41m[m
[32m+[m	[32m"OutsideD2": "bd",[m[41m[m
[32m+[m	[32m"OutsideD3": "kusa",[m[41m[m
[32m+[m	[32m"OutsideD4": "sw",[m[41m[m
[32m+[m	[32m"OutsideD5": "yku",[m[41m[m
[32m+[m	[32m"OutsideD6": "vb",[m[41m[m
[32m+[m	[32m"OutsideD7": "fs",[m[41m[m
[32m+[m	[32m"OutsideD8": "1AC",[m[41m[m
[32m+[m	[32m"OutsideE1": "hl",[m[41m[m
[32m+[m	[32m"OutsideE2": "v5C",[m[41m[m
[32m+[m	[32m"OutsideE3": "c4J",[m[41m[m
[32m+[m	[32m"OutsideE4": "tnf",[m[41m[m
[32m+[m	[32m"OutsideE5": "v3D",[m[41m[m
[32m+[m	[32m"OutsideE6": "cyc",[m[41m[m
[32m+[m	[32m"OutsideF1": "c2C",[m[41m[m
[32m+[m	[32m"OutsideF2": "c4M",[m[41m[m
[32m+[m	[32m"OutsideF3": "v5E",[m[41m[m
[32m+[m	[32m"Inside211": "mada",[m[41m[m
[32m+[m	[32m"Inside212": "mada",[m[41m[m
[32m+[m	[32m"Inside213": "mada",[m[41m[m
[32m+[m	[32m"Inside214": "mada",[m[41m[m
[32m+[m	[32m"Inside221": "mada",[m[41m[m
[32m+[m	[32m"Inside222": "mada",[m[41m[m
[32m+[m	[32m"Inside223": "mada",[m[41m[m
[32m+[m	[32m"Inside224": "mada",[m[41m[m
[32m+[m	[32m"Inside225": "mada",[m[41m[m
[32m+[m	[32m"Inside231": "mada",[m[41m[m
[32m+[m	[32m"Inside232": "mada",[m[41m[m
[32m+[m	[32m"Inside233": "mada",[m[41m[m
[32m+[m	[32m"Inside234": "mada",[m[41m[m
[32m+[m	[32m"Inside235": "mada",[m[41m[m
[32m+[m	[32m"Inside241": "mada",[m[41m[m
[32m+[m	[32m"Inside242": "mada",[m[41m[m
[32m+[m	[32m"Inside243": "mada",[m[41m[m
[32m+[m	[32m"Inside244": "mada",[m[41m[m
[32m+[m	[32m"Inside245": "mada",[m[41m[m
[32m+[m	[32m"Inside311": "mada",[m[41m[m
[32m+[m	[32m"Inside312": "mada",[m[41m[m
[32m+[m	[32m"Inside321": "mada",[m[41m[m
[32m+[m	[32m"Inside322": "mada",[m[41m[m
[32m+[m	[32m"Inside331": "mada",[m[41m[m
[32m+[m	[32m"Inside332": "mada",[m[41m[m
[32m+[m	[32m"Inside341": "mada",[m[41m[m
[32m+[m	[32m"Inside342": "mada",[m[41m[m
[32m+[m	[32m"Inside511": "mada",[m[41m[m
[32m+[m	[32m"Inside512": "mada",[m[41m[m
[32m+[m	[32m"Inside521": "mada",[m[41m[m
[32m+[m	[32m"Inside811": "mada",[m[41m[m
[32m+[m	[32m"Inside812": "mada",[m[41m[m
[32m+[m	[32m"Inside821": "mada",[m[41m[m
[32m+[m	[32m"Inside822": "mada"[m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/api-server/routes/flex_item.json b/api-server/routes/flex_item.json[m
[1mindex 5105e7f..7b3d64f 100644[m
[1m--- a/api-server/routes/flex_item.json[m
[1m+++ b/api-server/routes/flex_item.json[m
[36m@@ -1,24 +1,24 @@[m
[31m-{[m
[31m-  "type": "box",[m
[31m-  "layout": "horizontal",[m
[31m-  "margin": "md",[m
[31m-  "contents": [[m
[31m-      {[m
[31m-          "type": "text",[m
[31m-          "text": "",[m
[31m-          "wrap": true,[m
[31m-          "weight": "bold",[m
[31m-          "size": "md",[m
[31m-          "align": "start",[m
[31m-          "flex": 0[m
[31m-      },[m
[31m-      {[m
[31m-          "type": "text",[m
[31m-          "text": "",[m
[31m-          "wrap": true,[m
[31m-          "weight": "bold",[m
[31m-          "size": "md",[m
[31m-          "align": "end"[m
[31m-      }[m
[31m-  ][m
[32m+[m[32m{[m[41m[m
[32m+[m[32m  "type": "box",[m[41m[m
[32m+[m[32m  "layout": "horizontal",[m[41m[m
[32m+[m[32m  "margin": "md",[m[41m[m
[32m+[m[32m  "contents": [[m[41m[m
[32m+[m[32m      {[m[41m[m
[32m+[m[32m          "type": "text",[m[41m[m
[32m+[m[32m          "text": "",[m[41m[m
[32m+[m[32m          "wrap": true,[m[41m[m
[32m+[m[32m          "weight": "bold",[m[41m[m
[32m+[m[32m          "size": "md",[m[41m[m
[32m+[m[32m          "align": "start",[m[41m[m
[32m+[m[32m          "flex": 0[m[41m[m
[32m+[m[32m      },[m[41m[m
[32m+[m[32m      {[m[41m[m
[32m+[m[32m          "type": "text",[m[41m[m
[32m+[m[32m          "text": "",[m[41m[m
[32m+[m[32m          "wrap": true,[m[41m[m
[32m+[m[32m          "weight": "bold",[m[41m[m
[32m+[m[32m          "size": "md",[m[41m[m
[32m+[m[32m          "align": "end"[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m  ][m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/api-server/routes/flex_template.json b/api-server/routes/flex_template.json[m
[1mindex 5efb4dc..19f63c2 100644[m
[1m--- a/api-server/routes/flex_template.json[m
[1m+++ b/api-server/routes/flex_template.json[m
[36m@@ -1,63 +1,63 @@[m
[31m-{[m
[31m-  "type": "bubble",[m
[31m-  "header": {[m
[31m-      "type": "box",[m
[31m-      "layout": "vertical",[m
[31m-      "contents": [[m
[31m-          {[m
[31m-          "type": "text",[m
[31m-          "text": "",[m
[31m-          "weight": "bold",[m
[31m-          "size": "lg",[m
[31m-          "wrap": true[m
[31m-          }[m
[31m-      ][m
[31m-  },[m
[31m-  "hero": {[m
[31m-      "type": "image",[m
[31m-      "size": "full",[m
[31m-      "aspectRatio": "20:13",[m
[31m-      "aspectMode": "cover",[m
[31m-      "url": ""[m
[31m-  },[m
[31m-  "body": {[m
[31m-      "type": "box",[m
[31m-      "layout": "vertical",[m
[31m-      "contents": [[m
[31m-          {[m
[31m-          "type": "text",[m
[31m-          "text": "商品",[m
[31m-          "wrap": false,[m
[31m-          "weight": "bold",[m
[31m-          "size": "md"[m
[31m-          },[m
[31m-          {[m
[31m-          "type": "separator",[m
[31m-          "margin": "sm"[m
[31m-          }[m
[31m-      ][m
[31m-  },[m
[31m-  "footer": {[m
[31m-      "type": "box",[m
[31m-      "layout": "vertical",[m
[31m-      "contents": [[m
[31m-          {[m
[31m-              "type": "separator"[m
[31m-          },[m
[31m-          {[m
[31m-              "type": "text",[m
[31m-              "text": "地図",[m
[31m-              "weight": "bold",[m
[31m-              "margin": "md"[m
[31m-          },[m
[31m-          {[m
[31m-              "type": "image",[m
[31m-              "size": "full",[m
[31m-              "margin": "md",[m
[31m-              "aspectRatio": "16:9",[m
[31m-              "aspectMode": "cover",[m
[31m-              "url": ""[m
[31m-          }[m
[31m-      ][m
[31m-  }[m
[32m+[m[32m{[m[41m[m
[32m+[m[32m  "type": "bubble",[m[41m[m
[32m+[m[32m  "header": {[m[41m[m
[32m+[m[32m      "type": "box",[m[41m[m
[32m+[m[32m      "layout": "vertical",[m[41m[m
[32m+[m[32m      "contents": [[m[41m[m
[32m+[m[32m          {[m[41m[m
[32m+[m[32m          "type": "text",[m[41m[m
[32m+[m[32m          "text": "",[m[41m[m
[32m+[m[32m          "weight": "bold",[m[41m[m
[32m+[m[32m          "size": "lg",[m[41m[m
[32m+[m[32m          "wrap": true[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m      ][m[41m[m
[32m+[m[32m  },[m[41m[m
[32m+[m[32m  "hero": {[m[41m[m
[32m+[m[32m      "type": "image",[m[41m[m
[32m+[m[32m      "size": "full",[m[41m[m
[32m+[m[32m      "aspectRatio": "20:13",[m[41m[m
[32m+[m[32m      "aspectMode": "cover",[m[41m[m
[32m+[m[32m      "url": ""[m[41m[m
[32m+[m[32m  },[m[41m[m
[32m+[m[32m  "body": {[m[41m[m
[32m+[m[32m      "type": "box",[m[41m[m
[32m+[m[32m      "layout": "vertical",[m[41m[m
[32m+[m[32m      "contents": [[m[41m[m
[32m+[m[32m          {[m[41m[m
[32m+[m[32m          "type": "text",[m[41m[m
[32m+[m[32m          "text": "商品",[m[41m[m
[32m+[m[32m          "wrap": false,[m[41m[m
[32m+[m[32m          "weight": "bold",[m[41m[m
[32m+[m[32m          "size": "md"[m[41m[m
[32m+[m[32m          },[m[41m[m
[32m+[m[32m          {[m[41m[m
[32m+[m[32m          "type": "separator",[m[41m[m
[32m+[m[32m          "margin": "sm"[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m      ][m[41m[m
[32m+[m[32m  },[m[41m[m
[32m+[m[32m  "footer": {[m[41m[m
[32m+[m[32m      "type": "box",[m[41m[m
[32m+[m[32m      "layout": "vertical",[m[41m[m
[32m+[m[32m      "contents": [[m[41m[m
[32m+[m[32m          {[m[41m[m
[32m+[m[32m              "type": "separator"[m[41m[m
[32m+[m[32m          },[m[41m[m
[32m+[m[32m          {[m[41m[m
[32m+[m[32m              "type": "text",[m[41m[m
[32m+[m[32m              "text": "地図",[m[41m[m
[32m+[m[32m              "weight": "bold",[m[41m[m
[32m+[m[32m              "margin": "md"[m[41m[m
[32m+[m[32m          },[m[41m[m
[32m+[m[32m          {[m[41m[m
[32m+[m[32m              "type": "image",[m[41m[m
[32m+[m[32m              "size": "full",[m[41m[m
[32m+[m[32m              "margin": "md",[m[41m[m
[32m+[m[32m              "aspectRatio": "16:9",[m[41m[m
[32m+[m[32m              "aspectMode": "cover",[m[41m[m
[32m+[m[32m              "url": ""[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m      ][m[41m[m
[32m+[m[32m  }[m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/api-server/routes/linebot.js b/api-server/routes/linebot.js[m
[1mindex ae923d0..db4d569 100644[m
[1m--- a/api-server/routes/linebot.js[m
[1m+++ b/api-server/routes/linebot.js[m
[36m@@ -1,631 +1,631 @@[m
[31m-var express = require('express');[m
[31m-var router = express.Router();[m
[31m-const crypto = require('crypto');[m
[31m-var request = require('request');[m
[31m-var moment = require('moment');[m
[31m-var fs = require('fs');[m
[31m-var cheerio = require('cheerio-httpcli');[m
[31m-const dialogflow = require("dialogflow");[m
[31m-const dropboxV2Api = require('dropbox-v2-api');[m
[31m-var connection = require('./mysqlConnection');[m
[31m-[m
[31m-/* 環境変数 */[m
[31m-const channelSecret = process.env.channelSecret;[m
[31m-const accessToken = process.env.accessToken;[m
[31m-const GOOGLE_PROJECT_ID = process.env.GOOGLE_PROJECT_ID;[m
[31m-const GOOGLE_CLIENT_EMAIL = process.env.GOOGLE_CLIENT_EMAIL;[m
[31m-const GOOGLE_PRIVATE_KEY = process.env.GOOGLE_PRIVATE_KEY;[m
[31m-const dropbox = process.env.dropbox;[m
[31m-[m
[31m-//dialogflow[m
[31m-const session_client = new dialogflow.SessionsClient({[m
[31m-    project_id: GOOGLE_PROJECT_ID,[m
[31m-    credentials: {[m
[31m-        client_email: GOOGLE_CLIENT_EMAIL,[m
[31m-        private_key: GOOGLE_PRIVATE_KEY.replace(/\\n/g, "\n")[m
[31m-    }[m
[31m-});[m
[31m-[m
[31m-//DropBox[m
[31m-const dbx = dropboxV2Api.authenticate({[m
[31m-    token: dropbox[m
[31m-});[m
[31m-[m
[31m-/* json fileの読み込み */[m
[31m-const flex_tmp = require("./flex_template.json");[m
[31m-const flex_item = require("./flex_item.json");[m
[31m-const flex_image = require("./shop-map.json");[m
[31m-var richdata = JSON.parse(fs.readFileSync('./routes/rich.json', 'utf8'));[m
[31m-var shop_area = JSON.parse(fs.readFileSync('./routes/shop-area.json', 'utf8'));[m
[31m-var map_data  = JSON.parse(fs.readFileSync('./routes/mapdata.json','utf8'));[m
[31m-var shop_data = JSON.parse(fs.readFileSync('../bot/data/shop.json', 'utf8'));[m
[31m-var boothID_data   = JSON.parse(fs.readFileSync('./routes/boothID.json','utf8'));[m
[31m-[m
[31m-/* LINE MessagingAPI URL */[m
[31m-//URL POST[m
[31m-const urlp_reply = "https://api.line.me/v2/bot/message/reply";[m
[31m-const urlp_rich_set = "https://api.line.me/v2/bot/user/{userId}/richmenu/{richMenuId}";[m
[31m-const urlp_push = "https://api.line.me/v2/bot/message/multicast";[m
[31m-//LINE URL GET[m
[31m-const urlg_download_message = "https://api.line.me/v2/bot/message/{messageId}/content";[m
[31m-//LINE URL DELETE[m
[31m-const urld_rich_delete = "https://api.line.me/v2/bot/user/{userId}/richmenu";[m
[31m-[m
[31m-/**[m
[31m- * LINEに渡すBodyを生成する[m
[31m- * @param  {string} url LINE MessagingAPI エンドポイントを指定[m
[31m- * @param  {obj} [res_body] Build_msg_textの返り値を指定[m
[31m- * @return {obj} LINEにPOSTするJson Body[m
[31m- */[m
[31m-function Build_responce(url, res_body) {[m
[31m-    return new Promise(function(resolve, reject) {[m
[31m-        var tmp = {[m
[31m-            url: url,[m
[31m-            headers: {[m
[31m-                "Authorization": "Bearer " + accessToken[m
[31m-            }[m
[31m-        };[m
[31m-        if (res_body) {[m
[31m-            tmp.json = res_body;[m
[31m-        }[m
[31m-        resolve(tmp);[m
[31m-    });[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * LINEのmessageオブジェクトを生成する -> Build_responceに渡す[m
[31m- * @param  {} Token - replyToken[m
[31m- * @param  {} message1 [m
[31m- * @param  {} [message2][m
[31m- * @param  {} [message3][m
[31m- * @param  {} [message4][m
[31m- * @param  {} [message5][m
[31m- */[m
[31m-function Build_msg_text(Token, message1, message2, message3, message4, message5) {[m
[31m-    return new Promise(function(resolve, reject) {[m
[31m-        var tmp = {[m
[31m-            "replyToken": Token,[m
[31m-            "messages": [][m
[31m-        };[m
[31m-        if (message1) {[m
[31m-            tmp.messages.push(message1);[m
[31m-            if (message2) {[m
[31m-                tmp.messages.push(message2);[m
[31m-                if (message3) {[m
[31m-                    tmp.messages.push(message3);[m
[31m-                    if (message4) {[m
[31m-                        tmp.messages.push(message4);[m
[31m-                        if (message5) {[m
[31m-                            tmp.messages.push(message5);[m
[31m-                        }[m
[31m-                    }[m
[31m-                }[m
[31m-            }[m
[31m-        }[m
[31m-        resolve(tmp);[m
[31m-    });[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * 模擬店のflexを作成する[m
[31m- * @param  {string} shopid ショップid[m
[31m- * @return {obj} Bulid_msg_textに渡す[m
[31m- */[m
[31m-function Build_flex(shopid) {[m
[31m-    var data = shop_data[shopid];[m
[31m-    var tmp = flex_tmp;[m
[31m-    tmp.header.contents[0].text = data.shopname;[m
[31m-    tmp.hero.url = data.image[0];[m
[31m-    tmp.footer.contents[2].url = flex_image[shopid];[m
[31m-    for (var i=0; i<data.goods.length; i++) {[m
[31m-        var goodjson = data.goods[i];[m
[31m-        var g = flex_item;[m
[31m-        g.contents[0].text = goodjson.name;[m
[31m-        g.contents[1].text = goodjson.price + "円";[m
[31m-        tmp.body.contents.push(g);[m
[31m-    }[m
[31m-    return tmp;[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- *Numで指定する選択肢のボタンflexを作成する[m
[31m- * @param {int}   Num   // 選択肢の個数[m
[31m- * @param {str[]} text  // それぞれの選択肢で指定する文字列[m
[31m- * @return {obj} flex message (Button)[m
[31m- */[m
[31m-function Build_flexButton(texts){[m
[31m-    var tmp = {[m
[31m-        "type": "bubble",[m
[31m-        "body": {[m
[31m-            "type": "box",[m
[31m-            "layout": "vertical",[m
[31m-            "spacing": "md",[m
[31m-            "contents": [[m
[31m-            ][m
[31m-        }[m
[31m-    }[m
[31m-    for(i=0;i<texts.length;i++){[m
[31m-        var addtmp = {[m
[31m-            "type": "button",[m
[31m-            "style": "primary",[m
[31m-            "action": {[m
[31m-                "type":"message",[m
[31m-                "label":texts[i],[m
[31m-                "text":texts[i][m
[31m-             }[m
[31m-        }[m
[31m-        tmp.body.contents.push(addtmp);[m
[31m-    }[m
[31m-    return tmp;[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * データベースからデータ取得[m
[31m- * @param  {string} table テーブル名[m
[31m- * @param  {string} col 取得したい列名[m
[31m- * @param  {string} where 検索する列名[m
[31m- * @param  {string} id キー[m
[31m- * @return {string} 検索した結果[m
[31m- */[m
[31m-function DB_get(table, col, where, id) {[m
[31m-    return new Promise(function(resolve, reject) {[m
[31m-        var query = 'SELECT {col} FROM {table} WHERE {where} = "{id}"'[m
[31m-            .replace("{table}", table)[m
[31m-            .replace("{col}", col)[m
[31m-            .replace("{where}", where)[m
[31m-            .replace("{id}", id);[m
[31m-        connection.query(query,function(err, rows) {[m
[31m-            resolve(rows[0][col]);[m
[31m-        })[m
[31m-    });[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * リッチメニューの切り替え[m
[31m- * @param  {string} after 切り替え後のリッチメニューId（richdata）[m
[31m- * @param  {string} userId 切り替えるユーザId[m
[31m- */[m
[31m-async function rich_change(after, userId) {[m
[31m-    var rich_url = urld_rich_delete.replace("{userId}", userId);[m
[31m-    var rich_url2 = urlp_rich_set.replace("{userId}", userId)[m
[31m-        .replace("{richMenuId}", after);[m
[31m-    var tmp = await Build_responce(rich_url2)[m
[31m-    request.delete(await Build_responce(rich_url), function(error, responce, body) {[m
[31m-        request.post(tmp);[m
[31m-    });[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- *  テキストメッセージの生成[m
[31m- * @param {String} text テキストデータ[m
[31m- * @return {obj}   msg  テキストメッセージ[m
[31m- */[m
[31m-function msg_text(text){[m
[31m-    var msg = {"type": "text"};[m
[31m-    msg.text = text;[m
[31m-    return msg;[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * イメージマップメッセージの生成[m
[31m- * @param {string} usage 用途(map)[m
[31m- * @param {obj}    data  用途に対応するデータ[m
[31m- * @return {obj}   msg  イメージマップメッセージ[m
[31m- */[m
[31m-function msg_imagemap(usage,data){[m
[31m-    var msg = {"type":"imagemap"};[m
[31m-    if(usage == "map"){[m
[31m-        var location = map_data[data.location];[m
[31m-        msg.baseUrl  = location.baseUrl;[m
[31m-        msg.altText  = location.altText;[m
[31m-        msg.baseSize = location.baseSize;[m
[31m-        msg.actions  = location.actions;[m
[31m-        // console.log(msg);[m
[31m-    }[m
[31m-    return msg;[m
[31m-}[m
[31m-[m
[31m-async function image_download(event) {[m
[31m-    let url = urlg_download_message.replace("{messageId}", event.message.id);[m
[31m-    let tmp = DB_get("UserData", "USERTYPE", "USERID", event.source.userId);[m
[31m-    let option = await Build_responce(url);[m
[31m-    option.encoding = null;[m
[31m-    let nowtime = moment().format('HH:mm:ss:SSS');[m
[31m-    let usertype = await tmp;[m
[31m-    request.get(option, function(err, res, body) {[m
[31m-        if(err) {[m
[31m-            console.log(body);[m
[31m-        } else {[m
[31m-            let path = "/kufes18/" + usertype + "/" +nowtime+ ".png"[m
[31m-            fs.writeFileSync("../" + nowtime + ".png", body, "binary");[m
[31m-            dbx({[m
[31m-                resource: 'files/upload',[m
[31m-                parameters: {[m
[31m-                    path: path[m
[31m-                },[m
[31m-                readStream: fs.createReadStream("../" + nowtime + ".png")[m
[31m-            }, (err, result, response) => {[m
[31m-                //upload completed[m
[31m-                fs.unlink("../" + nowtime + ".png",  function (err) {[m
[31m-                    if (err) {[m
[31m-                        console.log(err);[m
[31m-                    }[m
[31m-                });[m
[31m-            });[m
[31m-        }[m
[31m-    });[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * Event - messageの時のおおもと[m
[31m- * 基本的にlineへのレスポンスはここで行う[m
[31m- * @param  {obj} event LINEからのBody[m
[31m- */[m
[31m-async function type_message(event) {[m
[31m-    // Dialogflowへの接続今のところしない[m
[31m-    var msg  = undefined;[m
[31m-    var msg2 = undefined;[m
[31m-    var msg3 = undefined;[m
[31m-    var msg4 = undefined;[m
[31m-    var msg5 = undefined;[m
[31m-    var mapdata  = new Object(); // mapの場所データなど[m
[31m-    // [エリア][ピンの番号]([][0] : エリア名)[m
[31m-    var OutsideArea =  [["A",1,2,3,4,5],[m
[31m-                        ["B",1,2,3,4],[m
[31m-                        ["C",1,2],[m
[31m-                        ["D",1,2,3,4,5,6,7,8],[m
[31m-                        ["E",1,2,3,4,5,6],[m
[31m-                        ["F",1,2,3]];[m
[31m-    // [棟][各階にあるのピンの数]]([][0] : 棟の数)[m
[31m-    // 8棟は1，3階だが、プログラム内では1,2階として処理する。[m
[31m-    var mapBFdata  = [[2,1,2,5,0],[m
[31m-                      [3,1,2,3,4],[m
[31m-                      [5,1,2],[m
[31m-                      [8,1,1]];[m
[31m-    switch(event.message.text) {[m
[31m-        case "近くの模擬店を探す":[m
[31m-            var userplace = await DB_get("UserData", "PLACE", "USERID", event.source.userId);[m
[31m-            if (userplace == "" || userplace == "hazama" || userplace == "joho") {[m
[31m-                msg = msg_text("近くに模擬店がないみたい...\n移動してからもう一度試してください");[m
[31m-            } else {[m
[31m-                //userplaceの場所に合う模擬店をjson or htmlから引っ張ってきてテンプレートメッセージにする[m
[31m-                msg = {[m
[31m-                    "type": "flex",[m
[31m-                    "altText": "This is a flex message.",[m
[31m-                    "contents": {[m
[31m-                        "type": "carousel",[m
[31m-                        "contents": [][m
[31m-                    }[m
[31m-                };[m
[31m-                for (var i=0; i<shop_area[userplace].length; i++) {[m
[31m-                    var shopid = shop_area[userplace][i];[m
[31m-                    msg.contents.contents.push(Build_flex(shopid));[m
[31m-                }[m
[31m-            }[m
[31m-            break;[m
[31m-        case "マップを表示":[m
[31m-            //mapdata.location = "Top";[m
[31m-            //msg = msg_imagemap("map",mapdata);[m
[31m-            msg = {[m
[31m-                "type": "flex",[m
[31m-                "altText":  "TOP",[m
[31m-                "contents": {}[m
[31m-            };[m
[31m-            var buttonTexts = ["[Top] 構外全体マップへ","[Top] 構内全体マップへ"];[m
[31m-            msg.contents = Build_flexButton(buttonTexts);[m
[31m-            break;[m
[31m-        case "[Top] 構内全体マップへ":[m
[31m-            mapdata.location = "InsideTop";[m
[31m-            msg = msg_imagemap("map",mapdata);[m
[31m-            msg2 = msg_text("棟を選択してください");            [m
[31m-            break;[m
[31m-        case "[Top] 構外全体マップへ":[m
[31m-            mapdata.location = "OutsideTop";[m
[31m-            msg = msg_imagemap("map",mapdata);[m
[31m-            msg2 = msg_text("エリアを選択してください");[m
[31m-            break;[m
[31m-        case "実装中":[m
[31m-            break;[m
[31m-        default:[m
[31m-            msg = msg_text("個別の返信はできません(*:△:)");[m
[31m-            break;[m
[31m-    }[m
[31m-[m
[31m-    /***** イメージマップタップ時の出力判定 *****/[m
[31m-    // [1] 構外マップ[m
[31m-    for(var i=0;i<OutsideArea.length;i++){[m
[31m-        for(var j=1;j<OutsideArea[i].length;j++){[m
[31m-            switch(event.message.text){[m
[31m-                case "エリア"+OutsideArea[i][0]+"の"+OutsideArea[i][j]+"番の模擬店情報を表示":[m
[31m-                    /*[m
[31m-                    msg = {[m
[31m-                        "type": "flex",[m
[31m-                        "altText": "エリア"+OutsideArea[i][0]+"の"+OutsideArea[i][j]+"番の模擬店情報",[m
[31m-                        "contents": {}[m
[31m-                    };[m
[31m-                    msg.contents = Build_flex(boothID_data["Outside"+OutsideArea[i][0]+OutsideArea[i][j]]);[m
[31m-                    */[m
[31m-                    msg = msg_text("debug message [エリアの模擬店情報]");[m
[31m-                    break;[m
[31m-            }[m
[31m-        }[m
[31m-        switch(event.message.text){[m
[31m-            case "エリア"+OutsideArea[i][0]+"へ":[m
[31m-                mapdata.location = "Area"+OutsideArea[i][0];[m
[31m-                msg = msg_imagemap("map",mapdata);[m
[31m-                msg2 = msg_text("ピンを選択すると模擬店の詳細を表示します");[m
[31m-                break;[m
[31m-        }[m
[31m-    }[m
[31m-    // [2] 構内マップ[m
[31m-    for(var i=0;i<mapBFdata.length;i++){[m
[31m-        for(var j=1;j<mapBFdata[i].length;j++){[m
[31m-            // フロアの画像送信部[m
[31m-            switch(event.message.texts){[m
[31m-                case mapBFdata[i][0] + "棟"+j+"階へ":[m
[31m-                    console.log("console");[m
[31m-                    mapdata.location = "I"+mapdata[i][0]+j;[m
[31m-                    msg = msg_imagemap("map",mapdata);[m
[31m-                    msg2 = msg_text("ピンを選択すると模擬店の詳細を表示します");[m
[31m-                    break;[m
[31m-            }[m
[31m-            for(var k=1;k<=mapBFdata[i][j];k++){[m
[31m-                switch(event.message.text){[m
[31m-                    case mapBFdata[i][0]+"棟"+j+"階の"+k+"番目の模擬店情報を表示":[m
[31m-                        // 模擬店情報送信部[m
[31m-                        /*[m
[31m-                        msg = {[m
[31m-                            "type": "flex",[m
[31m-                            "altText":  mapBFdata[i][0]+"棟"+j+"階の"+k+"番目の模擬店情報",[m
[31m-                            "contents": {}[m
[31m-                        };[m
[31m-                        msg.contents = Build_flex(boothID_data["Inside"+mapBFdata[i][0]+j+k]);[m
[31m-                        */[m
[31m-                        msg = msg_text("debug message [~棟~階~番目の模擬店情報へ]");[m
[31m-                        break;[m
[31m-                }[m
[31m-            }[m
[31m-        }[m
[31m-        // 階数を選択するflexMessageの送信[m
[31m-        switch(event.message.text){[m
[31m-            case mapBFdata[i][0]+"棟へ":[m
[31m-                msg = {[m
[31m-                    "type": "flex",[m
[31m-                    "altText":  mapBFdata[i][0]+"棟の階を選択してください。",[m
[31m-                    "contents": {}[m
[31m-                }[m
[31m-                var buttonTexts = [];[m
[31m-                for(j=1;j<mapBFdata[i].length;j++){[m
[31m-                    if(i==3 && j==2){[m
[31m-                        buttonTexts.push(mapBFdata[i][0]+"棟"+3+"階へ"); //8棟3階の処理[m
[31m-                    }else{[m
[31m-                        buttonTexts.push(mapBFdata[i][0]+"棟"+j+"階へ");[m
[31m-                    }[m
[31m-                }[m
[31m-                console.log(buttonTexts);[m
[31m-                msg.contents = Build_flexButton(buttonTexts);[m
[31m-                break;[m
[31m-        }[m
[31m-    }[m
[31m-[m
[31m-    //画像を送信してきた時の処理[m
[31m-    if (event.message.type == "image") {[m
[31m-        image_download(event);[m
[31m-        msg = msg_text("画像を送信してくれてありがとう(o・∇・o)");[m
[31m-    }[m
[31m-    if (msg){[m
[31m-        var tmp = await Build_responce(urlp_reply, await Build_msg_text([m
[31m-            event.replyToken,msg, msg2, msg3, msg4, msg5[m
[31m-        ));[m
[31m-        request.post(tmp);[m
[31m-    }[m
[31m-}[m
[31m-[m
[31m-[m
[31m-/**[m
[31m- * Event - followの時[m
[31m- * @param  {obj} event LINEからのBody[m
[31m- */[m
[31m-async function type_follow(event) {[m
[31m-    //rich menuの登録[m
[31m-    var rich_url = urlp_rich_set.replace('{userId}', event.source.userId)[m
[31m-        .replace('{richMenuId}', richdata.start);[m
[31m-    request.post(await Build_responce(rich_url));[m
[31m-    var msg = {[m
[31m-        "type": "text",[m
[31m-        "text": "東京高専文化祭BOTを友達登録してくれてありがとう！"[m
[31m-    };[m
[31m-    var tmp = await Build_responce(urlp_reply, await Build_msg_text([m
[31m-        event.replyToken, msg[m
[31m-    ));[m
[31m-    request.post(tmp);[m
[31m-}[m
[31m-/**[m
[31m- * ユーザが初回登録をした[m
[31m- * @param  {obj} event LINEからのBody[m
[31m- * @param  {string} usertype 学生 or 来場者[m
[31m- */[m
[31m-async function addUser(event, usertype) {[m
[31m-    //DBへユーザの追加[m
[31m-    var nowtime = moment().format('YYYY-MM-DD HH:mm:ss');[m
[31m-    var query = 'INSERT INTO UserData (USERID, USERTYPE, BEACONTIME, PLACE) VALUES ("{id}", "{type}", "{time}", "{place}")';[m
[31m-    query = query.replace('{id}', event.source.userId)[m
[31m-        .replace('{type}', event.postback.data)[m
[31m-        .replace('{time}', nowtime)[m
[31m-        .replace('{place}', "");[m
[31m-    connection.query(query);[m
[31m-    //richmenuの切り替え[m
[31m-    rich_change(richdata.normal, event.source.userId);[m
[31m-    var msg = {[m
[31m-        "type": "text",[m
[31m-        "text": usertype + "と認証しました"[m
[31m-    };[m
[31m-    var tmp = await Build_responce(urlp_reply, await Build_msg_text([m
[31m-        event.replyToken, msg[m
[31m-    ));[m
[31m-    request.post(tmp);[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * ユーザがブロックした[m
[31m- * @param  {obj} event LINEからのBody[m
[31m- */[m
[31m-function removeUser(event) {[m
[31m-    var query = 'DELETE FROM UserData WHERE USERID = "{id}"'[m
[31m-        .replace("{id}", event.source.userId);[m
[31m-    connection.query(query);[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * ビーコンに侵入した時のおおもと[m
[31m- * @param  {obj} event LINEからのBody[m
[31m- */[m
[31m-async function type_beacon(event) {[m
[31m-    /* beacon侵入時間の更新 */[m
[31m-    var tmp = DB_get("UserData", "BEACONTIME", "USERID", event.source.userId);[m
[31m-    var now = moment();[m
[31m-    var nowtime = now.format('YYYY-MM-DD HH:mm:ss');[m
[31m-    var db_time = moment(await tmp);[m
[31m-    var db_place = DB_get("BeaconData", "PLACE", "BEACONID", event.beacon.hwid);[m
[31m-    //前回の侵入から7分経っている -> 更新してメッセージを送信[m
[31m-    if ((now.diff(db_time)/(1000*60)) >= 7 ) {[m
[31m-        var query = 'UPDATE UserData SET BEACONTIME = "{time}" WHERE USERID = "{id}"'[m
[31m-            .replace("{id}", event.source.userId)[m
[31m-            .replace("{time}", nowtime);[m
[31m-        connection.query(query);[m
[31m-        //メッセージを整形[m
[31m-        var db_msg = DB_get("BeaconData", "MESSAGE", "BEACONID", event.beacon.hwid);[m
[31m-        var msg = {[m
[31m-            "type": "text",[m
[31m-            "text": "現在，" + await db_place + "です"[m
[31m-        };[m
[31m-        var msg2 = {[m
[31m-            "type": "text",[m
[31m-            "text": "[おしらせ]\n" + await db_msg[m
[31m-        };[m
[31m-        var tmp = await Build_responce(urlp_reply, await Build_msg_text([m
[31m-            event.replyToken, msg, msg2[m
[31m-        ));[m
[31m-        request.post(tmp);[m
[31m-    }[m
[31m-    //ユーザがいる場所を登録[m
[31m-    var query = 'UPDATE UserData SET PLACE = "{place}" WHERE USERID = "{id}"'[m
[31m-        .replace("{id}", event.source.userId)[m
[31m-        .replace("{place}", await db_place);[m
[31m-    connection.query(query);[m
[31m-    //体育館に侵入したならリッチメニューを切り替える[m
[31m-    if (db_place == "taiikukan") {[m
[31m-        rich_change(richdata.event, event.source.userId);[m
[31m-    }[m
[31m-[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * ビーコンから退出した（体育館専用）[m
[31m- * @param  {obj} event LINEからのBody[m
[31m- */[m
[31m-async function beacon_leave(event) {[m
[31m-    var p = DB_get("UserData", "PLACE", "USERID", event.source.userId);[m
[31m-    var db_place = await DB_get("BeaconData", "PLACE", "BEACONID", event.beacon.hwid);[m
[31m-    var user_place = await p;[m
[31m-    if (db_place == user_place) {[m
[31m-        var query = 'UPDATE UserData SET PLACE = "{place}" WHERE USERID = "{id}"'[m
[31m-            .replace("{id}", event.source.userId)[m
[31m-            .replace("{place}", "");[m
[31m-        connection.query(query);[m
[31m-        if (db_place == "taiikukan") {[m
[31m-            rich_change(richdata.normal, event.source.userId);[m
[31m-        }[m
[31m-    }[m
[31m-}[m
[31m-[m
[31m-[m
[31m-/* MAIN */[m
[31m-router.post('/', function(req, res, next) {[m
[31m-    var responce = "";[m
[31m-    /* LINE認証 */[m
[31m-    const body = req.body; // Request body string[m
[31m-    const signature = crypto[m
[31m-        .createHmac('SHA256', channelSecret)[m
[31m-        .update(JSON.stringify(body)).digest('base64');[m
[31m-    if (req.header("x-line-signature") == signature) {[m
[31m-        //認証成功[m
[31m-        res.status(200);[m
[31m-        console.log("line_OK");[m
[31m-        //Eventは複数[m
[31m-        body.events.forEach((event) => {[m
[31m-            switch(event.type) {[m
[31m-                case "message":[m
[31m-                    type_message(event);[m
[31m-                    break;[m
[31m-                case "follow":[m
[31m-                    type_follow(event);[m
[31m-                    break;[m
[31m-                case "postback":[m
[31m-                    if (event.postback.data == "Student") { addUser(event, "学生"); }[m
[31m-                    else if (event.postback.data == "Other") { addUser(event, "来場者"); }[m
[31m-                    break;[m
[31m-                case "beacon":[m
[31m-                    if (event.beacon.type == "enter") { type_beacon(event); }[m
[31m-                    else if (event.beacon.type == "leave") { beacon_leave(event); }[m
[31m-                    break;[m
[31m-                case "unfollow":[m
[31m-                    removeUser(event);[m
[31m-                    break;[m
[31m-                default:[m
[31m-                    console.log(event);[m
[31m-                    break;[m
[31m-            }[m
[31m-        });[m
[31m-    } else {[m
[31m-        //認証失敗[m
[31m-        console.log("line_NG");[m
[31m-        res.status(403);[m
[31m-    }[m
[31m-    res.send(responce);[m
[31m-});[m
[31m-[m
[31m-function pushOnlyDB(query) {[m
[31m-    return new Promise(function(resolve, reject) {[m
[31m-        connection.query(query,function(err, rows) {[m
[31m-            resolve(rows);[m
[31m-        });[m
[31m-    });[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * 受け取るデータは[m
[31m- * @param {string} param mysql検索キー（where以下）[m
[31m- * @param {string} message 送信する文面[m
[31m- */[m
[31m-router.post('/pushmessage/send', async function(req, res, next) {[m
[31m-    var responce = "";[m
[31m-    const body = req.body; // Request body string[m
[31m-    let msg = msg_text(body.message);[m
[31m-    var query = 'SELECT USERID FROM UserData WHERE ' + body.param;[m
[31m-    let rows = await pushOnlyDB(query);[m
[31m-    let users = [];[m
[31m-    for (let i=0; i<rows.length; i++) {[m
[31m-        users.push(rows[i]["USERID"]);[m
[31m-        if (i%150 == 149) {[m
[31m-            let tmp = {[m
[31m-                "to": users,[m
[31m-                "messages": [msg][m
[31m-            }[m
[31m-            request.post(await Build_responce(urlp_push, tmp))[m
[31m-            users.length = 0;[m
[31m-        }[m
[31m-    }[m
[31m-    if (users.length != 0) {[m
[31m-        let tmp = {[m
[31m-            "to": users,[m
[31m-            "messages": [msg][m
[31m-        }[m
[31m-        request.post(await Build_responce(urlp_push, tmp));[m
[31m-        users.length = 0;[m
[31m-    }[m
[31m-    res.status = 200;[m
[31m-    res.send(responce);[m
[31m-});[m
[31m-[m
[31m-module.exports = router;[m
[32m+[m[32mvar express = require('express');[m[41m[m
[32m+[m[32mvar router = express.Router();[m[41m[m
[32m+[m[32mconst crypto = require('crypto');[m[41m[m
[32m+[m[32mvar request = require('request');[m[41m[m
[32m+[m[32mvar moment = require('moment');[m[41m[m
[32m+[m[32mvar fs = require('fs');[m[41m[m
[32m+[m[32mvar cheerio = require('cheerio-httpcli');[m[41m[m
[32m+[m[32mconst dialogflow = require("dialogflow");[m[41m[m
[32m+[m[32mconst dropboxV2Api = require('dropbox-v2-api');[m[41m[m
[32m+[m[32mvar connection = require('./mysqlConnection');[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/* 環境変数 */[m[41m[m
[32m+[m[32mconst channelSecret = process.env.channelSecret;[m[41m[m
[32m+[m[32mconst accessToken = process.env.accessToken;[m[41m[m
[32m+[m[32mconst GOOGLE_PROJECT_ID = process.env.GOOGLE_PROJECT_ID;[m[41m[m
[32m+[m[32mconst GOOGLE_CLIENT_EMAIL = process.env.GOOGLE_CLIENT_EMAIL;[m[41m[m
[32m+[m[32mconst GOOGLE_PRIVATE_KEY = process.env.GOOGLE_PRIVATE_KEY;[m[41m[m
[32m+[m[32mconst dropbox = process.env.dropbox;[m[41m[m
[32m+[m[41m[m
[32m+[m[32m//dialogflow[m[41m[m
[32m+[m[32mconst session_client = new dialogflow.SessionsClient({[m[41m[m
[32m+[m[32m    project_id: GOOGLE_PROJECT_ID,[m[41m[m
[32m+[m[32m    credentials: {[m[41m[m
[32m+[m[32m        client_email: GOOGLE_CLIENT_EMAIL,[m[41m[m
[32m+[m[32m        private_key: GOOGLE_PRIVATE_KEY.replace(/\\n/g, "\n")[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32m//DropBox[m[41m[m
[32m+[m[32mconst dbx = dropboxV2Api.authenticate({[m[41m[m
[32m+[m[32m    token: dropbox[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/* json fileの読み込み */[m[41m[m
[32m+[m[32mconst flex_tmp = require("./flex_template.json");[m[41m[m
[32m+[m[32mconst flex_item = require("./flex_item.json");[m[41m[m
[32m+[m[32mconst flex_image = require("./shop-map.json");[m[41m[m
[32m+[m[32mvar richdata = JSON.parse(fs.readFileSync('./routes/rich.json', 'utf8'));[m[41m[m
[32m+[m[32mvar shop_area = JSON.parse(fs.readFileSync('./routes/shop-area.json', 'utf8'));[m[41m[m
[32m+[m[32mvar map_data  = JSON.parse(fs.readFileSync('./routes/mapdata.json','utf8'));[m[41m[m
[32m+[m[32mvar shop_data = JSON.parse(fs.readFileSync('../bot/data/shop.json', 'utf8'));[m[41m[m
[32m+[m[32mvar boothID_data   = JSON.parse(fs.readFileSync('./routes/boothID.json','utf8'));[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/* LINE MessagingAPI URL */[m[41m[m
[32m+[m[32m//URL POST[m[41m[m
[32m+[m[32mconst urlp_reply = "https://api.line.me/v2/bot/message/reply";[m[41m[m
[32m+[m[32mconst urlp_rich_set = "https://api.line.me/v2/bot/user/{userId}/richmenu/{richMenuId}";[m[41m[m
[32m+[m[32mconst urlp_push = "https://api.line.me/v2/bot/message/multicast";[m[41m[m
[32m+[m[32m//LINE URL GET[m[41m[m
[32m+[m[32mconst urlg_download_message = "https://api.line.me/v2/bot/message/{messageId}/content";[m[41m[m
[32m+[m[32m//LINE URL DELETE[m[41m[m
[32m+[m[32mconst urld_rich_delete = "https://api.line.me/v2/bot/user/{userId}/richmenu";[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * LINEに渡すBodyを生成する[m[41m[m
[32m+[m[32m * @param  {string} url LINE MessagingAPI エンドポイントを指定[m[41m[m
[32m+[m[32m * @param  {obj} [res_body] Build_msg_textの返り値を指定[m[41m[m
[32m+[m[32m * @return {obj} LINEにPOSTするJson Body[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction Build_responce(url, res_body) {[m[41m[m
[32m+[m[32m    return new Promise(function(resolve, reject) {[m[41m[m
[32m+[m[32m        var tmp = {[m[41m[m
[32m+[m[32m            url: url,[m[41m[m
[32m+[m[32m            headers: {[m[41m[m
[32m+[m[32m                "Authorization": "Bearer " + accessToken[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        };[m[41m[m
[32m+[m[32m        if (res_body) {[m[41m[m
[32m+[m[32m            tmp.json = res_body;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        resolve(tmp);[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * LINEのmessageオブジェクトを生成する -> Build_responceに渡す[m[41m[m
[32m+[m[32m * @param  {} Token - replyToken[m[41m[m
[32m+[m[32m * @param  {} message1[m[41m [m
[32m+[m[32m * @param  {} [message2][m[41m[m
[32m+[m[32m * @param  {} [message3][m[41m[m
[32m+[m[32m * @param  {} [message4][m[41m[m
[32m+[m[32m * @param  {} [message5][m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction Build_msg_text(Token, message1, message2, message3, message4, message5) {[m[41m[m
[32m+[m[32m    return new Promise(function(resolve, reject) {[m[41m[m
[32m+[m[32m        var tmp = {[m[41m[m
[32m+[m[32m            "replyToken": Token,[m[41m[m
[32m+[m[32m            "messages": [][m[41m[m
[32m+[m[32m        };[m[41m[m
[32m+[m[32m        if (message1) {[m[41m[m
[32m+[m[32m            tmp.messages.push(message1);[m[41m[m
[32m+[m[32m            if (message2) {[m[41m[m
[32m+[m[32m                tmp.messages.push(message2);[m[41m[m
[32m+[m[32m                if (message3) {[m[41m[m
[32m+[m[32m                    tmp.messages.push(message3);[m[41m[m
[32m+[m[32m                    if (message4) {[m[41m[m
[32m+[m[32m                        tmp.messages.push(message4);[m[41m[m
[32m+[m[32m                        if (message5) {[m[41m[m
[32m+[m[32m                            tmp.messages.push(message5);[m[41m[m
[32m+[m[32m                        }[m[41m[m
[32m+[m[32m                    }[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        resolve(tmp);[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * 模擬店のflexを作成する[m[41m[m
[32m+[m[32m * @param  {string} shopid ショップid[m[41m[m
[32m+[m[32m * @return {obj} Bulid_msg_textに渡す[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction Build_flex(shopid) {[m[41m[m
[32m+[m[32m    var data = shop_data[shopid];[m[41m[m
[32m+[m[32m    var tmp = flex_tmp;[m[41m[m
[32m+[m[32m    tmp.header.contents[0].text = data.shopname;[m[41m[m
[32m+[m[32m    tmp.hero.url = data.image[0];[m[41m[m
[32m+[m[32m    tmp.footer.contents[2].url = flex_image[shopid];[m[41m[m
[32m+[m[32m    for (var i=0; i<data.goods.length; i++) {[m[41m[m
[32m+[m[32m        var goodjson = data.goods[i];[m[41m[m
[32m+[m[32m        var g = flex_item;[m[41m[m
[32m+[m[32m        g.contents[0].text = goodjson.name;[m[41m[m
[32m+[m[32m        g.contents[1].text = goodjson.price + "円";[m[41m[m
[32m+[m[32m        tmp.body.contents.push(g);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    return tmp;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m *Numで指定する選択肢のボタンflexを作成する[m[41m[m
[32m+[m[32m * @param {int}   Num   // 選択肢の個数[m[41m[m
[32m+[m[32m * @param {str[]} text  // それぞれの選択肢で指定する文字列[m[41m[m
[32m+[m[32m * @return {obj} flex message (Button)[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction Build_flexButton(texts){[m[41m[m
[32m+[m[32m    var tmp = {[m[41m[m
[32m+[m[32m        "type": "bubble",[m[41m[m
[32m+[m[32m        "body": {[m[41m[m
[32m+[m[32m            "type": "box",[m[41m[m
[32m+[m[32m            "layout": "vertical",[m[41m[m
[32m+[m[32m            "spacing": "md",[m[41m[m
[32m+[m[32m            "contents": [[m[41m[m
[32m+[m[32m            ][m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    for(i=0;i<texts.length;i++){[m[41m[m
[32m+[m[32m        var addtmp = {[m[41m[m
[32m+[m[32m            "type": "button",[m[41m[m
[32m+[m[32m            "style": "primary",[m[41m[m
[32m+[m[32m            "action": {[m[41m[m
[32m+[m[32m                "type":"message",[m[41m[m
[32m+[m[32m                "label":texts[i],[m[41m[m
[32m+[m[32m                "text":texts[i][m[41m[m
[32m+[m[32m             }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        tmp.body.contents.push(addtmp);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    return tmp;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * データベースからデータ取得[m[41m[m
[32m+[m[32m * @param  {string} table テーブル名[m[41m[m
[32m+[m[32m * @param  {string} col 取得したい列名[m[41m[m
[32m+[m[32m * @param  {string} where 検索する列名[m[41m[m
[32m+[m[32m * @param  {string} id キー[m[41m[m
[32m+[m[32m * @return {string} 検索した結果[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction DB_get(table, col, where, id) {[m[41m[m
[32m+[m[32m    return new Promise(function(resolve, reject) {[m[41m[m
[32m+[m[32m        var query = 'SELECT {col} FROM {table} WHERE {where} = "{id}"'[m[41m[m
[32m+[m[32m            .replace("{table}", table)[m[41m[m
[32m+[m[32m            .replace("{col}", col)[m[41m[m
[32m+[m[32m            .replace("{where}", where)[m[41m[m
[32m+[m[32m            .replace("{id}", id);[m[41m[m
[32m+[m[32m        connection.query(query,function(err, rows) {[m[41m[m
[32m+[m[32m            resolve(rows[0][col]);[m[41m[m
[32m+[m[32m        })[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * リッチメニューの切り替え[m[41m[m
[32m+[m[32m * @param  {string} after 切り替え後のリッチメニューId（richdata）[m[41m[m
[32m+[m[32m * @param  {string} userId 切り替えるユーザId[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32masync function rich_change(after, userId) {[m[41m[m
[32m+[m[32m    var rich_url = urld_rich_delete.replace("{userId}", userId);[m[41m[m
[32m+[m[32m    var rich_url2 = urlp_rich_set.replace("{userId}", userId)[m[41m[m
[32m+[m[32m        .replace("{richMenuId}", after);[m[41m[m
[32m+[m[32m    var tmp = await Build_responce(rich_url2)[m[41m[m
[32m+[m[32m    request.delete(await Build_responce(rich_url), function(error, responce, body) {[m[41m[m
[32m+[m[32m        request.post(tmp);[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m *  テキストメッセージの生成[m[41m[m
[32m+[m[32m * @param {String} text テキストデータ[m[41m[m
[32m+[m[32m * @return {obj}   msg  テキストメッセージ[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction msg_text(text){[m[41m[m
[32m+[m[32m    var msg = {"type": "text"};[m[41m[m
[32m+[m[32m    msg.text = text;[m[41m[m
[32m+[m[32m    return msg;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * イメージマップメッセージの生成[m[41m[m
[32m+[m[32m * @param {string} usage 用途(map)[m[41m[m
[32m+[m[32m * @param {obj}    data  用途に対応するデータ[m[41m[m
[32m+[m[32m * @return {obj}   msg  イメージマップメッセージ[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction msg_imagemap(usage,data){[m[41m[m
[32m+[m[32m    var msg = {"type":"imagemap"};[m[41m[m
[32m+[m[32m    if(usage == "map"){[m[41m[m
[32m+[m[32m        var location = map_data[data.location];[m[41m[m
[32m+[m[32m        msg.baseUrl  = location.baseUrl;[m[41m[m
[32m+[m[32m        msg.altText  = location.altText;[m[41m[m
[32m+[m[32m        msg.baseSize = location.baseSize;[m[41m[m
[32m+[m[32m        msg.actions  = location.actions;[m[41m[m
[32m+[m[32m        // console.log(msg);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    return msg;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32masync function image_download(event) {[m[41m[m
[32m+[m[32m    let url = urlg_download_message.replace("{messageId}", event.message.id);[m[41m[m
[32m+[m[32m    let tmp = DB_get("UserData", "USERTYPE", "USERID", event.source.userId);[m[41m[m
[32m+[m[32m    let option = await Build_responce(url);[m[41m[m
[32m+[m[32m    option.encoding = null;[m[41m[m
[32m+[m[32m    let nowtime = moment().format('HH:mm:ss:SSS');[m[41m[m
[32m+[m[32m    let usertype = await tmp;[m[41m[m
[32m+[m[32m    request.get(option, function(err, res, body) {[m[41m[m
[32m+[m[32m        if(err) {[m[41m[m
[32m+[m[32m            console.log(body);[m[41m[m
[32m+[m[32m        } else {[m[41m[m
[32m+[m[32m            let path = "/kufes18/" + usertype + "/" +nowtime+ ".png"[m[41m[m
[32m+[m[32m            fs.writeFileSync("../" + nowtime + ".png", body, "binary");[m[41m[m
[32m+[m[32m            dbx({[m[41m[m
[32m+[m[32m                resource: 'files/upload',[m[41m[m
[32m+[m[32m                parameters: {[m[41m[m
[32m+[m[32m                    path: path[m[41m[m
[32m+[m[32m                },[m[41m[m
[32m+[m[32m                readStream: fs.createReadStream("../" + nowtime + ".png")[m[41m[m
[32m+[m[32m            }, (err, result, response) => {[m[41m[m
[32m+[m[32m                //upload completed[m[41m[m
[32m+[m[32m                fs.unlink("../" + nowtime + ".png",  function (err) {[m[41m[m
[32m+[m[32m                    if (err) {[m[41m[m
[32m+[m[32m                        console.log(err);[m[41m[m
[32m+[m[32m                    }[m[41m[m
[32m+[m[32m                });[m[41m[m
[32m+[m[32m            });[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * Event - messageの時のおおもと[m[41m[m
[32m+[m[32m * 基本的にlineへのレスポンスはここで行う[m[41m[m
[32m+[m[32m * @param  {obj} event LINEからのBody[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32masync function type_message(event) {[m[41m[m
[32m+[m[32m    // Dialogflowへの接続今のところしない[m[41m[m
[32m+[m[32m    var msg  = undefined;[m[41m[m
[32m+[m[32m    var msg2 = undefined;[m[41m[m
[32m+[m[32m    var msg3 = undefined;[m[41m[m
[32m+[m[32m    var msg4 = undefined;[m[41m[m
[32m+[m[32m    var msg5 = undefined;[m[41m[m
[32m+[m[32m    var mapdata  = new Object(); // mapの場所データなど[m[41m[m
[32m+[m[32m    // [エリア][ピンの番号]([][0] : エリア名)[m[41m[m
[32m+[m[32m    var OutsideArea =  [["A",1,2,3,4,5],[m[41m[m
[32m+[m[32m                        ["B",1,2,3,4],[m[41m[m
[32m+[m[32m                        ["C",1,2],[m[41m[m
[32m+[m[32m                        ["D",1,2,3,4,5,6,7,8],[m[41m[m
[32m+[m[32m                        ["E",1,2,3,4,5,6],[m[41m[m
[32m+[m[32m                        ["F",1,2,3]];[m[41m[m
[32m+[m[32m    // [棟][各階にあるのピンの数]]([][0] : 棟の数)[m[41m[m
[32m+[m[32m    // 8棟は1，3階だが、プログラム内では1,2階として処理する。[m[41m[m
[32m+[m[32m    var mapBFdata  = [[2,1,2,5,0],[m[41m[m
[32m+[m[32m                      [3,1,2,3,4],[m[41m[m
[32m+[m[32m                      [5,1,2],[m[41m[m
[32m+[m[32m                      [8,1,1]];[m[41m[m
[32m+[m[32m    switch(event.message.text) {[m[41m[m
[32m+[m[32m        case "近くの模擬店を探す":[m[41m[m
[32m+[m[32m            var userplace = await DB_get("UserData", "PLACE", "USERID", event.source.userId);[m[41m[m
[32m+[m[32m            if (userplace == "" || userplace == "hazama" || userplace == "joho") {[m[41m[m
[32m+[m[32m                msg = msg_text("近くに模擬店がないみたい...\n移動してからもう一度試してください");[m[41m[m
[32m+[m[32m            } else {[m[41m[m
[32m+[m[32m                //userplaceの場所に合う模擬店をjson or htmlから引っ張ってきてテンプレートメッセージにする[m[41m[m
[32m+[m[32m                msg = {[m[41m[m
[32m+[m[32m                    "type": "flex",[m[41m[m
[32m+[m[32m                    "altText": "This is a flex message.",[m[41m[m
[32m+[m[32m                    "contents": {[m[41m[m
[32m+[m[32m                        "type": "carousel",[m[41m[m
[32m+[m[32m                        "contents": [][m[41m[m
[32m+[m[32m                    }[m[41m[m
[32m+[m[32m                };[m[41m[m
[32m+[m[32m                for (var i=0; i<shop_area[userplace].length; i++) {[m[41m[m
[32m+[m[32m                    var shopid = shop_area[userplace][i];[m[41m[m
[32m+[m[32m                    msg.contents.contents.push(Build_flex(shopid));[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m            break;[m[41m[m
[32m+[m[32m        case "マップを表示":[m[41m[m
[32m+[m[32m            //mapdata.location = "Top";[m[41m[m
[32m+[m[32m            //msg = msg_imagemap("map",mapdata);[m[41m[m
[32m+[m[32m            msg = {[m[41m[m
[32m+[m[32m                "type": "flex",[m[41m[m
[32m+[m[32m                "altText":  "TOP",[m[41m[m
[32m+[m[32m                "contents": {}[m[41m[m
[32m+[m[32m            };[m[41m[m
[32m+[m[32m            var buttonTexts = ["[Top] 構外全体マップへ","[Top] 構内全体マップへ"];[m[41m[m
[32m+[m[32m            msg.contents = Build_flexButton(buttonTexts);[m[41m[m
[32m+[m[32m            break;[m[41m[m
[32m+[m[32m        case "[Top] 構内全体マップへ":[m[41m[m
[32m+[m[32m            mapdata.location = "InsideTop";[m[41m[m
[32m+[m[32m            msg = msg_imagemap("map",mapdata);[m[41m[m
[32m+[m[32m            msg2 = msg_text("棟を選択してください");[m[41m            [m
[32m+[m[32m            break;[m[41m[m
[32m+[m[32m        case "[Top] 構外全体マップへ":[m[41m[m
[32m+[m[32m            mapdata.location = "OutsideTop";[m[41m[m
[32m+[m[32m            msg = msg_imagemap("map",mapdata);[m[41m[m
[32m+[m[32m            msg2 = msg_text("エリアを選択してください");[m[41m[m
[32m+[m[32m            break;[m[41m[m
[32m+[m[32m        case "実装中":[m[41m[m
[32m+[m[32m            break;[m[41m[m
[32m+[m[32m        default:[m[41m[m
[32m+[m[32m            msg = msg_text("個別の返信はできません(*:△:)");[m[41m[m
[32m+[m[32m            break;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    /***** イメージマップタップ時の出力判定 *****/[m[41m[m
[32m+[m[32m    // [1] 構外マップ[m[41m[m
[32m+[m[32m    for(var i=0;i<OutsideArea.length;i++){[m[41m[m
[32m+[m[32m        for(var j=1;j<OutsideArea[i].length;j++){[m[41m[m
[32m+[m[32m            switch(event.message.text){[m[41m[m
[32m+[m[32m                case "エリア"+OutsideArea[i][0]+"の"+OutsideArea[i][j]+"番の模擬店情報を表示":[m[41m[m
[32m+[m[32m                    /*[m[41m[m
[32m+[m[32m                    msg = {[m[41m[m
[32m+[m[32m                        "type": "flex",[m[41m[m
[32m+[m[32m                        "altText": "エリア"+OutsideArea[i][0]+"の"+OutsideArea[i][j]+"番の模擬店情報",[m[41m[m
[32m+[m[32m                        "contents": {}[m[41m[m
[32m+[m[32m                    };[m[41m[m
[32m+[m[32m                    msg.contents = Build_flex(boothID_data["Outside"+OutsideArea[i][0]+OutsideArea[i][j]]);[m[41m[m
[32m+[m[32m                    */[m[41m[m
[32m+[m[32m                    msg = msg_text("debug message [エリアの模擬店情報]");[m[41m[m
[32m+[m[32m                    break;[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        switch(event.message.text){[m[41m[m
[32m+[m[32m            case "エリア"+OutsideArea[i][0]+"へ":[m[41m[m
[32m+[m[32m                mapdata.location = "Area"+OutsideArea[i][0];[m[41m[m
[32m+[m[32m                msg = msg_imagemap("map",mapdata);[m[41m[m
[32m+[m[32m                msg2 = msg_text("ピンを選択すると模擬店の詳細を表示します");[m[41m[m
[32m+[m[32m                break;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // [2] 構内マップ[m[41m[m
[32m+[m[32m    for(var i=0;i<mapBFdata.length;i++){[m[41m[m
[32m+[m[32m        for(var j=1;j<mapBFdata[i].length;j++){[m[41m[m
[32m+[m[32m            // フロアの画像送信部[m[41m[m
[32m+[m[32m            switch(event.message.texts){[m[41m[m
[32m+[m[32m                case mapBFdata[i][0] + "棟"+j+"階へ":[m[41m[m
[32m+[m[32m                    console.log("console");[m[41m[m
[32m+[m[32m                    mapdata.location = "I"+mapdata[i][0]+j;[m[41m[m
[32m+[m[32m                    msg = msg_imagemap("map",mapdata);[m[41m[m
[32m+[m[32m                    msg2 = msg_text("ピンを選択すると模擬店の詳細を表示します");[m[41m[m
[32m+[m[32m                    break;[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m            for(var k=1;k<=mapBFdata[i][j];k++){[m[41m[m
[32m+[m[32m                switch(event.message.text){[m[41m[m
[32m+[m[32m                    case mapBFdata[i][0]+"棟"+j+"階の"+k+"番目の模擬店情報を表示":[m[41m[m
[32m+[m[32m                        // 模擬店情報送信部[m[41m[m
[32m+[m[32m                        /*[m[41m[m
[32m+[m[32m                        msg = {[m[41m[m
[32m+[m[32m                            "type": "flex",[m[41m[m
[32m+[m[32m                            "altText":  mapBFdata[i][0]+"棟"+j+"階の"+k+"番目の模擬店情報",[m[41m[m
[32m+[m[32m                            "contents": {}[m[41m[m
[32m+[m[32m                        };[m[41m[m
[32m+[m[32m                        msg.contents = Build_flex(boothID_data["Inside"+mapBFdata[i][0]+j+k]);[m[41m[m
[32m+[m[32m                        */[m[41m[m
[32m+[m[32m                        msg = msg_text("debug message [~棟~階~番目の模擬店情報へ]");[m[41m[m
[32m+[m[32m                        break;[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        // 階数を選択するflexMessageの送信[m[41m[m
[32m+[m[32m        switch(event.message.text){[m[41m[m
[32m+[m[32m            case mapBFdata[i][0]+"棟へ":[m[41m[m
[32m+[m[32m                msg = {[m[41m[m
[32m+[m[32m                    "type": "flex",[m[41m[m
[32m+[m[32m                    "altText":  mapBFdata[i][0]+"棟の階を選択してください。",[m[41m[m
[32m+[m[32m                    "contents": {}[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m                var buttonTexts = [];[m[41m[m
[32m+[m[32m                for(j=1;j<mapBFdata[i].length;j++){[m[41m[m
[32m+[m[32m                    if(i==3 && j==2){[m[41m[m
[32m+[m[32m                        buttonTexts.push(mapBFdata[i][0]+"棟"+3+"階へ"); //8棟3階の処理[m[41m[m
[32m+[m[32m                    }else{[m[41m[m
[32m+[m[32m                        buttonTexts.push(mapBFdata[i][0]+"棟"+j+"階へ");[m[41m[m
[32m+[m[32m                    }[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m                console.log(buttonTexts);[m[41m[m
[32m+[m[32m                msg.contents = Build_flexButton(buttonTexts);[m[41m[m
[32m+[m[32m                break;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    //画像を送信してきた時の処理[m[41m[m
[32m+[m[32m    if (event.message.type == "image") {[m[41m[m
[32m+[m[32m        image_download(event);[m[41m[m
[32m+[m[32m        msg = msg_text("画像を送信してくれてありがとう(o・∇・o)");[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    if (msg){[m[41m[m
[32m+[m[32m        var tmp = await Build_responce(urlp_reply, await Build_msg_text([m[41m[m
[32m+[m[32m            event.replyToken,msg, msg2, msg3, msg4, msg5[m[41m[m
[32m+[m[32m        ));[m[41m[m
[32m+[m[32m        request.post(tmp);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * Event - followの時[m[41m[m
[32m+[m[32m * @param  {obj} event LINEからのBody[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32masync function type_follow(event) {[m[41m[m
[32m+[m[32m    //rich menuの登録[m[41m[m
[32m+[m[32m    var rich_url = urlp_rich_set.replace('{userId}', event.source.userId)[m[41m[m
[32m+[m[32m        .replace('{richMenuId}', richdata.start);[m[41m[m
[32m+[m[32m    request.post(await Build_responce(rich_url));[m[41m[m
[32m+[m[32m    var msg = {[m[41m[m
[32m+[m[32m        "type": "text",[m[41m[m
[32m+[m[32m        "text": "東京高専文化祭BOTを友達登録してくれてありがとう！"[m[41m[m
[32m+[m[32m    };[m[41m[m
[32m+[m[32m    var tmp = await Build_responce(urlp_reply, await Build_msg_text([m[41m[m
[32m+[m[32m        event.replyToken, msg[m[41m[m
[32m+[m[32m    ));[m[41m[m
[32m+[m[32m    request.post(tmp);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * ユーザが初回登録をした[m[41m[m
[32m+[m[32m * @param  {obj} event LINEからのBody[m[41m[m
[32m+[m[32m * @param  {string} usertype 学生 or 来場者[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32masync function addUser(event, usertype) {[m[41m[m
[32m+[m[32m    //DBへユーザの追加[m[41m[m
[32m+[m[32m    var nowtime = moment().format('YYYY-MM-DD HH:mm:ss');[m[41m[m
[32m+[m[32m    var query = 'INSERT INTO UserData (USERID, USERTYPE, BEACONTIME, PLACE) VALUES ("{id}", "{type}", "{time}", "{place}")';[m[41m[m
[32m+[m[32m    query = query.replace('{id}', event.source.userId)[m[41m[m
[32m+[m[32m        .replace('{type}', event.postback.data)[m[41m[m
[32m+[m[32m        .replace('{time}', nowtime)[m[41m[m
[32m+[m[32m        .replace('{place}', "");[m[41m[m
[32m+[m[32m    connection.query(query);[m[41m[m
[32m+[m[32m    //richmenuの切り替え[m[41m[m
[32m+[m[32m    rich_change(richdata.normal, event.source.userId);[m[41m[m
[32m+[m[32m    var msg = {[m[41m[m
[32m+[m[32m        "type": "text",[m[41m[m
[32m+[m[32m        "text": usertype + "と認証しました"[m[41m[m
[32m+[m[32m    };[m[41m[m
[32m+[m[32m    var tmp = await Build_responce(urlp_reply, await Build_msg_text([m[41m[m
[32m+[m[32m        event.replyToken, msg[m[41m[m
[32m+[m[32m    ));[m[41m[m
[32m+[m[32m    request.post(tmp);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * ユーザがブロックした[m[41m[m
[32m+[m[32m * @param  {obj} event LINEからのBody[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction removeUser(event) {[m[41m[m
[32m+[m[32m    var query = 'DELETE FROM UserData WHERE USERID = "{id}"'[m[41m[m
[32m+[m[32m        .replace("{id}", event.source.userId);[m[41m[m
[32m+[m[32m    connection.query(query);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * ビーコンに侵入した時のおおもと[m[41m[m
[32m+[m[32m * @param  {obj} event LINEからのBody[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32masync function type_beacon(event) {[m[41m[m
[32m+[m[32m    /* beacon侵入時間の更新 */[m[41m[m
[32m+[m[32m    var tmp = DB_get("UserData", "BEACONTIME", "USERID", event.source.userId);[m[41m[m
[32m+[m[32m    var now = moment();[m[41m[m
[32m+[m[32m    var nowtime = now.format('YYYY-MM-DD HH:mm:ss');[m[41m[m
[32m+[m[32m    var db_time = moment(await tmp);[m[41m[m
[32m+[m[32m    var db_place = DB_get("BeaconData", "PLACE", "BEACONID", event.beacon.hwid);[m[41m[m
[32m+[m[32m    //前回の侵入から7分経っている -> 更新してメッセージを送信[m[41m[m
[32m+[m[32m    if ((now.diff(db_time)/(1000*60)) >= 7 ) {[m[41m[m
[32m+[m[32m        var query = 'UPDATE UserData SET BEACONTIME = "{time}" WHERE USERID = "{id}"'[m[41m[m
[32m+[m[32m            .replace("{id}", event.source.userId)[m[41m[m
[32m+[m[32m            .replace("{time}", nowtime);[m[41m[m
[32m+[m[32m        connection.query(query);[m[41m[m
[32m+[m[32m        //メッセージを整形[m[41m[m
[32m+[m[32m        var db_msg = DB_get("BeaconData", "MESSAGE", "BEACONID", event.beacon.hwid);[m[41m[m
[32m+[m[32m        var msg = {[m[41m[m
[32m+[m[32m            "type": "text",[m[41m[m
[32m+[m[32m            "text": "現在，" + await db_place + "です"[m[41m[m
[32m+[m[32m        };[m[41m[m
[32m+[m[32m        var msg2 = {[m[41m[m
[32m+[m[32m            "type": "text",[m[41m[m
[32m+[m[32m            "text": "[おしらせ]\n" + await db_msg[m[41m[m
[32m+[m[32m        };[m[41m[m
[32m+[m[32m        var tmp = await Build_responce(urlp_reply, await Build_msg_text([m[41m[m
[32m+[m[32m            event.replyToken, msg, msg2[m[41m[m
[32m+[m[32m        ));[m[41m[m
[32m+[m[32m        request.post(tmp);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    //ユーザがいる場所を登録[m[41m[m
[32m+[m[32m    var query = 'UPDATE UserData SET PLACE = "{place}" WHERE USERID = "{id}"'[m[41m[m
[32m+[m[32m        .replace("{id}", event.source.userId)[m[41m[m
[32m+[m[32m        .replace("{place}", await db_place);[m[41m[m
[32m+[m[32m    connection.query(query);[m[41m[m
[32m+[m[32m    //体育館に侵入したならリッチメニューを切り替える[m[41m[m
[32m+[m[32m    if (db_place == "taiikukan") {[m[41m[m
[32m+[m[32m        rich_change(richdata.event, event.source.userId);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * ビーコンから退出した（体育館専用）[m[41m[m
[32m+[m[32m * @param  {obj} event LINEからのBody[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32masync function beacon_leave(event) {[m[41m[m
[32m+[m[32m    var p = DB_get("UserData", "PLACE", "USERID", event.source.userId);[m[41m[m
[32m+[m[32m    var db_place = await DB_get("BeaconData", "PLACE", "BEACONID", event.beacon.hwid);[m[41m[m
[32m+[m[32m    var user_place = await p;[m[41m[m
[32m+[m[32m    if (db_place == user_place) {[m[41m[m
[32m+[m[32m        var query = 'UPDATE UserData SET PLACE = "{place}" WHERE USERID = "{id}"'[m[41m[m
[32m+[m[32m            .replace("{id}", event.source.userId)[m[41m[m
[32m+[m[32m            .replace("{place}", "");[m[41m[m
[32m+[m[32m        connection.query(query);[m[41m[m
[32m+[m[32m        if (db_place == "taiikukan") {[m[41m[m
[32m+[m[32m            rich_change(richdata.normal, event.source.userId);[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/* MAIN */[m[41m[m
[32m+[m[32mrouter.post('/', function(req, res, next) {[m[41m[m
[32m+[m[32m    var responce = "";[m[41m[m
[32m+[m[32m    /* LINE認証 */[m[41m[m
[32m+[m[32m    const body = req.body; // Request body string[m[41m[m
[32m+[m[32m    const signature = crypto[m[41m[m
[32m+[m[32m        .createHmac('SHA256', channelSecret)[m[41m[m
[32m+[m[32m        .update(JSON.stringify(body)).digest('base64');[m[41m[m
[32m+[m[32m    if (req.header("x-line-signature") == signature) {[m[41m[m
[32m+[m[32m        //認証成功[m[41m[m
[32m+[m[32m        res.status(200);[m[41m[m
[32m+[m[32m        console.log("line_OK");[m[41m[m
[32m+[m[32m        //Eventは複数[m[41m[m
[32m+[m[32m        body.events.forEach((event) => {[m[41m[m
[32m+[m[32m            switch(event.type) {[m[41m[m
[32m+[m[32m                case "message":[m[41m[m
[32m+[m[32m                    type_message(event);[m[41m[m
[32m+[m[32m                    break;[m[41m[m
[32m+[m[32m                case "follow":[m[41m[m
[32m+[m[32m                    type_follow(event);[m[41m[m
[32m+[m[32m                    break;[m[41m[m
[32m+[m[32m                case "postback":[m[41m[m
[32m+[m[32m                    if (event.postback.data == "Student") { addUser(event, "学生"); }[m[41m[m
[32m+[m[32m                    else if (event.postback.data == "Other") { addUser(event, "来場者"); }[m[41m[m
[32m+[m[32m                    break;[m[41m[m
[32m+[m[32m                case "beacon":[m[41m[m
[32m+[m[32m                    if (event.beacon.type == "enter") { type_beacon(event); }[m[41m[m
[32m+[m[32m                    else if (event.beacon.type == "leave") { beacon_leave(event); }[m[41m[m
[32m+[m[32m                    break;[m[41m[m
[32m+[m[32m                case "unfollow":[m[41m[m
[32m+[m[32m                    removeUser(event);[m[41m[m
[32m+[m[32m                    break;[m[41m[m
[32m+[m[32m                default:[m[41m[m
[32m+[m[32m                    console.log(event);[m[41m[m
[32m+[m[32m                    break;[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        });[m[41m[m
[32m+[m[32m    } else {[m[41m[m
[32m+[m[32m        //認証失敗[m[41m[m
[32m+[m[32m        console.log("line_NG");[m[41m[m
[32m+[m[32m        res.status(403);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    res.send(responce);[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction pushOnlyDB(query) {[m[41m[m
[32m+[m[32m    return new Promise(function(resolve, reject) {[m[41m[m
[32m+[m[32m        connection.query(query,function(err, rows) {[m[41m[m
[32m+[m[32m            resolve(rows);[m[41m[m
[32m+[m[32m        });[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * 受け取るデータは[m[41m[m
[32m+[m[32m * @param {string} param mysql検索キー（where以下）[m[41m[m
[32m+[m[32m * @param {string} message 送信する文面[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mrouter.post('/pushmessage/send', async function(req, res, next) {[m[41m[m
[32m+[m[32m    var responce = "";[m[41m[m
[32m+[m[32m    const body = req.body; // Request body string[m[41m[m
[32m+[m[32m    let msg = msg_text(body.message);[m[41m[m
[32m+[m[32m    var query = 'SELECT USERID FROM UserData WHERE ' + body.param;[m[41m[m
[32m+[m[32m    let rows = await pushOnlyDB(query);[m[41m[m
[32m+[m[32m    let users = [];[m[41m[m
[32m+[m[32m    for (let i=0; i<rows.length; i++) {[m[41m[m
[32m+[m[32m        users.push(rows[i]["USERID"]);[m[41m[m
[32m+[m[32m        if (i%150 == 149) {[m[41m[m
[32m+[m[32m            let tmp = {[m[41m[m
[32m+[m[32m                "to": users,[m[41m[m
[32m+[m[32m                "messages": [msg][m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m            request.post(await Build_responce(urlp_push, tmp))[m[41m[m
[32m+[m[32m            users.length = 0;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    if (users.length != 0) {[m[41m[m
[32m+[m[32m        let tmp = {[m[41m[m
[32m+[m[32m            "to": users,[m[41m[m
[32m+[m[32m            "messages": [msg][m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        request.post(await Build_responce(urlp_push, tmp));[m[41m[m
[32m+[m[32m        users.length = 0;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    res.status = 200;[m[41m[m
[32m+[m[32m    res.send(responce);[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mmodule.exports = router;[m[41m[m
[1mdiff --git "a/api-server/routes/linebot_mapImg/\343\203\236\343\203\203\343\203\227\347\224\273\345\203\217\347\267\250\351\233\206\347\224\250.pptx" "b/api-server/routes/linebot_mapImg/\343\203\236\343\203\203\343\203\227\347\224\273\345\203\217\347\267\250\351\233\206\347\224\250.pptx"[m
[1mdeleted file mode 100644[m
[1mindex 809d7ab..0000000[m
Binary files "a/api-server/routes/linebot_mapImg/\343\203\236\343\203\203\343\203\227\347\224\273\345\203\217\347\267\250\351\233\206\347\224\250.pptx" and /dev/null differ
[1mdiff --git a/api-server/routes/mapdata.json b/api-server/routes/mapdata.json[m
[1mindex fcf66d5..6877ddb 100644[m
[1m--- a/api-server/routes/mapdata.json[m
[1m+++ b/api-server/routes/mapdata.json[m
[36m@@ -1,732 +1,732 @@[m
[31m-{[m
[31m-    "Top": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/Top/map-InOutChoice",[m
[31m-        "altText": "表示したいマップを選択してください",[m
[31m-        "baseSize": {[m
[31m-            "height": 585,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構内全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 0,[m
[31m-                    "y" : 0,[m
[31m-                    "width" : 520,[m
[31m-                    "height": 585[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 520,[m
[31m-                    "y" : 0,[m
[31m-                    "width" : 520,[m
[31m-                    "height": 585[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "OutsideTop": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/Top/map-OutsideTop",[m
[31m-        "altText": "[Top] 構外全体マップ",[m
[31m-        "baseSize": {[m
[31m-            "height": 469,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構内全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 731,[m
[31m-                    "y": 55,[m
[31m-                    "width": 256,[m
[31m-                    "height": 63[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアAへ",[m
[31m-                "area": {[m
[31m-                    "x": 200,[m
[31m-                    "y": 50,[m
[31m-                    "width": 200,[m
[31m-                    "height": 120[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアBへ",[m
[31m-                "area": {[m
[31m-                    "x": 445,[m
[31m-                    "y": 19,[m
[31m-                    "width": 149,[m
[31m-                    "height": 97[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアCへ",[m
[31m-                "area": {[m
[31m-                    "x": 445,[m
[31m-                    "y": 135,[m
[31m-                    "width": 158,[m
[31m-                    "height": 97[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアDへ",[m
[31m-                "area": {[m
[31m-                    "x": 445,[m
[31m-                    "y": 253,[m
[31m-                    "width": 148,[m
[31m-                    "height": 136[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアEへ",[m
[31m-                "area": {[m
[31m-                    "x": 672,[m
[31m-                    "y": 303,[m
[31m-                    "width": 167,[m
[31m-                    "height": 87[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアFへ",[m
[31m-                "area": {[m
[31m-                    "x": 613,[m
[31m-                    "y": 211,[m
[31m-                    "width": 114,[m
[31m-                    "height": 76[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "AreaA": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-A",[m
[31m-        "altText": "エリアA",[m
[31m-        "baseSize": {[m
[31m-            "height": 598,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 730,[m
[31m-                    "y": 32,[m
[31m-                    "width": 268,[m
[31m-                    "height": 61[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアAの1番の模擬店情報を表示",[m
[31m-                "area": {[m
[31m-                    "x": 160,[m
[31m-                    "y": 81,[m
[31m-                    "width": 61,[m
[31m-                    "height": 161[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアAの2番の模擬店情報を表示",[m
[31m-                "area": {[m
[31m-                    "x": 255,[m
[31m-                    "y": 80,[m
[31m-                    "width": 70,[m
[31m-                    "height": 163[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアAの3番の模擬店情報を表示",[m
[31m-                "area": {[m
[31m-                    "x": 503,[m
[31m-                    "y": 80,[m
[31m-                    "width": 69,[m
[31m-                    "height": 174[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアAの4番の模擬店情報を表示",[m
[31m-                "area": {[m
[31m-                    "x": 596,[m
[31m-                    "y": 82,[m
[31m-                    "width": 72,[m
[31m-                    "height": 107[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアAの5番の模擬店情報を表示",[m
[31m-                "area": {[m
[31m-                    "x": 872,[m
[31m-                    "y": 200,[m
[31m-                    "width": 77,[m
[31m-                    "height": 117[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "AreaB": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-B",[m
[31m-        "altText": "エリアB",[m
[31m-        "baseSize": {[m
[31m-            "height": 600,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 744,[m
[31m-                    "y": 511,[m
[31m-                    "width": 264,[m
[31m-                    "height": 67[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアBの1番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 293,[m
[31m-                    "y": 23,[m
[31m-                    "width": 78,[m
[31m-                    "height": 140[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアBの2番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 359,[m
[31m-                    "y": 24,[m
[31m-                    "width": 79,[m
[31m-                    "height": 135[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアBの3番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 475,[m
[31m-                    "y": 24,[m
[31m-                    "width": 82,[m
[31m-                    "height": 137[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアBの4番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 594,[m
[31m-                    "y": 24,[m
[31m-                    "width": 79,[m
[31m-                    "height": 140[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "AreaC": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-C",[m
[31m-        "altText": "エリアC",[m
[31m-        "baseSize": {[m
[31m-            "height": 692,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 720,[m
[31m-                    "y": 32,[m
[31m-                    "width": 295,[m
[31m-                    "height": 75[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアCの1番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 528,[m
[31m-                    "y": 478,[m
[31m-                    "width": 94,[m
[31m-                    "height": 78[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアCの2番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 532,[m
[31m-                    "y": 568,[m
[31m-                    "width": 73,[m
[31m-                    "height": 78[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "AreaD": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-D",[m
[31m-        "altText": "エリアD",[m
[31m-        "baseSize": {[m
[31m-            "height": 654,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 719,[m
[31m-                    "y": 33,[m
[31m-                    "width": 296,[m
[31m-                    "height": 74[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアDの1番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 524,[m
[31m-                    "y": 140,[m
[31m-                    "width": 119,[m
[31m-                    "height": 84[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアDの2番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 526,[m
[31m-                    "y": 237,[m
[31m-                    "width": 106,[m
[31m-                    "height": 87[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアDの3番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 529,[m
[31m-                    "y": 425,[m
[31m-                    "width": 105,[m
[31m-                    "height": 86[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアDの4番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 526,[m
[31m-                    "y": 426,[m
[31m-                    "width": 101,[m
[31m-                    "height": 81[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアDの5番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 828,[m
[31m-                    "y": 181,[m
[31m-                    "width": 112,[m
[31m-                    "height": 79[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアDの6番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 836,[m
[31m-                    "y": 272,[m
[31m-                    "width": 96,[m
[31m-                    "height": 80[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアDの7番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 824,[m
[31m-                    "y": 359,[m
[31m-                    "width": 107,[m
[31m-                    "height": 81[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアDの8番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 824,[m
[31m-                    "y": 449,[m
[31m-                    "width": 108,[m
[31m-                    "height": 81[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "AreaE": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-E",[m
[31m-        "altText": "エリアE",[m
[31m-        "baseSize": {[m
[31m-            "height": 654,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 719,[m
[31m-                    "y": 30,[m
[31m-                    "width": 296,[m
[31m-                    "height": 77[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアEの1番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 203,[m
[31m-                    "y": 115,[m
[31m-                    "width": 87,[m
[31m-                    "height": 158[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアEの2番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 314,[m
[31m-                    "y": 114,[m
[31m-                    "width": 87,[m
[31m-                    "height": 161[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアEの3番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 538,[m
[31m-                    "y": 113,[m
[31m-                    "width": 89,[m
[31m-                    "height": 164[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアEの4番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 651,[m
[31m-                    "y": 111,[m
[31m-                    "width": 83,[m
[31m-                    "height": 164[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアEの5番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 763,[m
[31m-                    "y": 115,[m
[31m-                    "width": 82,[m
[31m-                    "height": 160[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアEの4番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 876,[m
[31m-                    "y": 115,[m
[31m-                    "width": 82,[m
[31m-                    "height": 162[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "AreaF": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-F",[m
[31m-        "altText": "エリアF",[m
[31m-        "baseSize": {[m
[31m-            "height": 655,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 719,[m
[31m-                    "y": 33,[m
[31m-                    "width": 298,[m
[31m-                    "height": 76[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアFの1番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 220,[m
[31m-                    "y": 322,[m
[31m-                    "width": 83,[m
[31m-                    "height": 175[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアFの2番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 374,[m
[31m-                    "y": 322,[m
[31m-                    "width": 89,[m
[31m-                    "height": 175[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "エリアFの3番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 520,[m
[31m-                    "y": 320,[m
[31m-                    "width": 100,[m
[31m-                    "height": 180[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "InsideTop": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/Top/map-InsideTop",[m
[31m-        "altText": "[Top] 構内全体マップ",[m
[31m-        "baseSize": {[m
[31m-            "height": 565,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 38,[m
[31m-                    "y": 54,[m
[31m-                    "width": 200,[m
[31m-                    "height": 50[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "2棟へ",[m
[31m-                "area": {[m
[31m-                    "x": 304,[m
[31m-                    "y" : 318,[m
[31m-                    "width" : 410,[m
[31m-                    "height": 81[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "3棟へ",[m
[31m-                "area": {[m
[31m-                    "x": 304,[m
[31m-                    "y" : 163,[m
[31m-                    "width" : 412,[m
[31m-                    "height":  81[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "5棟へ",[m
[31m-                "area": {[m
[31m-                    "x": 304,[m
[31m-                    "y" : 10,[m
[31m-                    "width" : 409,[m
[31m-                    "height":  77[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "8棟へ",[m
[31m-                "area": {[m
[31m-                    "x": 160,[m
[31m-                    "y" : 474,[m
[31m-                    "width" : 141,[m
[31m-                    "height":  79[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "I21": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/inside/map-inside2-1",[m
[31m-        "altText": "2棟1階",[m
[31m-        "baseSize": {[m
[31m-            "height": 566,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 50,[m
[31m-                    "y": 26,[m
[31m-                    "width": 216,[m
[31m-                    "height": 52[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "2棟1階の1番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 623,[m
[31m-                    "y": 179,[m
[31m-                    "width": 94,[m
[31m-                    "height": 183[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "I22": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/inside/map-inside2-2",[m
[31m-        "altText": "2棟2階",[m
[31m-        "baseSize": {[m
[31m-            "height": 566,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 25,[m
[31m-                    "y": 13,[m
[31m-                    "width": 215,[m
[31m-                    "height": 55[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "2棟2階の1番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 757,[m
[31m-                    "y": 179,[m
[31m-                    "width": 91,[m
[31m-                    "height": 188[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "2棟2階の2番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 891,[m
[31m-                    "y": 185,[m
[31m-                    "width": 98,[m
[31m-                    "height": 183[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "I23": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/inside/map-inside2-3",[m
[31m-        "altText": "2棟3階",[m
[31m-        "baseSize": {[m
[31m-            "height": 566,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 52,[m
[31m-                    "y": 27,[m
[31m-                    "width": 213,[m
[31m-                    "height": 51[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "2棟3階の1番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 364,[m
[31m-                    "y": 180,[m
[31m-                    "width": 87,[m
[31m-                    "height": 189[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "2棟3階の2番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 487,[m
[31m-                    "y": 180,[m
[31m-                    "width": 101,[m
[31m-                    "height": 189[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "2棟3階の3番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 625,[m
[31m-                    "y": 180,[m
[31m-                    "width": 96,[m
[31m-                    "height": 189[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "2棟3階の4番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 757,[m
[31m-                    "y": 180,[m
[31m-                    "width": 90,[m
[31m-                    "height": 189[m
[31m-                }[m
[31m-            },[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "2棟3階の5番の模擬店を表示",[m
[31m-                "area": {[m
[31m-                    "x": 891,[m
[31m-                    "y": 180,[m
[31m-                    "width": 99,[m
[31m-                    "height": 189[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    },[m
[31m-    "I24": {[m
[31m-        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/inside/map-inside2-4",[m
[31m-        "altText": "2棟4階",[m
[31m-        "baseSize": {[m
[31m-            "height": 566,[m
[31m-            "width": 1040[m
[31m-        },[m
[31m-        "actions": [[m
[31m-            {[m
[31m-                "type": "message",[m
[31m-                "text": "[Top] 構外全体マップへ",[m
[31m-                "area": {[m
[31m-                    "x": 52,[m
[31m-                    "y": 24,[m
[31m-                    "width": 215,[m
[31m-                    "height": 56[m
[31m-                }[m
[31m-            }[m
[31m-        ][m
[31m-    }[m
[32m+[m[32m{[m[41m[m
[32m+[m[32m    "Top": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/Top/map-InOutChoice",[m[41m[m
[32m+[m[32m        "altText": "表示したいマップを選択してください",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 585,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構内全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 0,[m[41m[m
[32m+[m[32m                    "y" : 0,[m[41m[m
[32m+[m[32m                    "width" : 520,[m[41m[m
[32m+[m[32m                    "height": 585[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 520,[m[41m[m
[32m+[m[32m                    "y" : 0,[m[41m[m
[32m+[m[32m                    "width" : 520,[m[41m[m
[32m+[m[32m                    "height": 585[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "OutsideTop": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/Top/map-OutsideTop",[m[41m[m
[32m+[m[32m        "altText": "[Top] 構外全体マップ",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 469,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構内全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 731,[m[41m[m
[32m+[m[32m                    "y": 55,[m[41m[m
[32m+[m[32m                    "width": 256,[m[41m[m
[32m+[m[32m                    "height": 63[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアAへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 200,[m[41m[m
[32m+[m[32m                    "y": 50,[m[41m[m
[32m+[m[32m                    "width": 200,[m[41m[m
[32m+[m[32m                    "height": 120[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアBへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 445,[m[41m[m
[32m+[m[32m                    "y": 19,[m[41m[m
[32m+[m[32m                    "width": 149,[m[41m[m
[32m+[m[32m                    "height": 97[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアCへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 445,[m[41m[m
[32m+[m[32m                    "y": 135,[m[41m[m
[32m+[m[32m                    "width": 158,[m[41m[m
[32m+[m[32m                    "height": 97[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアDへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 445,[m[41m[m
[32m+[m[32m                    "y": 253,[m[41m[m
[32m+[m[32m                    "width": 148,[m[41m[m
[32m+[m[32m                    "height": 136[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアEへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 672,[m[41m[m
[32m+[m[32m                    "y": 303,[m[41m[m
[32m+[m[32m                    "width": 167,[m[41m[m
[32m+[m[32m                    "height": 87[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアFへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 613,[m[41m[m
[32m+[m[32m                    "y": 211,[m[41m[m
[32m+[m[32m                    "width": 114,[m[41m[m
[32m+[m[32m                    "height": 76[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "AreaA": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-A",[m[41m[m
[32m+[m[32m        "altText": "エリアA",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 598,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 730,[m[41m[m
[32m+[m[32m                    "y": 32,[m[41m[m
[32m+[m[32m                    "width": 268,[m[41m[m
[32m+[m[32m                    "height": 61[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアAの1番の模擬店情報を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 160,[m[41m[m
[32m+[m[32m                    "y": 81,[m[41m[m
[32m+[m[32m                    "width": 61,[m[41m[m
[32m+[m[32m                    "height": 161[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアAの2番の模擬店情報を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 255,[m[41m[m
[32m+[m[32m                    "y": 80,[m[41m[m
[32m+[m[32m                    "width": 70,[m[41m[m
[32m+[m[32m                    "height": 163[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアAの3番の模擬店情報を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 503,[m[41m[m
[32m+[m[32m                    "y": 80,[m[41m[m
[32m+[m[32m                    "width": 69,[m[41m[m
[32m+[m[32m                    "height": 174[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアAの4番の模擬店情報を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 596,[m[41m[m
[32m+[m[32m                    "y": 82,[m[41m[m
[32m+[m[32m                    "width": 72,[m[41m[m
[32m+[m[32m                    "height": 107[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアAの5番の模擬店情報を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 872,[m[41m[m
[32m+[m[32m                    "y": 200,[m[41m[m
[32m+[m[32m                    "width": 77,[m[41m[m
[32m+[m[32m                    "height": 117[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "AreaB": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-B",[m[41m[m
[32m+[m[32m        "altText": "エリアB",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 600,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 744,[m[41m[m
[32m+[m[32m                    "y": 511,[m[41m[m
[32m+[m[32m                    "width": 264,[m[41m[m
[32m+[m[32m                    "height": 67[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアBの1番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 293,[m[41m[m
[32m+[m[32m                    "y": 23,[m[41m[m
[32m+[m[32m                    "width": 78,[m[41m[m
[32m+[m[32m                    "height": 140[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアBの2番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 359,[m[41m[m
[32m+[m[32m                    "y": 24,[m[41m[m
[32m+[m[32m                    "width": 79,[m[41m[m
[32m+[m[32m                    "height": 135[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアBの3番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 475,[m[41m[m
[32m+[m[32m                    "y": 24,[m[41m[m
[32m+[m[32m                    "width": 82,[m[41m[m
[32m+[m[32m                    "height": 137[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアBの4番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 594,[m[41m[m
[32m+[m[32m                    "y": 24,[m[41m[m
[32m+[m[32m                    "width": 79,[m[41m[m
[32m+[m[32m                    "height": 140[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "AreaC": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-C",[m[41m[m
[32m+[m[32m        "altText": "エリアC",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 692,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 720,[m[41m[m
[32m+[m[32m                    "y": 32,[m[41m[m
[32m+[m[32m                    "width": 295,[m[41m[m
[32m+[m[32m                    "height": 75[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアCの1番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 528,[m[41m[m
[32m+[m[32m                    "y": 478,[m[41m[m
[32m+[m[32m                    "width": 94,[m[41m[m
[32m+[m[32m                    "height": 78[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアCの2番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 532,[m[41m[m
[32m+[m[32m                    "y": 568,[m[41m[m
[32m+[m[32m                    "width": 73,[m[41m[m
[32m+[m[32m                    "height": 78[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "AreaD": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-D",[m[41m[m
[32m+[m[32m        "altText": "エリアD",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 654,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 719,[m[41m[m
[32m+[m[32m                    "y": 33,[m[41m[m
[32m+[m[32m                    "width": 296,[m[41m[m
[32m+[m[32m                    "height": 74[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアDの1番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 524,[m[41m[m
[32m+[m[32m                    "y": 140,[m[41m[m
[32m+[m[32m                    "width": 119,[m[41m[m
[32m+[m[32m                    "height": 84[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアDの2番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 526,[m[41m[m
[32m+[m[32m                    "y": 237,[m[41m[m
[32m+[m[32m                    "width": 106,[m[41m[m
[32m+[m[32m                    "height": 87[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアDの3番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 529,[m[41m[m
[32m+[m[32m                    "y": 425,[m[41m[m
[32m+[m[32m                    "width": 105,[m[41m[m
[32m+[m[32m                    "height": 86[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアDの4番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 526,[m[41m[m
[32m+[m[32m                    "y": 426,[m[41m[m
[32m+[m[32m                    "width": 101,[m[41m[m
[32m+[m[32m                    "height": 81[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアDの5番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 828,[m[41m[m
[32m+[m[32m                    "y": 181,[m[41m[m
[32m+[m[32m                    "width": 112,[m[41m[m
[32m+[m[32m                    "height": 79[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアDの6番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 836,[m[41m[m
[32m+[m[32m                    "y": 272,[m[41m[m
[32m+[m[32m                    "width": 96,[m[41m[m
[32m+[m[32m                    "height": 80[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアDの7番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 824,[m[41m[m
[32m+[m[32m                    "y": 359,[m[41m[m
[32m+[m[32m                    "width": 107,[m[41m[m
[32m+[m[32m                    "height": 81[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアDの8番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 824,[m[41m[m
[32m+[m[32m                    "y": 449,[m[41m[m
[32m+[m[32m                    "width": 108,[m[41m[m
[32m+[m[32m                    "height": 81[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "AreaE": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-E",[m[41m[m
[32m+[m[32m        "altText": "エリアE",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 654,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 719,[m[41m[m
[32m+[m[32m                    "y": 30,[m[41m[m
[32m+[m[32m                    "width": 296,[m[41m[m
[32m+[m[32m                    "height": 77[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアEの1番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 203,[m[41m[m
[32m+[m[32m                    "y": 115,[m[41m[m
[32m+[m[32m                    "width": 87,[m[41m[m
[32m+[m[32m                    "height": 158[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアEの2番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 314,[m[41m[m
[32m+[m[32m                    "y": 114,[m[41m[m
[32m+[m[32m                    "width": 87,[m[41m[m
[32m+[m[32m                    "height": 161[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアEの3番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 538,[m[41m[m
[32m+[m[32m                    "y": 113,[m[41m[m
[32m+[m[32m                    "width": 89,[m[41m[m
[32m+[m[32m                    "height": 164[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアEの4番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 651,[m[41m[m
[32m+[m[32m                    "y": 111,[m[41m[m
[32m+[m[32m                    "width": 83,[m[41m[m
[32m+[m[32m                    "height": 164[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアEの5番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 763,[m[41m[m
[32m+[m[32m                    "y": 115,[m[41m[m
[32m+[m[32m                    "width": 82,[m[41m[m
[32m+[m[32m                    "height": 160[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアEの4番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 876,[m[41m[m
[32m+[m[32m                    "y": 115,[m[41m[m
[32m+[m[32m                    "width": 82,[m[41m[m
[32m+[m[32m                    "height": 162[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "AreaF": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/outside/map-mogi-F",[m[41m[m
[32m+[m[32m        "altText": "エリアF",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 655,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 719,[m[41m[m
[32m+[m[32m                    "y": 33,[m[41m[m
[32m+[m[32m                    "width": 298,[m[41m[m
[32m+[m[32m                    "height": 76[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアFの1番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 220,[m[41m[m
[32m+[m[32m                    "y": 322,[m[41m[m
[32m+[m[32m                    "width": 83,[m[41m[m
[32m+[m[32m                    "height": 175[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアFの2番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 374,[m[41m[m
[32m+[m[32m                    "y": 322,[m[41m[m
[32m+[m[32m                    "width": 89,[m[41m[m
[32m+[m[32m                    "height": 175[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "エリアFの3番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 520,[m[41m[m
[32m+[m[32m                    "y": 320,[m[41m[m
[32m+[m[32m                    "width": 100,[m[41m[m
[32m+[m[32m                    "height": 180[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "InsideTop": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/Top/map-InsideTop",[m[41m[m
[32m+[m[32m        "altText": "[Top] 構内全体マップ",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 565,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 38,[m[41m[m
[32m+[m[32m                    "y": 54,[m[41m[m
[32m+[m[32m                    "width": 200,[m[41m[m
[32m+[m[32m                    "height": 50[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "2棟へ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 304,[m[41m[m
[32m+[m[32m                    "y" : 318,[m[41m[m
[32m+[m[32m                    "width" : 410,[m[41m[m
[32m+[m[32m                    "height": 81[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "3棟へ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 304,[m[41m[m
[32m+[m[32m                    "y" : 163,[m[41m[m
[32m+[m[32m                    "width" : 412,[m[41m[m
[32m+[m[32m                    "height":  81[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "5棟へ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 304,[m[41m[m
[32m+[m[32m                    "y" : 10,[m[41m[m
[32m+[m[32m                    "width" : 409,[m[41m[m
[32m+[m[32m                    "height":  77[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "8棟へ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 160,[m[41m[m
[32m+[m[32m                    "y" : 474,[m[41m[m
[32m+[m[32m                    "width" : 141,[m[41m[m
[32m+[m[32m                    "height":  79[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "I21": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/inside/map-inside2-1",[m[41m[m
[32m+[m[32m        "altText": "2棟1階",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 566,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 50,[m[41m[m
[32m+[m[32m                    "y": 26,[m[41m[m
[32m+[m[32m                    "width": 216,[m[41m[m
[32m+[m[32m                    "height": 52[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "2棟1階の1番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 623,[m[41m[m
[32m+[m[32m                    "y": 179,[m[41m[m
[32m+[m[32m                    "width": 94,[m[41m[m
[32m+[m[32m                    "height": 183[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "I22": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/inside/map-inside2-2",[m[41m[m
[32m+[m[32m        "altText": "2棟2階",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 566,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 25,[m[41m[m
[32m+[m[32m                    "y": 13,[m[41m[m
[32m+[m[32m                    "width": 215,[m[41m[m
[32m+[m[32m                    "height": 55[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "2棟2階の1番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 757,[m[41m[m
[32m+[m[32m                    "y": 179,[m[41m[m
[32m+[m[32m                    "width": 91,[m[41m[m
[32m+[m[32m                    "height": 188[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "2棟2階の2番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 891,[m[41m[m
[32m+[m[32m                    "y": 185,[m[41m[m
[32m+[m[32m                    "width": 98,[m[41m[m
[32m+[m[32m                    "height": 183[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "I23": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/inside/map-inside2-3",[m[41m[m
[32m+[m[32m        "altText": "2棟3階",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 566,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 52,[m[41m[m
[32m+[m[32m                    "y": 27,[m[41m[m
[32m+[m[32m                    "width": 213,[m[41m[m
[32m+[m[32m                    "height": 51[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "2棟3階の1番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 364,[m[41m[m
[32m+[m[32m                    "y": 180,[m[41m[m
[32m+[m[32m                    "width": 87,[m[41m[m
[32m+[m[32m                    "height": 189[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "2棟3階の2番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 487,[m[41m[m
[32m+[m[32m                    "y": 180,[m[41m[m
[32m+[m[32m                    "width": 101,[m[41m[m
[32m+[m[32m                    "height": 189[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "2棟3階の3番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 625,[m[41m[m
[32m+[m[32m                    "y": 180,[m[41m[m
[32m+[m[32m                    "width": 96,[m[41m[m
[32m+[m[32m                    "height": 189[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "2棟3階の4番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 757,[m[41m[m
[32m+[m[32m                    "y": 180,[m[41m[m
[32m+[m[32m                    "width": 90,[m[41m[m
[32m+[m[32m                    "height": 189[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "2棟3階の5番の模擬店を表示",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 891,[m[41m[m
[32m+[m[32m                    "y": 180,[m[41m[m
[32m+[m[32m                    "width": 99,[m[41m[m
[32m+[m[32m                    "height": 189[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    },[m[41m[m
[32m+[m[32m    "I24": {[m[41m[m
[32m+[m[32m        "baseUrl": "https://18feslinebotmapimg.web.fc2.com/linebot_mapImg5/inside/map-inside2-4",[m[41m[m
[32m+[m[32m        "altText": "2棟4階",[m[41m[m
[32m+[m[32m        "baseSize": {[m[41m[m
[32m+[m[32m            "height": 566,[m[41m[m
[32m+[m[32m            "width": 1040[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "actions": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "type": "message",[m[41m[m
[32m+[m[32m                "text": "[Top] 構外全体マップへ",[m[41m[m
[32m+[m[32m                "area": {[m[41m[m
[32m+[m[32m                    "x": 52,[m[41m[m
[32m+[m[32m                    "y": 24,[m[41m[m
[32m+[m[32m                    "width": 215,[m[41m[m
[32m+[m[32m                    "height": 56[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    }[m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/api-server/routes/rich.json b/api-server/routes/rich.json[m
[1mindex 476a26c..b4263be 100644[m
[1m--- a/api-server/routes/rich.json[m
[1m+++ b/api-server/routes/rich.json[m
[36m@@ -1,5 +1,5 @@[m
[31m-{[m
[31m-    "normal": "richmenu-62bb974327102e67f067e89f8dd7e5a0",[m
[31m-    "start":  "richmenu-83b09a0cb5c385d71b5a0f0d22b9dec5",[m
[31m-    "event": ""[m
[32m+[m[32m{[m[41m[m
[32m+[m[32m    "normal": "richmenu-62bb974327102e67f067e89f8dd7e5a0",[m[41m[m
[32m+[m[32m    "start":  "richmenu-83b09a0cb5c385d71b5a0f0d22b9dec5",[m[41m[m
[32m+[m[32m    "event": ""[m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/api-server/routes/shop-area.json b/api-server/routes/shop-area.json[m
[1mindex e495192..ef1240c 100644[m
[1m--- a/api-server/routes/shop-area.json[m
[1m+++ b/api-server/routes/shop-area.json[m
[36m@@ -1,61 +1,61 @@[m
[31m-{[m
[31m-    "A": [[m
[31m-        "v4E",[m
[31m-        "abd",[m
[31m-        "v4C",[m
[31m-        "cm",[m
[31m-        "htb"[m
[31m-    ],[m
[31m-    "B": [[m
[31m-        "c2D",[m
[31m-        "hb",[m
[31m-        "v2AC",[m
[31m-        "bsk"[m
[31m-    ],[m
[31m-    "C": [[m
[31m-        "v5E",[m
[31m-        "v2M",[m
[31m-        "huge"[m
[31m-    ],[m
[31m-    "D": [[m
[31m-        "fb",[m
[31m-        "bd",[m
[31m-        "kusa",[m
[31m-        "sw",[m
[31m-        "yku",[m
[31m-        "vb",[m
[31m-        "fs",[m
[31m-        "1AC"[m
[31m-    ],[m
[31m-    "taiikukan": [[m
[31m-        "fb",[m
[31m-        "bd",[m
[31m-        "kusa",[m
[31m-        "sw",[m
[31m-        "yku",[m
[31m-        "vb",[m
[31m-        "fs",[m
[31m-        "1AC"[m
[31m-    ],[m
[31m-    "E": [[m
[31m-        "hl",[m
[31m-        "v5C",[m
[31m-        "c4J",[m
[31m-        "tnf",[m
[31m-        "v3D",[m
[31m-        "cyc"[m
[31m-    ],[m
[31m-    "seimon": [[m
[31m-        "hl",[m
[31m-        "v5C",[m
[31m-        "c4J",[m
[31m-        "tnf",[m
[31m-        "v3D",[m
[31m-        "cyc"[m
[31m-    ],[m
[31m-    "F": [[m
[31m-        "c2C",[m
[31m-        "c4M",[m
[31m-        "v5E"[m
[31m-    ][m
[32m+[m[32m{[m[41m[m
[32m+[m[32m    "A": [[m[41m[m
[32m+[m[32m        "v4E",[m[41m[m
[32m+[m[32m        "abd",[m[41m[m
[32m+[m[32m        "v4C",[m[41m[m
[32m+[m[32m        "cm",[m[41m[m
[32m+[m[32m        "htb"[m[41m[m
[32m+[m[32m    ],[m[41m[m
[32m+[m[32m    "B": [[m[41m[m
[32m+[m[32m        "c2D",[m[41m[m
[32m+[m[32m        "hb",[m[41m[m
[32m+[m[32m        "v2AC",[m[41m[m
[32m+[m[32m        "bsk"[m[41m[m
[32m+[m[32m    ],[m[41m[m
[32m+[m[32m    "C": [[m[41m[m
[32m+[m[32m        "v5E",[m[41m[m
[32m+[m[32m        "v2M",[m[41m[m
[32m+[m[32m        "huge"[m[41m[m
[32m+[m[32m    ],[m[41m[m
[32m+[m[32m    "D": [[m[41m[m
[32m+[m[32m        "fb",[m[41m[m
[32m+[m[32m        "bd",[m[41m[m
[32m+[m[32m        "kusa",[m[41m[m
[32m+[m[32m        "sw",[m[41m[m
[32m+[m[32m        "yku",[m[41m[m
[32m+[m[32m        "vb",[m[41m[m
[32m+[m[32m        "fs",[m[41m[m
[32m+[m[32m        "1AC"[m[41m[m
[32m+[m[32m    ],[m[41m[m
[32m+[m[32m    "taiikukan": [[m[41m[m
[32m+[m[32m        "fb",[m[41m[m
[32m+[m[32m        "bd",[m[41m[m
[32m+[m[32m        "kusa",[m[41m[m
[32m+[m[32m        "sw",[m[41m[m
[32m+[m[32m        "yku",[m[41m[m
[32m+[m[32m        "vb",[m[41m[m
[32m+[m[32m        "fs",[m[41m[m
[32m+[m[32m        "1AC"[m[41m[m
[32m+[m[32m    ],[m[41m[m
[32m+[m[32m    "E": [[m[41m[m
[32m+[m[32m        "hl",[m[41m[m
[32m+[m[32m        "v5C",[m[41m[m
[32m+[m[32m        "c4J",[m[41m[m
[32m+[m[32m        "tnf",[m[41m[m
[32m+[m[32m        "v3D",[m[41m[m
[32m+[m[32m        "cyc"[m[41m[m
[32m+[m[32m    ],[m[41m[m
[32m+[m[32m    "seimon": [[m[41m[m
[32m+[m[32m        "hl",[m[41m[m
[32m+[m[32m        "v5C",[m[41m[m
[32m+[m[32m        "c4J",[m[41m[m
[32m+[m[32m        "tnf",[m[41m[m
[32m+[m[32m        "v3D",[m[41m[m
[32m+[m[32m        "cyc"[m[41m[m
[32m+[m[32m    ],[m[41m[m
[32m+[m[32m    "F": [[m[41m[m
[32m+[m[32m        "c2C",[m[41m[m
[32m+[m[32m        "c4M",[m[41m[m
[32m+[m[32m        "v5E"[m[41m[m
[32m+[m[32m    ][m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/api-server/routes/shop-map.json b/api-server/routes/shop-map.json[m
[1mindex 15c1eb0..6c703d6 100644[m
[1m--- a/api-server/routes/shop-map.json[m
[1m+++ b/api-server/routes/shop-map.json[m
[36m@@ -1,42 +1,42 @@[m
[31m-{[m
[31m-    "c2D" :"https://a.co.jp",[m
[31m-    "c2C" :"https://a.co.jp",[m
[31m-    "c4M" :"https://a.co.jp",[m
[31m-    "c4E" :"https://a.co.jp",[m
[31m-    "c4C" :"https://a.co.jp",[m
[31m-    "abd" :"https://a.co.jp",[m
[31m-    "v5D" :"https://a.co.jp",[m
[31m-    "v5E" :"https://a.co.jp",[m
[31m-    "v2M" :"https://a.co.jp",[m
[31m-    "v2AC" :"https://a.co.jp",[m
[31m-    "v5C" :"https://a.co.jp",[m
[31m-    "c2AS" :"https://a.co.jp",[m
[31m-    "v4C" :"https://a.co.jp",[m
[31m-    "v3D" :"https://a.co.jp",[m
[31m-    "c4J" :"https://a.co.jp",[m
[31m-    "spc" :"https://a.co.jp",[m
[31m-    "fb" :"https://a.co.jp",[m
[31m-    "fs" :"https://a.co.jp",[m
[31m-    "hl" :"https://a.co.jp",[m
[31m-    "sw" :"https://a.co.jp",[m
[31m-    "yku" :"https://a.co.jp",[m
[31m-    "bd" :"https://a.co.jp",[m
[31m-    "hb" :"https://a.co.jp",[m
[31m-    "cm" :"https://a.co.jp",[m
[31m-    "htb" :"https://a.co.jp",[m
[31m-    "vb" :"https://a.co.jp",[m
[31m-    "bsk" :"https://a.co.jp",[m
[31m-    "tnf" :"https://a.co.jp",[m
[31m-    "cyc" :"https://a.co.jp",[m
[31m-    "v5M" :"https://a.co.jp",[m
[31m-    "c14" :"https://a.co.jp",[m
[31m-    "vM" :"https://a.co.jp",[m
[31m-    "c13" :"https://a.co.jp",[m
[31m-    "v14" :"https://a.co.jp",[m
[31m-    "c4D" :"https://a.co.jp",[m
[31m-    "v4D" :"https://a.co.jp",[m
[31m-    "kusa" :"https://a.co.jp",[m
[31m-    "pg" :"https://a.co.jp",[m
[31m-    "gcat" :"https://a.co.jp",[m
[31m-    "tea" :"https://a.co.jp"[m
[32m+[m[32m{[m[41m[m
[32m+[m[32m    "c2D" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "c2C" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "c4M" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "c4E" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "c4C" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "abd" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v5D" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v5E" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v2M" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v2AC" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v5C" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "c2AS" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v4C" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v3D" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "c4J" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "spc" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "fb" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "fs" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "hl" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "sw" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "yku" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "bd" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "hb" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "cm" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "htb" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "vb" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "bsk" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "tnf" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "cyc" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v5M" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "c14" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "vM" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "c13" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v14" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "c4D" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "v4D" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "kusa" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "pg" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "gcat" :"https://a.co.jp",[m[41m[m
[32m+[m[32m    "tea" :"https://a.co.jp"[m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/bot/bot.js b/bot/bot.js[m
[1mindex 44ff1f8..ee06f30 100644[m
[1m--- a/bot/bot.js[m
[1m+++ b/bot/bot.js[m
[36m@@ -1,283 +1,283 @@[m
[31m-const dotenv=require("dotenv").config();[m
[31m-const fs = require("fs");[m
[31m-const puppeteer = require("puppeteer");[m
[31m-const request = require("request");[m
[31m-const jsdom=require("jsdom");[m
[31m-const {RTMClient}=require("@slack/client");[m
[31m-const rtm=new RTMClient(process.env.SLACK_TOKEN);[m
[31m-const utils= require("./utils.js");[m
[31m-//load json[m
[31m-const account= require("./private/id2mogiid.json");[m
[31m-const shop= require("./public/shop.json");[m
[31m-[m
[31m-//load env[m
[31m-const SLACK_TOKEN=process.env.SLACK_TOKEN;[m
[31m-const DEV_SERVER=process.env.DEV_SERVER;[m
[31m-[m
[31m-var slack_id;[m
[31m-var shop_name,shop_id;[m
[31m-var timetable_data;[m
[31m-var events;[m
[31m-var timetable;[m
[31m-var arr;[m
[31m-var list;[m
[31m-var photos=[];[m
[31m-[m
[31m-function create_json(){[m
[31m-    var events_data,tag_data;[m
[31m-	try {[m
[31m-		const tag=JSON.parse(fs.readFileSync("./private/tag.json"));[m
[31m-	}catch(e){[m
[31m-		console.log(e);[m
[31m-	}[m
[31m-    try {[m
[31m-        events_data = fs.readFileSync("./public/events.json");[m
[31m-        events = JSON.parse(events_data);[m
[31m-    }catch(e){[m
[31m-        events = [{[m
[31m-            "id":"id",[m
[31m-            "date":"date",[m
[31m-            "time":"time",[m
[31m-            "start_time":"start_time",[m
[31m-            "end_time":"end_time",[m
[31m-            "place":"place",[m
[31m-            "name":"name",[m
[31m-            "content":"content",[m
[31m-            "from":"from",[m
[31m-            "tstamp":"tstamp"[m
[31m-        }];[m
[31m-        fs.writeFileSync('./public/events.json',JSON.stringify(events));		[m
[31m-    }[m
[31m-}[m
[31m-[m
[31m-function backup(name,data){[m
[31m-    utils.log("name : ```"+data+"```");[m
[31m-    fs.writeFileSync("./public/"+name+".json",JSON.stringify(data));[m
[31m-}[m
[31m-[m
[31m-function save_shop_image(event,shop_id){[m
[31m-    utils.log(event.files[0].url_private_download);[m
[31m-    var count = 0;[m
[31m-    file=utils.download(shop_name,event.files[0].title,event.files[0].url_private_download);[m
[31m-    console.log(shop);[m
[31m-    console.log(shop_id);[m
[31m-    console.log(shop[shop_id]);[m
[31m-    shop[shop_id].image.push(event.files[0].title);[m
[31m-}[m
[31m-[m
[31m-function slack(data,channel){[m
[31m-    utils.log(data);[m
[31m-    request.post("https://slack.com/api/chat.postMessage",{[m
[31m-        form: {[m
[31m-            token: process.env.SLACK_TOKEN,[m
[31m-            channel: channel,[m
[31m-            username: "mogi-bot",[m
[31m-            text: data[m
[31m-        }[m
[31m-    },(error, response, body) => {[m
[31m-        if (error) console.log(error);[m
[31m-    });[m
[31m-}[m
[31m-[m
[31m-const screen = (async(channel,file,shop_id)=>{[m
[31m-    const browser = await puppeteer.launch({args: ['--no-sandbox', '--disable-setuid-sandbox']});[m
[31m-    const page = await browser.newPage();[m
[31m-    await page.goto(DEV_SERVER,{waitUntil: "domcontentloaded"});[m
[31m-    await page.screenshot({path: file+".png", fullPage: true});[m
[31m-    browser.close();[m
[31m-    utils.log(file);[m
[31m-    utils.sendFile(channel,file+".png");[m
[31m-    return;[m
[31m-});[m
[31m-[m
[31m-function tag_message(tag,channel){[m
[31m-    var arr = [];[m
[31m-    var text;[m
[31m-    var mes;[m
[31m-    for(var i in tag){[m
[31m-        text = tag[i].id+":"+tag[i].tag;[m
[31m-        arr.push(text);[m
[31m-    }[m
[31m-    mes = arr.join(' , ');[m
[31m-    slack(mes,channel);[m
[31m-}[m
[31m-[m
[31m-function get_mogiid(event){[m
[31m-    console.log(event.channel);[m
[31m-    try{[m
[31m-        return [account[event.channel]["id"],account[event.channel]["name"]];[m
[31m-    }catch(e){[m
[31m-        console.log('not mogi',event.channel);[m
[31m-        return undefined;[m
[31m-    }[m
[31m-}[m
[31m-[m
[31m-function admin(event){[m
[31m-	if(event.text.split(' ')[0]===".message"){[m
[31m-		slack("get admin message");[m
[31m-		request.post([m
[31m-			{[m
[31m-				url:'https://kunugida2018.tokyo-ct.ac.jp/api/beacon/update',[m
[31m-				form:{[m
[31m-					"place":[A,B,C,D,E,F,tailkukan,hazama,seimon,joho.All],[m
[31m-					"message":event.text.split(' ')[1][m
[31m-				}[m
[31m-			},[m
[31m-			(err,res,body)=>{[m
[31m-				if(err)utils.log(err);[m
[31m-				utils.log(res);[m
[31m-			});[m
[31m-	}[m
[31m-}[m
[31m-[m
[31m-rtm.on("hello",(event)=>{[m
[31m-    utils.log("hello slack");[m
[31m-    console.log("start slack process");[m
[31m-});[m
[31m-[m
[31m-rtm.on("message",(event)=>{[m
[31m-    var channel = event.channel;[m
[31m-    if(event.text){event.text = event.text.replace('　',' ');}[m
[31m-    var ts = event.ts;[m
[31m-    var shopd=get_mogiid(event);[m
[31m-	if(event.channel=="GCS4TEWGZ"){[m
[31m-//		admin(event);[m
[31m-		return;[m
[31m-	}else if(event.channel=="CD0KZSRQ9"){[m
[31m-		if(event.files){[m
[31m-			photos.push(utils.download("photo_club",event.files[0].title,event.files[0].url_private_download));[m
[31m-			slack(JSON.stringify(photos),event.channel);[m
[31m-		}[m
[31m-		return;[m
[31m-	}else if(shopd){[m
[31m-        shop_id=shopd[0];[m
[31m-        shop_name=shopd[1];[m
[31m-        if(!shop[shop_id]) shop[shop_id]={"goods":[],"image":[],"label":[]};[m
[31m-        console.log(shop_id,shop_name);[m
[31m-    }else{[m
[31m-        return;[m
[31m-    }[m
[31m-    slack_id = event.user;[m
[31m-    if(event.text.split(" ")[0]===".help"){[m
[31m-        slack("\`\`\`"+shop_name+"\`\`\`",event.channel);[m
[31m-        utils.help(event);[m
[31m-    }else if(event.text.split(" ")[0]===".text"){[m
[31m-        shop[shop_id].text = event.text.slice(6);[m
[31m-        shop[shop_id].tstamp = ts;[m
[31m-        slack("テキストが登録されました.",channel);[m
[31m-    }else if(text.split(' ')[0]==='.goods'){[m
[31m-        if(text.split(' ').length != 3){[m
[31m-            slack('商品名または値段の入力方法に誤りがあります.\ne.g.\n.goods <goods name> <price>',channel);[m
[31m-            return ;[m
[31m-        }[m
[31m-        var cnt;[m
[31m-        var Name = text.split(' ')[1];[m
[31m-        var Price = text.split(' ')[2];[m
[31m-        console.log(shop);[m
[31m-        console.log(shop[shop_id].goods[0]);[m
[31m-        for(cnt=0;cnt<shop[shop_id].goods.length;cnt++){[m
[31m-            if(shop[shop_id].goods[cnt]["name"] == Name){[m
[31m-                shop[shop_id].goods[cnt]["price"] = Price;[m
[31m-                slack("値段が更新されました.",channel);[m
[31m-                shop[shop_id].tstamp = ts;[m
[31m-                return ;[m
[31m-            }[m
[31m-        }[m
[31m-        var data = {"name":Name,"price":Price};[m
[31m-        shop[shop_id].goods.push(data);[m
[31m-        shop[shop_id].tstamp = ts;[m
[31m-        if(shop[shop_id].goods[0].name==='name') shop[shop_id].goods.shift();[m
[31m-        slack("商品が登録されました.\nタグの登録を行ってください.",channel);[m
[31m-        tag_message(tag,channel);[m
[31m-    }else if(text.split(' ')[0]==='.rewiew'){[m
[31m-        screen('./public/'+shop_id+shop_id,shop_id);[m
[31m-    }else if(text.split(' ')[0]==='.show'){[m
[31m-        slack("```"+[m
[31m-            "name : "+shop_name+"\n"+[m
[31m-            "goods : "+JSON.stringify(shop[shop_id]["goods"])+"\n"+[m
[31m-            "image : "+JSON.stringify(shop[shop_id]["image"])+"\n"+[m
[31m-            "label : "+shop[shop_id]["label"]+"\n"+[m
[31m-            "text : "+shop[shop_id]["text"]+"\n"+[m
[31m-            "```",event.channel);[m
[31m-    }else if(text.split(' ')[0]==='.event'){[m
[31m-        try{[m
[31m-            if(text.split(' ').length != 8){[m
[31m-                slack('registed data is invarid.\n'+[m
[31m-                    'e.g.\n'+[m
[31m-                    '.event <date> <start_time> <end_time> <place> <name> <content> <from>\n'+[m
[31m-                    'ex.\n'+[m
[31m-                    '.event 22 18:00 19:00 第一体育館 後夜祭 演出部門によるプロジェクションマッピング 演出部門',[m
[31m-                        channel);[m
[31m-                return ;[m
[31m-            }[m
[31m-            var date = text.split(' ')[1];[m
[31m-            var start_time = text.split(' ')[2];[m
[31m-            var end_time = text.split(' ')[3];[m
[31m-            var place = text.split(' ')[4];[m
[31m-            var name = text.split(' ')[5];[m
[31m-            var content = text.split(' ')[6];[m
[31m-            var from = text.split(' ')[7];[m
[31m-            var time = '2018/10/'+date+'/'+start_time+':00';[m
[31m-            events[events.length-1] = {"id":events.length-1,"date":date,"time":time,"start_time":start_time,"end_time":end_time,"place":place,"name":name,"content":content,"from":from,"tstamp":ts};[m
[31m-            events = utils.json_sort(events);[m
[31m-            slack("イベントが登録されました.",channel);			[m
[31m-        }catch(e){[m
[31m-            slack("想定外のエラーが発生しました",channel);[m
[31m-        }[m
[31m-    }else if(text.split(' ')[0]==='.show_event'){[m
[31m-        var events_text = JSON.stringify(events,null,'\t')[m
[31m-        slack(events_text,channel);[m
[31m-    }else if(text.split(' ')[0]==='.tag'){[m
[31m-        var tags = text.split(' ');[m
[31m-        console.log("tags",tags);[m
[31m-        tags.shift();[m
[31m-        console.log("tags",tags);[m
[31m-        var cnt=0;[m
[31m-        console.log(shop);[m
[31m-        for(var key in shop[shop_id].label) cnt++;[m
[31m-        console.log("cnt",cnt);[m
[31m-        console.log("tag",tag);[m
[31m-        for(let i in tags){[m
[31m-            for(let j in tag){[m
[31m-                if((tags[i]==tag[j].id)&&(shop[shop_id].label.indexOf(tag[j].tag)==-1)){[m
[31m-                    console.log("tag",tag[j].tag);[m
[31m-                    shop[shop_id].label[cnt] = tag[j].id;[m
[31m-                    console.log("list",shop[shop_id].label[cnt]);[m
[31m-                    shop[shop_id].tstamp = ts;[m
[31m-                    cnt++;[m
[31m-                }[m
[31m-            }[m
[31m-        }[m
[31m-        console.log(shop);[m
[31m-        shop[shop_id].tstamp = ts;[m
[31m-        if(shop[shop_id].label[0]==='label') shop[shop_id].label.shift();[m
[31m-        slack("タグが登録されました.",channel);[m
[31m-    }else if(text.split(' ')[0]==='.tag_help'){[m
[31m-        //		slack("0:食べ物, 1:飲み物, 2:アトラクション, 3:温かいもの, 4:冷たいもの, 5:甘い, 6:しょっぱい",channel);[m
[31m-        tag_message(tag,channel);[m
[31m-    }else if(text.split(' ')[0]==='.tag_save'){[m
[31m-        try{[m
[31m-            var tags = {"id":tag.length,"tag":text.split(' ')[1]};[m
[31m-            tag.push(tags);[m
[31m-        }catch(e){[m
[31m-            console.log(e);[m
[31m-        }[m
[31m-    }[m
[31m-    if(event.files !== undefined){[m
[31m-        save_shop_image(event,shop_id);[m
[31m-    }[m
[31m-    backup("shop",shop);[m
[31m-    backup("tag",tag);[m
[31m-    backup("events",events);[m
[31m-});[m
[31m-[m
[31m-if(require.main ===module){[m
[31m-    if(SLACK_TOKEN === undefined){[m
[31m-        console.log("slack token is not defined");[m
[31m-    }[m
[31m-    console.log(account);[m
[31m-    utils.log("start process");[m
[31m-    create_json();[m
[31m-    list = utils.read_list();[m
[31m-    rtm.start();[m
[31m-}[m
[32m+[m[32mconst dotenv=require("dotenv").config();[m[41m[m
[32m+[m[32mconst fs = require("fs");[m[41m[m
[32m+[m[32mconst puppeteer = require("puppeteer");[m[41m[m
[32m+[m[32mconst request = require("request");[m[41m[m
[32m+[m[32mconst jsdom=require("jsdom");[m[41m[m
[32m+[m[32mconst {RTMClient}=require("@slack/client");[m[41m[m
[32m+[m[32mconst rtm=new RTMClient(process.env.SLACK_TOKEN);[m[41m[m
[32m+[m[32mconst utils= require("./utils.js");[m[41m[m
[32m+[m[32m//load json[m[41m[m
[32m+[m[32mconst account= require("./private/id2mogiid.json");[m[41m[m
[32m+[m[32mconst shop= require("./public/shop.json");[m[41m[m
[32m+[m[41m[m
[32m+[m[32m//load env[m[41m[m
[32m+[m[32mconst SLACK_TOKEN=process.env.SLACK_TOKEN;[m[41m[m
[32m+[m[32mconst DEV_SERVER=process.env.DEV_SERVER;[m[41m[m
[32m+[m[41m[m
[32m+[m[32mvar slack_id;[m[41m[m
[32m+[m[32mvar shop_name,shop_id;[m[41m[m
[32m+[m[32mvar timetable_data;[m[41m[m
[32m+[m[32mvar events;[m[41m[m
[32m+[m[32mvar timetable;[m[41m[m
[32m+[m[32mvar arr;[m[41m[m
[32m+[m[32mvar list;[m[41m[m
[32m+[m[32mvar photos=[];[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction create_json(){[m[41m[m
[32m+[m[32m    var events_data,tag_data;[m[41m[m
[32m+[m	[32mtry {[m[41m[m
[32m+[m		[32mconst tag=JSON.parse(fs.readFileSync("./private/tag.json"));[m[41m[m
[32m+[m	[32m}catch(e){[m[41m[m
[32m+[m		[32mconsole.log(e);[m[41m[m
[32m+[m	[32m}[m[41m[m
[32m+[m[32m    try {[m[41m[m
[32m+[m[32m        events_data = fs.readFileSync("./public/events.json");[m[41m[m
[32m+[m[32m        events = JSON.parse(events_data);[m[41m[m
[32m+[m[32m    }catch(e){[m[41m[m
[32m+[m[32m        events = [{[m[41m[m
[32m+[m[32m            "id":"id",[m[41m[m
[32m+[m[32m            "date":"date",[m[41m[m
[32m+[m[32m            "time":"time",[m[41m[m
[32m+[m[32m            "start_time":"start_time",[m[41m[m
[32m+[m[32m            "end_time":"end_time",[m[41m[m
[32m+[m[32m            "place":"place",[m[41m[m
[32m+[m[32m            "name":"name",[m[41m[m
[32m+[m[32m            "content":"content",[m[41m[m
[32m+[m[32m            "from":"from",[m[41m[m
[32m+[m[32m            "tstamp":"tstamp"[m[41m[m
[32m+[m[32m        }];[m[41m[m
[32m+[m[32m        fs.writeFileSync('./public/events.json',JSON.stringify(events));[m[41m		[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction backup(name,data){[m[41m[m
[32m+[m[32m    utils.log("name : ```"+data+"```");[m[41m[m
[32m+[m[32m    fs.writeFileSync("./public/"+name+".json",JSON.stringify(data));[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction save_shop_image(event,shop_id){[m[41m[m
[32m+[m[32m    utils.log(event.files[0].url_private_download);[m[41m[m
[32m+[m[32m    var count = 0;[m[41m[m
[32m+[m[32m    file=utils.download(shop_name,event.files[0].title,event.files[0].url_private_download);[m[41m[m
[32m+[m[32m    console.log(shop);[m[41m[m
[32m+[m[32m    console.log(shop_id);[m[41m[m
[32m+[m[32m    console.log(shop[shop_id]);[m[41m[m
[32m+[m[32m    shop[shop_id].image.push(event.files[0].title);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction slack(data,channel){[m[41m[m
[32m+[m[32m    utils.log(data);[m[41m[m
[32m+[m[32m    request.post("https://slack.com/api/chat.postMessage",{[m[41m[m
[32m+[m[32m        form: {[m[41m[m
[32m+[m[32m            token: process.env.SLACK_TOKEN,[m[41m[m
[32m+[m[32m            channel: channel,[m[41m[m
[32m+[m[32m            username: "mogi-bot",[m[41m[m
[32m+[m[32m            text: data[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    },(error, response, body) => {[m[41m[m
[32m+[m[32m        if (error) console.log(error);[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mconst screen = (async(channel,file,shop_id)=>{[m[41m[m
[32m+[m[32m    const browser = await puppeteer.launch({args: ['--no-sandbox', '--disable-setuid-sandbox']});[m[41m[m
[32m+[m[32m    const page = await browser.newPage();[m[41m[m
[32m+[m[32m    await page.goto(DEV_SERVER,{waitUntil: "domcontentloaded"});[m[41m[m
[32m+[m[32m    await page.screenshot({path: file+".png", fullPage: true});[m[41m[m
[32m+[m[32m    browser.close();[m[41m[m
[32m+[m[32m    utils.log(file);[m[41m[m
[32m+[m[32m    utils.sendFile(channel,file+".png");[m[41m[m
[32m+[m[32m    return;[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction tag_message(tag,channel){[m[41m[m
[32m+[m[32m    var arr = [];[m[41m[m
[32m+[m[32m    var text;[m[41m[m
[32m+[m[32m    var mes;[m[41m[m
[32m+[m[32m    for(var i in tag){[m[41m[m
[32m+[m[32m        text = tag[i].id+":"+tag[i].tag;[m[41m[m
[32m+[m[32m        arr.push(text);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    mes = arr.join(' , ');[m[41m[m
[32m+[m[32m    slack(mes,channel);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction get_mogiid(event){[m[41m[m
[32m+[m[32m    console.log(event.channel);[m[41m[m
[32m+[m[32m    try{[m[41m[m
[32m+[m[32m        return [account[event.channel]["id"],account[event.channel]["name"]];[m[41m[m
[32m+[m[32m    }catch(e){[m[41m[m
[32m+[m[32m        console.log('not mogi',event.channel);[m[41m[m
[32m+[m[32m        return undefined;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction admin(event){[m[41m[m
[32m+[m	[32mif(event.text.split(' ')[0]===".message"){[m[41m[m
[32m+[m		[32mslack("get admin message");[m[41m[m
[32m+[m		[32mrequest.post([m[41m[m
[32m+[m			[32m{[m[41m[m
[32m+[m				[32murl:'https://kunugida2018.tokyo-ct.ac.jp/api/beacon/update',[m[41m[m
[32m+[m				[32mform:{[m[41m[m
[32m+[m					[32m"place":[A,B,C,D,E,F,tailkukan,hazama,seimon,joho.All],[m[41m[m
[32m+[m					[32m"message":event.text.split(' ')[1][m[41m[m
[32m+[m				[32m}[m[41m[m
[32m+[m			[32m},[m[41m[m
[32m+[m			[32m(err,res,body)=>{[m[41m[m
[32m+[m				[32mif(err)utils.log(err);[m[41m[m
[32m+[m				[32mutils.log(res);[m[41m[m
[32m+[m			[32m});[m[41m[m
[32m+[m	[32m}[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mrtm.on("hello",(event)=>{[m[41m[m
[32m+[m[32m    utils.log("hello slack");[m[41m[m
[32m+[m[32m    console.log("start slack process");[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mrtm.on("message",(event)=>{[m[41m[m
[32m+[m[32m    var channel = event.channel;[m[41m[m
[32m+[m[32m    if(event.text){event.text = event.text.replace('　',' ');}[m[41m[m
[32m+[m[32m    var ts = event.ts;[m[41m[m
[32m+[m[32m    var shopd=get_mogiid(event);[m[41m[m
[32m+[m	[32mif(event.channel=="GCS4TEWGZ"){[m[41m[m
[32m+[m[32m//		admin(event);[m[41m[m
[32m+[m		[32mreturn;[m[41m[m
[32m+[m	[32m}else if(event.channel=="CD0KZSRQ9"){[m[41m[m
[32m+[m		[32mif(event.files){[m[41m[m
[32m+[m			[32mphotos.push(utils.download("photo_club",event.files[0].title,event.files[0].url_private_download));[m[41m[m
[32m+[m			[32mslack(JSON.stringify(photos),event.channel);[m[41m[m
[32m+[m		[32m}[m[41m[m
[32m+[m		[32mreturn;[m[41m[m
[32m+[m	[32m}else if(shopd){[m[41m[m
[32m+[m[32m        shop_id=shopd[0];[m[41m[m
[32m+[m[32m        shop_name=shopd[1];[m[41m[m
[32m+[m[32m        if(!shop[shop_id]) shop[shop_id]={"goods":[],"image":[],"label":[]};[m[41m[m
[32m+[m[32m        console.log(shop_id,shop_name);[m[41m[m
[32m+[m[32m    }else{[m[41m[m
[32m+[m[32m        return;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    slack_id = event.user;[m[41m[m
[32m+[m[32m    if(event.text.split(" ")[0]===".help"){[m[41m[m
[32m+[m[32m        slack("\`\`\`"+shop_name+"\`\`\`",event.channel);[m[41m[m
[32m+[m[32m        utils.help(event);[m[41m[m
[32m+[m[32m    }else if(event.text.split(" ")[0]===".text"){[m[41m[m
[32m+[m[32m        shop[shop_id].text = event.text.slice(6);[m[41m[m
[32m+[m[32m        shop[shop_id].tstamp = ts;[m[41m[m
[32m+[m[32m        slack("テキストが登録されました.",channel);[m[41m[m
[32m+[m[32m    }else if(text.split(' ')[0]==='.goods'){[m[41m[m
[32m+[m[32m        if(text.split(' ').length != 3){[m[41m[m
[32m+[m[32m            slack('商品名または値段の入力方法に誤りがあります.\ne.g.\n.goods <goods name> <price>',channel);[m[41m[m
[32m+[m[32m            return ;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        var cnt;[m[41m[m
[32m+[m[32m        var Name = text.split(' ')[1];[m[41m[m
[32m+[m[32m        var Price = text.split(' ')[2];[m[41m[m
[32m+[m[32m        console.log(shop);[m[41m[m
[32m+[m[32m        console.log(shop[shop_id].goods[0]);[m[41m[m
[32m+[m[32m        for(cnt=0;cnt<shop[shop_id].goods.length;cnt++){[m[41m[m
[32m+[m[32m            if(shop[shop_id].goods[cnt]["name"] == Name){[m[41m[m
[32m+[m[32m                shop[shop_id].goods[cnt]["price"] = Price;[m[41m[m
[32m+[m[32m                slack("値段が更新されました.",channel);[m[41m[m
[32m+[m[32m                shop[shop_id].tstamp = ts;[m[41m[m
[32m+[m[32m                return ;[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        var data = {"name":Name,"price":Price};[m[41m[m
[32m+[m[32m        shop[shop_id].goods.push(data);[m[41m[m
[32m+[m[32m        shop[shop_id].tstamp = ts;[m[41m[m
[32m+[m[32m        if(shop[shop_id].goods[0].name==='name') shop[shop_id].goods.shift();[m[41m[m
[32m+[m[32m        slack("商品が登録されました.\nタグの登録を行ってください.",channel);[m[41m[m
[32m+[m[32m        tag_message(tag,channel);[m[41m[m
[32m+[m[32m    }else if(text.split(' ')[0]==='.rewiew'){[m[41m[m
[32m+[m[32m        screen('./public/'+shop_id+shop_id,shop_id);[m[41m[m
[32m+[m[32m    }else if(text.split(' ')[0]==='.show'){[m[41m[m
[32m+[m[32m        slack("```"+[m[41m[m
[32m+[m[32m            "name : "+shop_name+"\n"+[m[41m[m
[32m+[m[32m            "goods : "+JSON.stringify(shop[shop_id]["goods"])+"\n"+[m[41m[m
[32m+[m[32m            "image : "+JSON.stringify(shop[shop_id]["image"])+"\n"+[m[41m[m
[32m+[m[32m            "label : "+shop[shop_id]["label"]+"\n"+[m[41m[m
[32m+[m[32m            "text : "+shop[shop_id]["text"]+"\n"+[m[41m[m
[32m+[m[32m            "```",event.channel);[m[41m[m
[32m+[m[32m    }else if(text.split(' ')[0]==='.event'){[m[41m[m
[32m+[m[32m        try{[m[41m[m
[32m+[m[32m            if(text.split(' ').length != 8){[m[41m[m
[32m+[m[32m                slack('registed data is invarid.\n'+[m[41m[m
[32m+[m[32m                    'e.g.\n'+[m[41m[m
[32m+[m[32m                    '.event <date> <start_time> <end_time> <place> <name> <content> <from>\n'+[m[41m[m
[32m+[m[32m                    'ex.\n'+[m[41m[m
[32m+[m[32m                    '.event 22 18:00 19:00 第一体育館 後夜祭 演出部門によるプロジェクションマッピング 演出部門',[m[41m[m
[32m+[m[32m                        channel);[m[41m[m
[32m+[m[32m                return ;[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m            var date = text.split(' ')[1];[m[41m[m
[32m+[m[32m            var start_time = text.split(' ')[2];[m[41m[m
[32m+[m[32m            var end_time = text.split(' ')[3];[m[41m[m
[32m+[m[32m            var place = text.split(' ')[4];[m[41m[m
[32m+[m[32m            var name = text.split(' ')[5];[m[41m[m
[32m+[m[32m            var content = text.split(' ')[6];[m[41m[m
[32m+[m[32m            var from = text.split(' ')[7];[m[41m[m
[32m+[m[32m            var time = '2018/10/'+date+'/'+start_time+':00';[m[41m[m
[32m+[m[32m            events[events.length-1] = {"id":events.length-1,"date":date,"time":time,"start_time":start_time,"end_time":end_time,"place":place,"name":name,"content":content,"from":from,"tstamp":ts};[m[41m[m
[32m+[m[32m            events = utils.json_sort(events);[m[41m[m
[32m+[m[32m            slack("イベントが登録されました.",channel);[m[41m			[m
[32m+[m[32m        }catch(e){[m[41m[m
[32m+[m[32m            slack("想定外のエラーが発生しました",channel);[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    }else if(text.split(' ')[0]==='.show_event'){[m[41m[m
[32m+[m[32m        var events_text = JSON.stringify(events,null,'\t')[m[41m[m
[32m+[m[32m        slack(events_text,channel);[m[41m[m
[32m+[m[32m    }else if(text.split(' ')[0]==='.tag'){[m[41m[m
[32m+[m[32m        var tags = text.split(' ');[m[41m[m
[32m+[m[32m        console.log("tags",tags);[m[41m[m
[32m+[m[32m        tags.shift();[m[41m[m
[32m+[m[32m        console.log("tags",tags);[m[41m[m
[32m+[m[32m        var cnt=0;[m[41m[m
[32m+[m[32m        console.log(shop);[m[41m[m
[32m+[m[32m        for(var key in shop[shop_id].label) cnt++;[m[41m[m
[32m+[m[32m        console.log("cnt",cnt);[m[41m[m
[32m+[m[32m        console.log("tag",tag);[m[41m[m
[32m+[m[32m        for(let i in tags){[m[41m[m
[32m+[m[32m            for(let j in tag){[m[41m[m
[32m+[m[32m                if((tags[i]==tag[j].id)&&(shop[shop_id].label.indexOf(tag[j].tag)==-1)){[m[41m[m
[32m+[m[32m                    console.log("tag",tag[j].tag);[m[41m[m
[32m+[m[32m                    shop[shop_id].label[cnt] = tag[j].id;[m[41m[m
[32m+[m[32m                    console.log("list",shop[shop_id].label[cnt]);[m[41m[m
[32m+[m[32m                    shop[shop_id].tstamp = ts;[m[41m[m
[32m+[m[32m                    cnt++;[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        console.log(shop);[m[41m[m
[32m+[m[32m        shop[shop_id].tstamp = ts;[m[41m[m
[32m+[m[32m        if(shop[shop_id].label[0]==='label') shop[shop_id].label.shift();[m[41m[m
[32m+[m[32m        slack("タグが登録されました.",channel);[m[41m[m
[32m+[m[32m    }else if(text.split(' ')[0]==='.tag_help'){[m[41m[m
[32m+[m[32m        //		slack("0:食べ物, 1:飲み物, 2:アトラクション, 3:温かいもの, 4:冷たいもの, 5:甘い, 6:しょっぱい",channel);[m[41m[m
[32m+[m[32m        tag_message(tag,channel);[m[41m[m
[32m+[m[32m    }else if(text.split(' ')[0]==='.tag_save'){[m[41m[m
[32m+[m[32m        try{[m[41m[m
[32m+[m[32m            var tags = {"id":tag.length,"tag":text.split(' ')[1]};[m[41m[m
[32m+[m[32m            tag.push(tags);[m[41m[m
[32m+[m[32m        }catch(e){[m[41m[m
[32m+[m[32m            console.log(e);[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    if(event.files !== undefined){[m[41m[m
[32m+[m[32m        save_shop_image(event,shop_id);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    backup("shop",shop);[m[41m[m
[32m+[m[32m    backup("tag",tag);[m[41m[m
[32m+[m[32m    backup("events",events);[m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mif(require.main ===module){[m[41m[m
[32m+[m[32m    if(SLACK_TOKEN === undefined){[m[41m[m
[32m+[m[32m        console.log("slack token is not defined");[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    console.log(account);[m[41m[m
[32m+[m[32m    utils.log("start process");[m[41m[m
[32m+[m[32m    create_json();[m[41m[m
[32m+[m[32m    list = utils.read_list();[m[41m[m
[32m+[m[32m    rtm.start();[m[41m[m
[32m+[m[32m}[m[41m[m
[1mdiff --git a/bot/utils.js b/bot/utils.js[m
[1mindex 944ec54..76b233c 100644[m
[1m--- a/bot/utils.js[m
[1m+++ b/bot/utils.js[m
[36m@@ -1,220 +1,220 @@[m
[31m-const ejs=require('ejs');[m
[31m-const dotenv=require('dotenv').config();[m
[31m-const fs=require('fs');[m
[31m-const mkdirp = require("mkdirp");[m
[31m-const path=require('path');[m
[31m-const request = require("request");[m
[31m-const logger=require('pino')();[m
[31m-const winston=require('winston');[m
[31m-const SLACK_TOKEN=process.env.SLACK_TOKEN;[m
[31m-const BOT_USERNAME='mogi-shop';[m
[31m-[m
[31m-const winstonlogger=winston.createLogger({[m
[31m-	transports:[[m
[31m-		new winston.transports.Console(),[m
[31m-		new winston.transports.File({filename:'logs/info.log',level:'error'}),[m
[31m-		new winston.transports.File({filename:'logs/combined.log'})[m
[31m-	][m
[31m-});[m
[31m-[m
[31m-function read_list(){[m
[31m-	try{[m
[31m-		arr = fs.readFileSync('./data/list.txt').toString().split('\r\n');[m
[31m-	}catch(e){[m
[31m-		console.log("can not read list.txt");[m
[31m-	}[m
[31m-	return arr;[m
[31m-}[m
[31m-[m
[31m-function id_exist(shopid){[m
[31m-	var shop_list=read_list();[m
[31m-	console.log(shop_list);[m
[31m-[m
[31m-}[m
[31m-[m
[31m-function json_sort(arr){[m
[31m-	arr.sort(function(a,b) {[m
[31m- 		return (a.time > b.time ? 1 : 1);[m
[31m-	});[m
[31m-	for(i = 0 ; i < arr.length ; i++ ){[m
[31m-　  	arr[i].id = i;[m
[31m-	}[m
[31m-	return arr;[m
[31m-}[m
[31m-[m
[31m-function to_Array(shop){[m
[31m-	var Ashop = [];[m
[31m-	var cnt=0;[m
[31m-	for(key in shop){[m
[31m-		Ashop.push(shop[key]);[m
[31m-		Ashop[cnt].id = key;[m
[31m-		cnt++;[m
[31m-	}[m
[31m-	console.log("Ashop",Ashop);[m
[31m-	fs.writeFileSync('./data/Ashop.json',JSON.stringify(Ashop));[m
[31m-}[m
[31m-[m
[31m-function slack_log(message){[m
[31m-	winstonlogger.info(message);[m
[31m-	slack_postMessage("GCSFWFUE8",message);[m
[31m-}[m
[31m-[m
[31m-function slack_err(message){[m
[31m-	winstonlogger.error(message);[m
[31m-	slack_postMessage("#errors",message);[m
[31m-	slack_postMessage("#errors",message);[m
[31m-}[m
[31m-[m
[31m-function slack_responce(message,event){[m
[31m-    if(event.username === BOT_USERNAME){[m
[31m-        return;[m
[31m-    }[m
[31m-    console.log(message);[m
[31m-	request.post('https://slack.com/api/chat.postMessage',{[m
[31m-		form: {[m
[31m-			token: SLACK_TOKEN,[m
[31m-			channel: event.channel,[m
[31m-			username: 'mogi-bot',[m
[31m-			text: message[m
[31m-		}[m
[31m-	},(error, response, body) => {[m
[31m-		if (error) slack_err(error);[m
[31m-	});[m
[31m-}[m
[31m-function slack_upload(channel,image){[m
[31m-	console.log(channel,image,SLACK_TOKEN)[m
[31m-	var arg={[m
[31m-		url:'https://slack.com/api/files.upload',[m
[31m-		headers:{[m
[31m-			"Content-Type":"multipart/form-data;"[m
[31m-		},[m
[31m-		formData:{[m
[31m-			token: SLACK_TOKEN,[m
[31m-			channels:channel,[m
[31m-			username:'mogi-bot',[m
[31m-			title:"Image",[m
[31m-			filename:image,[m
[31m-			file:fs.createReadStream(image),[m
[31m-		}[m
[31m-	};[m
[31m-	console.log(arg)[m
[31m-	request.post(arg,(error, response, body) => {[m
[31m-		console.log(body);[m
[31m-	});[m
[31m-};[m
[31m-[m
[31m-function download(dir,title,url){[m
[31m-	var dir='./public/'+dir;[m
[31m-	var fname=dir+'/'+title;[m
[31m-	mkdirp(dir,(err)=>{slack_log(err);});[m
[31m-	request({[m
[31m-		url:url,[m
[31m-		headers:{'Authorization': 'Bearer '+SLACK_TOKEN}[m
[31m-	}).pipe(fs.createWriteStream(fname));[m
[31m-	console.log("download file successed",dir,fname,url);[m
[31m-	return fname;[m
[31m-}[m
[31m-[m
[31m-const HELP_MESSAGE="booth\n\[m
[31m-```\[m
[31m-.help\n\[m
[31m-.goods <goods name> <price>\n\[m
[31m-.tag <number>\n\[m
[31m-.review\n\[m
[31m-.show\n\[m
[31m-```\n\[m
[31m-event\n\[m
[31m-```\[m
[31m-.event <date> <start_time> <end_time> <place> <name> <content> <from>\n\[m
[31m-.show_event\[m
[31m-```";[m
[31m-[m
[31m-function help(event){[m
[31m-	slack_responce(HELP_MESSAGE,event);[m
[31m-}[m
[31m-[m
[31m-function slack_postMessage(channel,message){[m
[31m-	res=request.post('https://slack.com/api/chat.postMessage',{[m
[31m-		form: {[m
[31m-			token: SLACK_TOKEN,[m
[31m-			channel: channel,[m
[31m-			username: 'mogi-bot',[m
[31m-			text:message [m
[31m-		}[m
[31m-	},(error, response, body) => {[m
[31m-		if (error) console.log("error",error);[m
[31m-	});[m
[31m-};[m
[31m-[m
[31m-function load_template(){[m
[31m-	var file=path.join(__dirname,"./views/_booth.ejs");[m
[31m-	var data="";[m
[31m-	try{[m
[31m-		data=fs.readFileSync(file,'utf-8');[m
[31m-	}catch(e){[m
[31m-		logger.error(e.message);[m
[31m-		return "";[m
[31m-	}[m
[31m-	return data;[m
[31m-}[m
[31m-[m
[31m-function save_html(name,html){[m
[31m-	fs.writeFile(path.join(__dirname,'views/'+name+'.html'),html,(err)=>{[m
[31m-		 if(err){     [m
[31m-			 console.log("error occured"+err.message);[m
[31m-			 throw err;[m
[31m-		 }else{[m
[31m-			logger.info('write file successed');[m
[31m-		}[m
[31m-	});[m
[31m-}[m
[31m-[m
[31m-function make_template(filename,data){[m
[31m-	logger.info('make_tempalte',data);[m
[31m-	var template=load_template(`./views/${filename}.ejs`);[m
[31m-	logger.info('make_tempalte',template);[m
[31m-	var html=ejs.render(template,{data: data},(err,str)=>{[m
[31m-		if(err){[m
[31m-			logger.error('ejs error',err);[m
[31m-		}[m
[31m-		logger.info('ejs results',str);[m
[31m-	});[m
[31m-	save_html(filename,html);[m
[31m-	return html[m
[31m-}[m
[31m-[m
[31m-[m
[31m-module.exports={[m
[31m-	sendFile:slack_upload,[m
[31m-	slack_postMessage:slack_postMessage,[m
[31m-	res:slack_responce,[m
[31m-	log:slack_log,[m
[31m-	err:slack_err,[m
[31m-	download:download,[m
[31m-	make_template:make_template,[m
[31m-	help:help,[m
[31m-	read_list:read_list,[m
[31m-	json_sort:json_sort,[m
[31m-	to_Array:to_Array[m
[31m-}[m
[31m-[m
[31m-/*[m
[31m- * sample json data [m
[31m-	{[m
[31m-		"shopname":{"goods":{"name":"price"},"image":["image"],"text":"text"},[m
[31m-		"4j":{"goods":{"name":"price"},"image":["image"],"text":"text"}[m
[31m-	}  [m
[31m-*/[m
[31m-/* make_template tests */[m
[31m-[m
[31m-[m
[31m-if(require.main ===module){[m
[31m-/*[m
[31m-	var EVENT_DATA = JSON.parse(fs.readFileSync('./event.json', 'utf8'));[m
[31m-	var SHOP_DATA = JSON.parse(fs.readFileSync('./shop.json', 'utf8'));[m
[31m-	make_template('_timetable',EVENT_DATA);[m
[31m-	make_template('_news',EVENT_DATA);[m
[31m-    */[m
[31m-//	make_template('_shoptable','{"shopname":"4J","goods":{"goods":{"name":"price"},"image":["image"],"text":"text"}}');[m
[31m-//	slack_log("hello world");[m
[31m-}[m
[32m+[m[32mconst ejs=require('ejs');[m[41m[m
[32m+[m[32mconst dotenv=require('dotenv').config();[m[41m[m
[32m+[m[32mconst fs=require('fs');[m[41m[m
[32m+[m[32mconst mkdirp = require("mkdirp");[m[41m[m
[32m+[m[32mconst path=require('path');[m[41m[m
[32m+[m[32mconst request = require("request");[m[41m[m
[32m+[m[32mconst logger=require('pino')();[m[41m[m
[32m+[m[32mconst winston=require('winston');[m[41m[m
[32m+[m[32mconst SLACK_TOKEN=process.env.SLACK_TOKEN;[m[41m[m
[32m+[m[32mconst BOT_USERNAME='mogi-shop';[m[41m[m
[32m+[m[41m[m
[32m+[m[32mconst winstonlogger=winston.createLogger({[m[41m[m
[32m+[m	[32mtransports:[[m[41m[m
[32m+[m		[32mnew winston.transports.Console(),[m[41m[m
[32m+[m		[32mnew winston.transports.File({filename:'logs/info.log',level:'error'}),[m[41m[m
[32m+[m		[32mnew winston.transports.File({filename:'logs/combined.log'})[m[41m[m
[32m+[m	[32m][m[41m[m
[32m+[m[32m});[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction read_list(){[m[41m[m
[32m+[m	[32mtry{[m[41m[m
[32m+[m		[32marr = fs.readFileSync('./data/list.txt').toString().split('\r\n');[m[41m[m
[32m+[m	[32m}catch(e){[m[41m[m
[32m+[m		[32mconsole.log("can not read list.txt");[m[41m[m
[32m+[m	[32m}[m[41m[m
[32m+[m	[32mreturn arr;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction id_exist(shopid){[m[41m[m
[32m+[m	[32mvar shop_list=read_list();[m[41m[m
[32m+[m	[32mconsole.log(shop_list);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction json_sort(arr){[m[41m[m
[32m+[m	[32marr.sort(function(a,b) {[m[41m[m
[32m+[m[41m [m		[32mreturn (a.time > b.time ? 1 : 1);[m[41m[m
[32m+[m	[32m});[m[41m[m
[32m+[m	[32mfor(i = 0 ; i < arr.length ; i++ ){[m[41m[m
[32m+[m[32m　  	arr[i].id = i;[m[41m[m
[32m+[m	[32m}[m[41m[m
[32m+[m	[32mreturn arr;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction to_Array(shop){[m[41m[m
[32m+[m	[32mvar Ashop = [];[m[41m[m
[32m+[m	[32mvar cnt=0;[m[41m[m
[32m+[m	[32mfor(key in shop){[m[41m[m
[32m+[m		[32mAshop.push(shop[key]);[m[41m[m
[32m+[m		[32mAshop[cnt].id = key;[m[41m[m
[32m+[m		[32mcnt++;[m[41m[m
[32m+[m	[32m}[m[41m[m
[32m+[m	[32mconsole.log("Ashop",Ashop);[m[41m[m
[32m+[m	[32mfs.writeFileSync('./data/Ashop.json',JSON.stringify(Ashop));[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction slack_log(message){[m[41m[m
[32m+[m	[32mwinstonlogger.info(message);[m[41m[m
[32m+[m	[32mslack_postMessage("GCSFWFUE8",message);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction slack_err(message){[m[41m[m
[32m+[m	[32mwinstonlogger.error(message);[m[41m[m
[32m+[m	[32mslack_postMessage("#errors",message);[m[41m[m
[32m+[m	[32mslack_postMessage("#errors",message);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction slack_responce(message,event){[m[41m[m
[32m+[m[32m    if(event.username === BOT_USERNAME){[m[41m[m
[32m+[m[32m        return;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    console.log(message);[m[41m[m
[32m+[m	[32mrequest.post('https://slack.com/api/chat.postMessage',{[m[41m[m
[32m+[m		[32mform: {[m[41m[m
[32m+[m			[32mtoken: SLACK_TOKEN,[m[41m[m
[32m+[m			[32mchannel: event.channel,[m[41m[m
[32m+[m			[32musername: 'mogi-bot',[m[41m[m
[32m+[m			[32mtext: message[m[41m[m
[32m+[m		[32m}[m[41m[m
[32m+[m	[32m},(error, response, body) => {[m[41m[m
[32m+[m		[32mif (error) slack_err(error);[m[41m[m
[32m+[m	[32m});[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[32mfunction slack_upload(channel,image){[m[41m[m
[32m+[m	[32mconsole.log(channel,image,SLACK_TOKEN)[m[41m[m
[32m+[m	[32mvar arg={[m[41m[m
[32m+[m		[32murl:'https://slack.com/api/files.upload',[m[41m[m
[32m+[m		[32mheaders:{[m[41m[m
[32m+[m			[32m"Content-Type":"multipart/form-data;"[m[41m[m
[32m+[m		[32m},[m[41m[m
[32m+[m		[32mformData:{[m[41m[m
[32m+[m			[32mtoken: SLACK_TOKEN,[m[41m[m
[32m+[m			[32mchannels:channel,[m[41m[m
[32m+[m			[32musername:'mogi-bot',[m[41m[m
[32m+[m			[32mtitle:"Image",[m[41m[m
[32m+[m			[32mfilename:image,[m[41m[m
[32m+[m			[32mfile:fs.createReadStream(image),[m[41m[m
[32m+[m		[32m}[m[41m[m
[32m+[m	[32m};[m[41m[m
[32m+[m	[32mconsole.log(arg)[m[41m[m
[32m+[m	[32mrequest.post(arg,(error, response, body) => {[m[41m[m
[32m+[m		[32mconsole.log(body);[m[41m[m
[32m+[m	[32m});[m[41m[m
[32m+[m[32m};[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction download(dir,title,url){[m[41m[m
[32m+[m	[32mvar dir='./public/'+dir;[m[41m[m
[32m+[m	[32mvar fname=dir+'/'+title;[m[41m[m
[32m+[m	[32mmkdirp(dir,(err)=>{slack_log(err);});[m[41m[m
[32m+[m	[32mrequest({[m[41m[m
[32m+[m		[32murl:url,[m[41m[m
[32m+[m		[32mheaders:{'Authorization': 'Bearer '+SLACK_TOKEN}[m[41m[m
[32m+[m	[32m}).pipe(fs.createWriteStream(fname));[m[41m[m
[32m+[m	[32mconsole.log("download file successed",dir,fname,url);[m[41m[m
[32m+[m	[32mreturn fname;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mconst HELP_MESSAGE="booth\n\[m[41m[m
[32m+[m[32m```\[m[41m[m
[32m+[m[32m.help\n\[m[41m[m
[32m+[m[32m.goods <goods name> <price>\n\[m[41m[m
[32m+[m[32m.tag <number>\n\[m[41m[m
[32m+[m[32m.review\n\[m[41m[m
[32m+[m[32m.show\n\[m[41m[m
[32m+[m[32m```\n\[m[41m[m
[32m+[m[32mevent\n\[m[41m[m
[32m+[m[32m```\[m[41m[m
[32m+[m[32m.event <date> <start_time> <end_time> <place> <name> <content> <from>\n\[m[41m[m
[32m+[m[32m.show_event\[m[41m[m
[32m+[m[32m```";[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction help(event){[m[41m[m
[32m+[m	[32mslack_responce(HELP_MESSAGE,event);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction slack_postMessage(channel,message){[m[41m[m
[32m+[m	[32mres=request.post('https://slack.com/api/chat.postMessage',{[m[41m[m
[32m+[m		[32mform: {[m[41m[m
[32m+[m			[32mtoken: SLACK_TOKEN,[m[41m[m
[32m+[m			[32mchannel: channel,[m[41m[m
[32m+[m			[32musername: 'mogi-bot',[m[41m[m
[32m+[m			[32mtext:message[m[41m [m
[32m+[m		[32m}[m[41m[m
[32m+[m	[32m},(error, response, body) => {[m[41m[m
[32m+[m		[32mif (error) console.log("error",error);[m[41m[m
[32m+[m	[32m});[m[41m[m
[32m+[m[32m};[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction load_template(){[m[41m[m
[32m+[m	[32mvar file=path.join(__dirname,"./views/_booth.ejs");[m[41m[m
[32m+[m	[32mvar data="";[m[41m[m
[32m+[m	[32mtry{[m[41m[m
[32m+[m		[32mdata=fs.readFileSync(file,'utf-8');[m[41m[m
[32m+[m	[32m}catch(e){[m[41m[m
[32m+[m		[32mlogger.error(e.message);[m[41m[m
[32m+[m		[32mreturn "";[m[41m[m
[32m+[m	[32m}[m[41m[m
[32m+[m	[32mreturn data;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction save_html(name,html){[m[41m[m
[32m+[m	[32mfs.writeFile(path.join(__dirname,'views/'+name+'.html'),html,(err)=>{[m[41m[m
[32m+[m		[32m if(err){[m[41m     [m
[32m+[m			[32m console.log("error occured"+err.message);[m[41m[m
[32m+[m			[32m throw err;[m[41m[m
[32m+[m		[32m }else{[m[41m[m
[32m+[m			[32mlogger.info('write file successed');[m[41m[m
[32m+[m		[32m}[m[41m[m
[32m+[m	[32m});[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction make_template(filename,data){[m[41m[m
[32m+[m	[32mlogger.info('make_tempalte',data);[m[41m[m
[32m+[m	[32mvar template=load_template(`./views/${filename}.ejs`);[m[41m[m
[32m+[m	[32mlogger.info('make_tempalte',template);[m[41m[m
[32m+[m	[32mvar html=ejs.render(template,{data: data},(err,str)=>{[m[41m[m
[32m+[m		[32mif(err){[m[41m[m
[32m+[m			[32mlogger.error('ejs error',err);[m[41m[m
[32m+[m		[32m}[m[41m[m
[32m+[m		[32mlogger.info('ejs results',str);[m[41m[m
[32m+[m	[32m});[m[41m[m
[32m+[m	[32msave_html(filename,html);[m[41m[m
[32m+[m	[32mreturn html[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32mmodule.exports={[m[41m[m
[32m+[m	[32msendFile:slack_upload,[m[41m[m
[32m+[m	[32mslack_postMessage:slack_postMessage,[m[41m[m
[32m+[m	[32mres:slack_responce,[m[41m[m
[32m+[m	[32mlog:slack_log,[m[41m[m
[32m+[m	[32merr:slack_err,[m[41m[m
[32m+[m	[32mdownload:download,[m[41m[m
[32m+[m	[32mmake_template:make_template,[m[41m[m
[32m+[m	[32mhelp:help,[m[41m[m
[32m+[m	[32mread_list:read_list,[m[41m[m
[32m+[m	[32mjson_sort:json_sort,[m[41m[m
[32m+[m	[32mto_Array:to_Array[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/*[m[41m[m
[32m+[m[32m * sample json data[m[41m [m
[32m+[m	[32m{[m[41m[m
[32m+[m		[32m"shopname":{"goods":{"name":"price"},"image":["image"],"text":"text"},[m[41m[m
[32m+[m		[32m"4j":{"goods":{"name":"price"},"image":["image"],"text":"text"}[m[41m[m
[32m+[m	[32m}[m[41m  [m
[32m+[m[32m*/[m[41m[m
[32m+[m[32m/* make_template tests */[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32mif(require.main ===module){[m[41m[m
[32m+[m[32m/*[m[41m[m
[32m+[m	[32mvar EVENT_DATA = JSON.parse(fs.readFileSync('./event.json', 'utf8'));[m[41m[m
[32m+[m	[32mvar SHOP_DATA = JSON.parse(fs.readFileSync('./shop.json', 'utf8'));[m[41m[m
[32m+[m	[32mmake_template('_timetable',EVENT_DATA);[m[41m[m
[32m+[m	[32mmake_template('_news',EVENT_DATA);[m[41m[m
[32m+[m[32m    */[m[41m[m
[32m+[m[32m//	make_template('_shoptable','{"shopname":"4J","goods":{"goods":{"name":"price"},"image":["image"],"text":"text"}}');[m[41m[m
[32m+[m[32m//	slack_log("hello world");[m[41m[m
[32m+[m[32m}[m[41m[m
[1mdiff --git a/scripts/README.md b/scripts/README.md[m
[1mindex fe09659..2eecdaa 100644[m
[1m--- a/scripts/README.md[m
[1m+++ b/scripts/README.md[m
[36m@@ -1,10 +1,10 @@[m
[31m-```[m
[31m-curl -O makenew.sh https://raw.githubusercontent.com/teamET/2018.perform/develop/makenew/makenew.sh[m
[31m-./makenew.sh {username}[m
[31m-passwd {usernam}[m
[31m-su - {username}[m
[31m-git clone https://github.com/sakakendo0321/dotfiles[m
[31m-cd dotfiles/ubunutu[m
[31m-source ~/.setup.sh[m
[31m-```[m
[31m-[m
[32m+[m[32m```[m[41m[m
[32m+[m[32mcurl -O makenew.sh https://raw.githubusercontent.com/teamET/2018.perform/develop/makenew/makenew.sh[m[41m[m
[32m+[m[32m./makenew.sh {username}[m[41m[m
[32m+[m[32mpasswd {usernam}[m[41m[m
[32m+[m[32msu - {username}[m[41m[m
[32m+[m[32mgit clone https://github.com/sakakendo0321/dotfiles[m[41m[m
[32m+[m[32mcd dotfiles/ubunutu[m[41m[m
[32m+[m[32msource ~/.setup.sh[m[41m[m
[32m+[m[32m```[m[41m[m
[32m+[m[41m[m
[1mdiff --git a/scripts/makenew.sh b/scripts/makenew.sh[m
[1mindex 7452808..f1eea23 100644[m
[1m--- a/scripts/makenew.sh[m
[1m+++ b/scripts/makenew.sh[m
[36m@@ -1,17 +1,17 @@[m
[31m-echo your user name is $1 right? [Y/n][m
[31m-read ANS[m
[31m-[m
[31m-case $ANS in[m
[31m-	"" | "Y" | "y" | "yes") echo ok,command continue;;[m
[31m-	* ) echo exit && exit;[m
[31m-esac[m
[31m-[m
[31m-useradd $1 [m
[31m-mkdir /home/$1[m
[31m-sudo usermod $1 -d /home/$1 -g $1 -G $1,root,sudo[m
[31m-chown $1 /home/$1[m
[31m-chsh $1 -s /bin/bash[m
[31m-[m
[31m-ls -l /home/[m
[31m-groups $1[m
[31m-[m
[32m+[m[32mecho your user name is $1 right? [Y/n][m[41m[m
[32m+[m[32mread ANS[m[41m[m
[32m+[m[41m[m
[32m+[m[32mcase $ANS in[m[41m[m
[32m+[m	[32m"" | "Y" | "y" | "yes") echo ok,command continue;;[m[41m[m
[32m+[m	[32m* ) echo exit && exit;[m[41m[m
[32m+[m[32mesac[m[41m[m
[32m+[m[41m[m
[32m+[m[32museradd $1[m[41m [m
[32m+[m[32mmkdir /home/$1[m[41m[m
[32m+[m[32msudo usermod $1 -d /home/$1 -g $1 -G $1,root,sudo[m[41m[m
[32m+[m[32mchown $1 /home/$1[m[41m[m
[32m+[m[32mchsh $1 -s /bin/bash[m[41m[m
[32m+[m[41m[m
[32m+[m[32mls -l /home/[m[41m[m
[32m+[m[32mgroups $1[m[41m[m
[32m+[m[41m[m
[1mdiff --git a/scripts/setup.develop.sh b/scripts/setup.develop.sh[m
[1mindex 205d9ce..71265b4 100644[m
[1m--- a/scripts/setup.develop.sh[m
[1m+++ b/scripts/setup.develop.sh[m
[36m@@ -1,25 +1,25 @@[m
[31m-echo "arg:" $@[m
[31m-source $HOME/.bash_profile[m
[31m-[m
[31m-function mes(){[m
[31m-    echo $1,$2[m
[31m-    curl -X POST --data-urlencode \[m
[31m-    "payload={\"channel\": $1, \"username\": \"webhookbot\", \"text\": \"$2\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m
[31m-}[m
[31m-[m
[31m-hexo --version[m
[31m-npm --version[m
[31m-node --version[m
[31m-[m
[31m-# hexo[m
[31m-cd $HOME/dep/static/[m
[31m-npm install[m
[31m-npm install --save hexo-cli[m
[31m-hexo generate --force --bail[m
[31m-\cp -uvrf ./public/* /var/www/public/[m
[31m-echo "{'test':'test'}" > /var/www/public/data/test.json[m
[31m-[m
[31m-mes \"#bot\" "*development*"[m
[31m-mes \"#bot\" "$(find /var/www/public -maxdepth 1 -type d iprintf '%f\n')"[m
[31m-mes \"#bot\" "https://$(curl ifconfig.io)/$1\n \`ssh $(whoami)@$(curl ifconfig.io)\`"[m
[31m-mes \"#server_log\" "\`\`\`$(cd /var/www/public/$1 ;find .|sort)\`\`\`"[m
[32m+[m[32mecho "arg:" $@[m[41m[m
[32m+[m[32msource $HOME/.bash_profile[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction mes(){[m[41m[m
[32m+[m[32m    echo $1,$2[m[41m[m
[32m+[m[32m    curl -X POST --data-urlencode \[m[41m[m
[32m+[m[32m    "payload={\"channel\": $1, \"username\": \"webhookbot\", \"text\": \"$2\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mhexo --version[m[41m[m
[32m+[m[32mnpm --version[m[41m[m
[32m+[m[32mnode --version[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# hexo[m[41m[m
[32m+[m[32mcd $HOME/dep/static/[m[41m[m
[32m+[m[32mnpm install[m[41m[m
[32m+[m[32mnpm install --save hexo-cli[m[41m[m
[32m+[m[32mhexo generate --force --bail[m[41m[m
[32m+[m[32m\cp -uvrf ./public/* /var/www/public/[m[41m[m
[32m+[m[32mecho "{'test':'test'}" > /var/www/public/data/test.json[m[41m[m
[32m+[m[41m[m
[32m+[m[32mmes \"#bot\" "*development*"[m[41m[m
[32m+[m[32mmes \"#bot\" "$(find /var/www/public -maxdepth 1 -type d iprintf '%f\n')"[m[41m[m
[32m+[m[32mmes \"#bot\" "https://$(curl ifconfig.io)/$1\n \`ssh $(whoami)@$(curl ifconfig.io)\`"[m[41m[m
[32m+[m[32mmes \"#server_log\" "\`\`\`$(cd /var/www/public/$1 ;find .|sort)\`\`\`"[m[41m[m
[1mdiff --git a/scripts/setup.product.sh b/scripts/setup.product.sh[m
[1mindex 16f1eda..4569c2c 100644[m
[1m--- a/scripts/setup.product.sh[m
[1m+++ b/scripts/setup.product.sh[m
[36m@@ -1,39 +1,39 @@[m
[31m-source $HOME/.bash_profile[m
[31m-[m
[31m-function start_forever(){[m
[31m-    echo start process $1 , $2[m
[31m-    cd $1[m
[31m-    npm install[m
[31m-    forever restart $2 --minUptime 1000 --spinSleepTime 1000 || \[m
[31m-        (forever start $2 --minUptime 1000 --spinSleepTime 1000 )[m
[31m-}[m
[31m-[m
[31m-function mes(){[m
[31m-    echo $1[m
[31m-    curl -X POST --data-urlencode \[m
[31m-    "payload={\"channel\": \"#server_log\", \"username\": \"webhookbot\", \"text\": \"\`\`\` $1 \`\`\`\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m
[31m-}[m
[31m-[m
[31m-hexo --version[m
[31m-npm --version[m
[31m-node --version[m
[31m-[m
[31m-# hexo[m
[31m-cd $HOME/2018.perform/static[m
[31m-npm install --save hexo-cli[m
[31m-hexo generate --force --bail[m
[31m-\cp -rf ./public/* /var/www/public[m
[31m-echo "{'test':'test'}" > /var/www/public/data/test.json  #/var/www/public/data should be directory[m
[31m-[m
[31m-[m
[31m-[m
[31m-start_forever $HOME/2018.perform/bot/ bot.js[m
[31m-start_forever $HOME/2018.perform/api-server/ bin/www[m
[31m-forever list[m
[31m-[m
[31m-[m
[31m-curl -X POST --data-urlencode "payload={\"channel\": \"#bot\", \"username\": \"webhookbot\", \"text\": \"This is posted to #bot and comes from a bot named webhookbot.\n https://$(curl ifconfig.io)\n \`$(whoami)@$(curl ifconfig.io)\`\n\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m
[31m-[m
[31m-curl -X POST --data-urlencode "payload={\"channel\": \"#server_log\", \"username\": \"webhookbot\", \"text\": \"\`\`\`$(cd /var/www/public ;find .|sort)\`\`\`\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m
[31m-[m
[31m-mes "hello slack func"[m
[32m+[m[32msource $HOME/.bash_profile[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction start_forever(){[m[41m[m
[32m+[m[32m    echo start process $1 , $2[m[41m[m
[32m+[m[32m    cd $1[m[41m[m
[32m+[m[32m    npm install[m[41m[m
[32m+[m[32m    forever restart $2 --minUptime 1000 --spinSleepTime 1000 || \[m[41m[m
[32m+[m[32m        (forever start $2 --minUptime 1000 --spinSleepTime 1000 )[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction mes(){[m[41m[m
[32m+[m[32m    echo $1[m[41m[m
[32m+[m[32m    curl -X POST --data-urlencode \[m[41m[m
[32m+[m[32m    "payload={\"channel\": \"#server_log\", \"username\": \"webhookbot\", \"text\": \"\`\`\` $1 \`\`\`\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mhexo --version[m[41m[m
[32m+[m[32mnpm --version[m[41m[m
[32m+[m[32mnode --version[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# hexo[m[41m[m
[32m+[m[32mcd $HOME/2018.perform/static[m[41m[m
[32m+[m[32mnpm install --save hexo-cli[m[41m[m
[32m+[m[32mhexo generate --force --bail[m[41m[m
[32m+[m[32m\cp -rf ./public/* /var/www/public[m[41m[m
[32m+[m[32mecho "{'test':'test'}" > /var/www/public/data/test.json  #/var/www/public/data should be directory[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32mstart_forever $HOME/2018.perform/bot/ bot.js[m[41m[m
[32m+[m[32mstart_forever $HOME/2018.perform/api-server/ bin/www[m[41m[m
[32m+[m[32mforever list[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32mcurl -X POST --data-urlencode "payload={\"channel\": \"#bot\", \"username\": \"webhookbot\", \"text\": \"This is posted to #bot and comes from a bot named webhookbot.\n https://$(curl ifconfig.io)\n \`$(whoami)@$(curl ifconfig.io)\`\n\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m[41m[m
[32m+[m[41m[m
[32m+[m[32mcurl -X POST --data-urlencode "payload={\"channel\": \"#server_log\", \"username\": \"webhookbot\", \"text\": \"\`\`\`$(cd /var/www/public ;find .|sort)\`\`\`\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m[41m[m
[32m+[m[41m[m
[32m+[m[32mmes "hello slack func"[m[41m[m
[1mdiff --git a/scripts/setup.sh b/scripts/setup.sh[m
[1mindex 3280e69..845a53a 100644[m
[1m--- a/scripts/setup.sh[m
[1m+++ b/scripts/setup.sh[m
[36m@@ -1,39 +1,39 @@[m
[31m-source $HOME/.bash_profile[m
[31m-[m
[31m-function start_forever(){[m
[31m-    echo start process $1 , $2[m
[31m-    cd $1[m
[31m-    npm install[m
[31m-    forever restart $2 --minUptime 1000 --spinSleepTime 1000 || \[m
[31m-        (forever start $2 --minUptime 1000 --spinSleepTime 1000 )[m
[31m-}[m
[31m-[m
[31m-function mes(){[m
[31m-    echo $1[m
[31m-    curl -X POST --data-urlencode \[m
[31m-    "payload={\"channel\": \"#server_log\", \"username\": \"webhookbot\", \"text\": \"\`\`\` $1 \`\`\`\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m
[31m-}[m
[31m-[m
[31m-hexo --version[m
[31m-npm --version[m
[31m-node --version[m
[31m-[m
[31m-# hexo[m
[31m-cd $HOME/2018.perform/static[m
[31m-npm install --save hexo-cli[m
[31m-hexo generate --force --bail[m
[31m-\cp -rf ./public/* /var/www/public[m
[31m-echo "{'test':'test'}" > /var/www/public/data/test.json  #/var/www/public/data should be directory[m
[31m-[m
[31m-[m
[31m-[m
[31m-start_forever $HOME/2018.perform/bot/ bot.js[m
[31m-start_forever $HOME/2018.perform/api-server/ bin/www[m
[31m-forever list[m
[31m-[m
[31m-[m
[31m-curl -X POST --data-urlencode "payload={\"channel\": \"#bot\", \"username\": \"webhookbot\", \"text\": \"This is posted to #bot and comes from a bot named webhookbot.\n http://$(curl ifconfig.io)\n \`$(whoami)@$(curl ifconfig.io)\`\n\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m
[31m-[m
[31m-curl -X POST --data-urlencode "payload={\"channel\": \"#server_log\", \"username\": \"webhookbot\", \"text\": \"\`\`\`$(cd /var/www/public ;find .|sort)\`\`\`\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m
[31m-[m
[31m-mes "hello slack func"[m
[32m+[m[32msource $HOME/.bash_profile[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction start_forever(){[m[41m[m
[32m+[m[32m    echo start process $1 , $2[m[41m[m
[32m+[m[32m    cd $1[m[41m[m
[32m+[m[32m    npm install[m[41m[m
[32m+[m[32m    forever restart $2 --minUptime 1000 --spinSleepTime 1000 || \[m[41m[m
[32m+[m[32m        (forever start $2 --minUptime 1000 --spinSleepTime 1000 )[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mfunction mes(){[m[41m[m
[32m+[m[32m    echo $1[m[41m[m
[32m+[m[32m    curl -X POST --data-urlencode \[m[41m[m
[32m+[m[32m    "payload={\"channel\": \"#server_log\", \"username\": \"webhookbot\", \"text\": \"\`\`\` $1 \`\`\`\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mhexo --version[m[41m[m
[32m+[m[32mnpm --version[m[41m[m
[32m+[m[32mnode --version[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# hexo[m[41m[m
[32m+[m[32mcd $HOME/2018.perform/static[m[41m[m
[32m+[m[32mnpm install --save hexo-cli[m[41m[m
[32m+[m[32mhexo generate --force --bail[m[41m[m
[32m+[m[32m\cp -rf ./public/* /var/www/public[m[41m[m
[32m+[m[32mecho "{'test':'test'}" > /var/www/public/data/test.json  #/var/www/public/data should be directory[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32mstart_forever $HOME/2018.perform/bot/ bot.js[m[41m[m
[32m+[m[32mstart_forever $HOME/2018.perform/api-server/ bin/www[m[41m[m
[32m+[m[32mforever list[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32mcurl -X POST --data-urlencode "payload={\"channel\": \"#bot\", \"username\": \"webhookbot\", \"text\": \"This is posted to #bot and comes from a bot named webhookbot.\n http://$(curl ifconfig.io)\n \`$(whoami)@$(curl ifconfig.io)\`\n\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m[41m[m
[32m+[m[41m[m
[32m+[m[32mcurl -X POST --data-urlencode "payload={\"channel\": \"#server_log\", \"username\": \"webhookbot\", \"text\": \"\`\`\`$(cd /var/www/public ;find .|sort)\`\`\`\", \"icon_emoji\": \":sunglasses:\"}" $WEBHOOK_URL[m[41m[m
[32m+[m[41m[m
[32m+[m[32mmes "hello slack func"[m[41m[m
[1mdiff --git a/static/source/gallery/index.md b/static/source/gallery/index.md[m
[1mindex 8942877..513a4fe 100644[m
[1m--- a/static/source/gallery/index.md[m
[1m+++ b/static/source/gallery/index.md[m
[36m@@ -1,5 +1,5 @@[m
[31m----[m
[31m-title: gallery[m
[31m-date: 2018-10-10 15:32:17[m
[31m-layout: gallery[m
[31m----[m
[32m+[m[32m---[m[41m[m
[32m+[m[32mtitle: gallery[m[41m[m
[32m+[m[32mdate: 2018-10-10 15:32:17[m[41m[m
[32m+[m[32mlayout: gallery[m[41m[m
[32m+[m[32m---[m[41m[m
[1mdiff --git a/static/source/lineat/index.md b/static/source/lineat/index.md[m
[1mindex f1f13de..733f157 100644[m
[1m--- a/static/source/lineat/index.md[m
[1m+++ b/static/source/lineat/index.md[m
[36m@@ -1,5 +1,5 @@[m
[31m----[m
[31m-title: line@[m
[31m-date: 2018-10-11 12:12:32[m
[31m-layout: lineat[m
[31m----[m
[32m+[m[32m---[m[41m[m
[32m+[m[32mtitle: line@[m[41m[m
[32m+[m[32mdate: 2018-10-11 12:12:32[m[41m[m
[32m+[m[32mlayout: lineat[m[41m[m
[32m+[m[32m---[m[41m[m
[1mdiff --git a/static/themes/landscape/_config.yml b/static/themes/landscape/_config.yml[m
[1mindex cfed607..8b63c24 100644[m
[1m--- a/static/themes/landscape/_config.yml[m
[1m+++ b/static/themes/landscape/_config.yml[m
[36m@@ -1,43 +1,43 @@[m
[31m-# Header[m
[31m-menu:[m
[31m-  Home: /[m
[31m-  #About: /about[m
[31m-  Booth: /mogi-shop[m
[31m-  Event: /event[m
[31m-  Gallery: /gallery[m
[31m-  Access: /access[m
[31m-  Link: /link[m
[31m-  LINE@: /lineat[m
[31m-  #Map: /map[m
[31m-[m
[31m-# Content[m
[31m-excerpt_link: Read More[m
[31m-fancybox: true[m
[31m-[m
[31m-# Sidebar[m
[31m-# sidebar: right[m
[31m-# widgets:[m
[31m-# - category[m
[31m-# - tag[m
[31m-# - tagcloud[m
[31m-# - archive[m
[31m-# - recent_posts[m
[31m-[m
[31m-# display widgets at the bottom of index pages (pagination == 2)[m
[31m-index_widgets:[m
[31m-# - category[m
[31m-# - tagcloud[m
[31m-# - archive[m
[31m-[m
[31m-# widget behavior[m
[31m-archive_type: 'monthly'[m
[31m-show_count: false[m
[31m-[m
[31m-# Miscellaneous[m
[31m-google_analytics: 'UA-121910998-7'[m
[31m-gauges_analytics:[m
[31m-favicon: /favicon.png[m
[31m-twitter:[m
[31m-google_plus:[m
[31m-fb_admins:[m
[31m-fb_app_id:[m
[32m+[m[32m# Header[m[41m[m
[32m+[m[32mmenu:[m[41m[m
[32m+[m[32m  Home: /[m[41m[m
[32m+[m[32m  #About: /about[m[41m[m
[32m+[m[32m  Booth: /mogi-shop[m[41m[m
[32m+[m[32m  Event: /event[m[41m[m
[32m+[m[32m  Gallery: /gallery[m[41m[m
[32m+[m[32m  Access: /access[m[41m[m
[32m+[m[32m  Link: /link[m[41m[m
[32m+[m[32m  LINE@: /lineat[m[41m[m
[32m+[m[32m  #Map: /map[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Content[m[41m[m
[32m+[m[32mexcerpt_link: Read More[m[41m[m
[32m+[m[32mfancybox: true[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Sidebar[m[41m[m
[32m+[m[32m# sidebar: right[m[41m[m
[32m+[m[32m# widgets:[m[41m[m
[32m+[m[32m# - category[m[41m[m
[32m+[m[32m# - tag[m[41m[m
[32m+[m[32m# - tagcloud[m[41m[m
[32m+[m[32m# - archive[m[41m[m
[32m+[m[32m# - recent_posts[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# display widgets at the bottom of index pages (pagination == 2)[m[41m[m
[32m+[m[32mindex_widgets:[m[41m[m
[32m+[m[32m# - category[m[41m[m
[32m+[m[32m# - tagcloud[m[41m[m
[32m+[m[32m# - archive[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# widget behavior[m[41m[m
[32m+[m[32marchive_type: 'monthly'[m[41m[m
[32m+[m[32mshow_count: false[m[41m[m
[32m+[m[41m[m
[32m+[m[32m# Miscellaneous[m[41m[m
[32m+[m[32mgoogle_analytics: 'UA-121910998-7'[m[41m[m
[32m+[m[32mgauges_analytics:[m[41m[m
[32m+[m[32mfavicon: /favicon.png[m[41m[m
[32m+[m[32mtwitter:[m[41m[m
[32m+[m[32mgoogle_plus:[m[41m[m
[32m+[m[32mfb_admins:[m[41m[m
[32m+[m[32mfb_app_id:[m[41m[m
[1mdiff --git a/static/themes/landscape/layout/_partial/header.ejs b/static/themes/landscape/layout/_partial/header.ejs[m
[1mindex 5d87583..66a1dcd 100644[m
[1m--- a/static/themes/landscape/layout/_partial/header.ejs[m
[1m+++ b/static/themes/landscape/layout/_partial/header.ejs[m
[36m@@ -1,34 +1,34 @@[m
[31m-<header id="header">[m
[31m-  <div id="banner"></div>[m
[31m-  <div id="header-outer" class="outer">[m
[31m-    <div id="header-title" class="inner">[m
[31m-      <h1 id="logo-wrap">  [m
[31m-        <a href="<%- url_for() %>" id="logo"><%= config.title %></a><br class="header_title" >[m
[31m-        <a href="<%- url_for() %>" id="logo"><%= config.title2 %></a>[m
[31m-      </h1>[m
[31m-      <% if (theme.subtitle){ %>[m
[31m-        <h2 id="subtitle-wrap"> [m
[31m-          <a href="<%- url_for() %>" id="subtitle"><%= theme.subtitle %></a>[m
[31m-        </h2>[m
[31m-      <% } %>[m
[31m-    </div>[m
[31m-    <div id="header-inner" class="inner">[m
[31m-      <nav id="main-nav">[m
[31m-        <a id="main-nav-toggle" class="nav-icon"></a>[m
[31m-        <% for (var i in theme.menu){ %>[m
[31m-          <a class="main-nav-link" href="<%- url_for(theme.menu[i]) %>"><%= i %></a>[m
[31m-        <% } %>[m
[31m-      </nav>[m
[31m-      <nav id="sub-nav">[m
[31m-        <% if (theme.rss){ %>[m
[31m-          <a id="nav-rss-link" class="nav-icon" href="<%- url_for(theme.rss) %>" title="<%= __('rss_feed') %>"></a>[m
[31m-        <% } %>[m
[31m-        <a class="icon" href="https://www.tokyo-ct.ac.jp/"><img src="https://user-images.githubusercontent.com/38575274/46780016-75f98080-cd55-11e8-9336-ad8786da7607.png"><a>[m
[31m-        <!-- <a id="nav-search-btn" class="nav-icon" title="<%= __('search') %>"></a> -->[m
[31m-      </nav>[m
[31m-      <div id="search-form-wrap">[m
[31m-        <%- search_form({button: '&#xF002;'}) %>[m
[31m-      </div>[m
[31m-    </div>[m
[31m-  </div>[m
[32m+[m[32m<header id="header">[m[41m[m
[32m+[m[32m  <div id="banner"></div>[m[41m[m
[32m+[m[32m  <div id="header-outer" class="outer">[m[41m[m
[32m+[m[32m    <div id="header-title" class="inner">[m[41m[m
[32m+[m[32m      <h1 id="logo-wrap">[m[41m  [m
[32m+[m[32m        <a href="<%- url_for() %>" id="logo"><%= config.title %></a><br class="header_title" >[m[41m[m
[32m+[m[32m        <a href="<%- url_for() %>" id="logo"><%= config.title2 %></a>[m[41m[m
[32m+[m[32m      </h1>[m[41m[m
[32m+[m[32m      <% if (theme.subtitle){ %>[m[41m[m
[32m+[m[32m        <h2 id="subtitle-wrap">[m[41m [m
[32m+[m[32m          <a href="<%- url_for() %>" id="subtitle"><%= theme.subtitle %></a>[m[41m[m
[32m+[m[32m        </h2>[m[41m[m
[32m+[m[32m      <% } %>[m[41m[m
[32m+[m[32m    </div>[m[41m[m
[32m+[m[32m    <div id="header-inner" class="inner">[m[41m[m
[32m+[m[32m      <nav id="main-nav">[m[41m[m
[32m+[m[32m        <a id="main-nav-toggle" class="nav-icon"></a>[m[41m[m
[32m+[m[32m        <% for (var i in theme.menu){ %>[m[41m[m
[32m+[m[32m          <a class="main-nav-link" href="<%- url_for(theme.menu[i]) %>"><%= i %></a>[m[41m[m
[32m+[m[32m        <% } %>[m[41m[m
[32m+[m[32m      </nav>[m[41m[m
[32m+[m[32m      <nav id="sub-nav">[m[41m[m
[32m+[m[32m        <% if (theme.rss){ %>[m[41m[m
[32m+[m[32m          <a id="nav-rss-link" class="nav-icon" href="<%- url_for(theme.rss) %>" title="<%= __('rss_feed') %>"></a>[m[41m[m
[32m+[m[32m        <% } %>[m[41m[m
[32m+[m[32m        <a class="icon" href="https://www.tokyo-ct.ac.jp/"><img src="https://user-images.githubusercontent.com/38575274/46780016-75f98080-cd55-11e8-9336-ad8786da7607.png"><a>[m[41m[m
[32m+[m[32m        <!-- <a id="nav-search-btn" class="nav-icon" title="<%= __('search') %>"></a> -->[m[41m[m
[32m+[m[32m      </nav>[m[41m[m
[32m+[m[32m      <div id="search-form-wrap">[m[41m[m
[32m+[m[32m        <%- search_form({button: '&#xF002;'}) %>[m[41m[m
[32m+[m[32m      </div>[m[41m[m
[32m+[m[32m    </div>[m[41m[m
[32m+[m[32m  </div>[m[41m[m
 </header>[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/layout/about.ejs b/static/themes/landscape/layout/about.ejs[m
[1mindex 94a3862..90ed780 100644[m
[1m--- a/static/themes/landscape/layout/about.ejs[m
[1m+++ b/static/themes/landscape/layout/about.ejs[m
[36m@@ -1,9 +1,9 @@[m
[31m-[m
[31m-<p>[m
[31m-東京高専の文化祭、くぬぎだ祭にようこそ！ <br>[m
[31m-このくぬぎだ祭は学生が全部一から企画し、作り、運営しています。 <br>[m
[31m-様々な模擬店や、部活・文化祭実行委員の企画や演奏、パンフ・HPといったの制作物などなど、[m
[31m-楽しめるものばかりとなっています！<br>是非お楽しみに！<br>[m
[31m-そして今年のテーマは「メカニック」です。<br>その雰囲気を感じて下されば幸いです！<br>[m
[31m-</p>[m
[31m-[m
[32m+[m[41m[m
[32m+[m[32m<p>[m[41m[m
[32m+[m[32m東京高専の文化祭、くぬぎだ祭にようこそ！ <br>[m[41m[m
[32m+[m[32mこのくぬぎだ祭は学生が全部一から企画し、作り、運営しています。 <br>[m[41m[m
[32m+[m[32m様々な模擬店や、部活・文化祭実行委員の企画や演奏、パンフ・HPといったの制作物などなど、[m[41m[m
[32m+[m[32m楽しめるものばかりとなっています！<br>是非お楽しみに！<br>[m[41m[m
[32m+[m[32mそして今年のテーマは「メカニック」です。<br>その雰囲気を感じて下されば幸いです！<br>[m[41m[m
[32m+[m[32m</p>[m[41m[m
[32m+[m[41m[m
[1mdiff --git a/static/themes/landscape/layout/access.ejs b/static/themes/landscape/layout/access.ejs[m
[1mindex 33e5a7b..415fac1 100644[m
[1m--- a/static/themes/landscape/layout/access.ejs[m
[1m+++ b/static/themes/landscape/layout/access.ejs[m
[36m@@ -1,20 +1,20 @@[m
[31m-[m
[31m-<section id="access">[m
[31m-    <header>[m
[31m-       [m
[31m-    </header>[m
[31m-	<div class="access">[m
[31m-		<h1>アクセス</h1>[m
[31m-		<h2>周辺地図</h2>[m
[31m-		<p><img class="aligncenter size-full wp-image-505 tmp_off" src="https://user-images.githubusercontent.com/28770698/46122739-71ad6d80-c255-11e8-96f6-d5aba0c54607.gif" alt="" width="450" height="321" /></p>[m
[31m-		<p>京王線「狭間」駅(準特急停車)下車　徒歩5分<br />[m
[31m-		京王線「めじろ台」駅(準特急停車)下車　徒歩15分 または タクシー5分</p>[m
[31m-[m
[31m-		<!-- <h1>リンク</h1>[m
[31m-		<ul class="objectlink">[m
[31m-			<li><a href="https://www.tokyo-ct.ac.jp/">東京高専（外部リンク）</a></li>[m
[31m-			<li><a href="http://www.tokyo-ct-s.jp/">東京高専後援会（外部リンク）</a></li>[m
[31m-			<li><a href="http://www.kosen-k.go.jp/">国立高等専門学校機構（外部リンク）</a></li>[m
[31m-		</ul> -->[m
[31m-	</div>[m
[31m-</section>[m
[32m+[m[41m[m
[32m+[m[32m<section id="access">[m[41m[m
[32m+[m[32m    <header>[m[41m[m
[32m+[m[41m       [m
[32m+[m[32m    </header>[m[41m[m
[32m+[m	[32m<div class="access">[m[41m[m
[32m+[m		[32m<h1>アクセス</h1>[m[41m[m
[32m+[m		[32m<h2>周辺地図</h2>[m[41m[m
[32m+[m		[32m<p><img class="aligncenter size-full wp-image-505 tmp_off" src="https://user-images.githubusercontent.com/28770698/46122739-71ad6d80-c255-11e8-96f6-d5aba0c54607.gif" alt="" width="450" height="321" /></p>[m[41m[m
[32m+[m		[32m<p>京王線「狭間」駅(準特急停車)下車　徒歩5分<br />[m[41m[m
[32m+[m		[32m京王線「めじろ台」駅(準特急停車)下車　徒歩15分 または タクシー5分</p>[m[41m[m
[32m+[m[41m[m
[32m+[m		[32m<!-- <h1>リンク</h1>[m[41m[m
[32m+[m		[32m<ul class="objectlink">[m[41m[m
[32m+[m			[32m<li><a href="https://www.tokyo-ct.ac.jp/">東京高専（外部リンク）</a></li>[m[41m[m
[32m+[m			[32m<li><a href="http://www.tokyo-ct-s.jp/">東京高専後援会（外部リンク）</a></li>[m[41m[m
[32m+[m			[32m<li><a href="http://www.kosen-k.go.jp/">国立高等専門学校機構（外部リンク）</a></li>[m[41m[m
[32m+[m		[32m</ul> -->[m[41m[m
[32m+[m	[32m</div>[m[41m[m
[32m+[m[32m</section>[m[41m[m
[1mdiff --git a/static/themes/landscape/layout/event.ejs b/static/themes/landscape/layout/event.ejs[m
[1mindex 2a7cf72..c0c8440 100644[m
[1m--- a/static/themes/landscape/layout/event.ejs[m
[1m+++ b/static/themes/landscape/layout/event.ejs[m
[36m@@ -1,55 +1,55 @@[m
[31m-<section id="event">[m
[31m-    <header>[m
[31m-       [m
[31m-    </header>[m
[31m-    </script-->[m
[31m-    <!-- <div class="slide-show w3-content w3-display-container">[m
[31m-        <p class="txt">第一体育館</p>[m
[31m-        <p class="txt">第二体育館</p>[m
[31m-        <p class="txt">購買前</p>[m
[31m-        <p class="txt">企画</p>[m
[31m-        <img class="mySlides" src="https://user-images.githubusercontent.com/38575274/44301309-a8878e00-a34f-11e8-971c-fde728bb12ba.jpg">[m
[31m-        <img class="mySlides" src="https://user-images.githubusercontent.com/38575274/44301310-a8878e00-a34f-11e8-8ee0-ba6ba791c3bd.jpg">[m
[31m-        <img class="mySlides" src="https://user-images.githubusercontent.com/38575274/44301311-a8878e00-a34f-11e8-8ce6-7328bdde6fce.jpg">[m
[31m-        <img class="mySlides" src="https://user-images.githubusercontent.com/38575274/44301310-a8878e00-a34f-11e8-8ee0-ba6ba791c3bd.jpg">[m
[31m-        <button class="w3-button w3-black w3-display-left" onclick="plusDivs(-1)">&#10094;</button>[m
[31m-        <button class="w3-button w3-black w3-display-right" onclick="plusDivs(1)">&#10095;</button>[m
[31m-    [m
[31m-    </div> -->[m
[31m-[m
[31m-    <script>[m
[31m-        var slideIndex = 1;[m
[31m-        showDivs(slideIndex);[m
[31m-[m
[31m-        function plusDivs(n) {[m
[31m-        showDivs(slideIndex += n);[m
[31m-        }[m
[31m-        [m
[31m-[m
[31m-        function showDivs(n) {[m
[31m-        var i;[m
[31m-        var x = document.getElementsByClassName("mySlides");[m
[31m-        var y = document.getElementsByClassName("txt");[m
[31m-        if (n > x.length) {slideIndex = 1}    [m
[31m-        if (n < 1) {slideIndex = x.length}[m
[31m-        for (i = 0; i < x.length; i++) {[m
[31m-            x[i].style.display = "none";[m
[31m-            y[i].style.display = "none";[m
[31m-        }[m
[31m-        x[slideIndex-1].style.display = "block";[m
[31m-        y[slideIndex-1].style.display = "block";[m
[31m-        }[m
[31m-    </script>[m
[31m-    <div>[m
[31m-   </div>[m
[31m-<div class="event">[m
[31m-    <div class="w3-content" id="skeduler-container"></div>[m
[31m-    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>[m
[31m-[m
[31m-    <%- css('fancybox/jquery.skeduler') %>[m
[31m-    <%- js('fancybox/jquery.skeduler') %>[m
[31m-    <%- js('fancybox/skeduler') %>[m
[31m-    <%- js('fancybox/htmlpreview.min') %>[m
[31m-    <%- js('fancybox/jquery-2.2.4.min') %>[m
[31m-    </section>[m
[32m+[m[32m<section id="event">[m[41m[m
[32m+[m[32m    <header>[m[41m[m
[32m+[m[41m       [m
[32m+[m[32m    </header>[m[41m[m
[32m+[m[32m    </script-->[m[41m[m
[32m+[m[32m    <!-- <div class="slide-show w3-content w3-display-container">[m[41m[m
[32m+[m[32m        <p class="txt">第一体育館</p>[m[41m[m
[32m+[m[32m        <p class="txt">第二体育館</p>[m[41m[m
[32m+[m[32m        <p class="txt">購買前</p>[m[41m[m
[32m+[m[32m        <p class="txt">企画</p>[m[41m[m
[32m+[m[32m        <img class="mySlides" src="https://user-images.githubusercontent.com/38575274/44301309-a8878e00-a34f-11e8-971c-fde728bb12ba.jpg">[m[41m[m
[32m+[m[32m        <img class="mySlides" src="https://user-images.githubusercontent.com/38575274/44301310-a8878e00-a34f-11e8-8ee0-ba6ba791c3bd.jpg">[m[41m[m
[32m+[m[32m        <img class="mySlides" src="https://user-images.githubusercontent.com/38575274/44301311-a8878e00-a34f-11e8-8ce6-7328bdde6fce.jpg">[m[41m[m
[32m+[m[32m        <img class="mySlides" src="https://user-images.githubusercontent.com/38575274/44301310-a8878e00-a34f-11e8-8ee0-ba6ba791c3bd.jpg">[m[41m[m
[32m+[m[32m        <button class="w3-button w3-black w3-display-left" onclick="plusDivs(-1)">&#10094;</button>[m[41m[m
[32m+[m[32m        <button class="w3-button w3-black w3-display-right" onclick="plusDivs(1)">&#10095;</button>[m[41m[m
[32m+[m[41m    [m
[32m+[m[32m    </div> -->[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    <script>[m[41m[m
[32m+[m[32m        var slideIndex = 1;[m[41m[m
[32m+[m[32m        showDivs(slideIndex);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m        function plusDivs(n) {[m[41m[m
[32m+[m[32m        showDivs(slideIndex += n);[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[41m        [m
[32m+[m[41m[m
[32m+[m[32m        function showDivs(n) {[m[41m[m
[32m+[m[32m        var i;[m[41m[m
[32m+[m[32m        var x = document.getElementsByClassName("mySlides");[m[41m[m
[32m+[m[32m        var y = document.getElementsByClassName("txt");[m[41m[m
[32m+[m[32m        if (n > x.length) {slideIndex = 1}[m[41m    [m
[32m+[m[32m        if (n < 1) {slideIndex = x.length}[m[41m[m
[32m+[m[32m        for (i = 0; i < x.length; i++) {[m[41m[m
[32m+[m[32m            x[i].style.display = "none";[m[41m[m
[32m+[m[32m            y[i].style.display = "none";[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        x[slideIndex-1].style.display = "block";[m[41m[m
[32m+[m[32m        y[slideIndex-1].style.display = "block";[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    </script>[m[41m[m
[32m+[m[32m    <div>[m[41m[m
[32m+[m[32m   </div>[m[41m[m
[32m+[m[32m<div class="event">[m[41m[m
[32m+[m[32m    <div class="w3-content" id="skeduler-container"></div>[m[41m[m
[32m+[m[32m    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    <%- css('fancybox/jquery.skeduler') %>[m[41m[m
[32m+[m[32m    <%- js('fancybox/jquery.skeduler') %>[m[41m[m
[32m+[m[32m    <%- js('fancybox/skeduler') %>[m[41m[m
[32m+[m[32m    <%- js('fancybox/htmlpreview.min') %>[m[41m[m
[32m+[m[32m    <%- js('fancybox/jquery-2.2.4.min') %>[m[41m[m
[32m+[m[32m    </section>[m[41m[m
 </div>[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/layout/gallery.ejs b/static/themes/landscape/layout/gallery.ejs[m
[1mindex 630dbec..29326a3 100644[m
[1m--- a/static/themes/landscape/layout/gallery.ejs[m
[1m+++ b/static/themes/landscape/layout/gallery.ejs[m
[36m@@ -1,16 +1,16 @@[m
[31m-<div class="gallery">[m
[31m-    <h1>準備中...</h1>[m
[31m-</div>[m
[31m-[m
[31m-<!-- [m
[31m-<h1>gallery ejs</h1>[m
[31m-<div class="flex-images">[m
[31m-    <div class="item" data-w="200" data-h="150"><img src="/data/public/photo_club/P8060390.JPG"></div>[m
[31m-    <div class="item" data-w="250" data-h="150"><img src="/data/public/photo_club/IMGP0006.JPG"></div>[m
[31m-</div>[m
[31m-<link rel="stylesheet" type="text/css" href="/css/jquery.flex-images.css">[m
[31m-<script src="//ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>[m
[31m-<script src="/js/jquery.flex-images.min.js"></script>[m
[31m-<script type="text/javascript">[m
[31m-    $('.flex-images').flexImages({rowHeight: 140});[m
[31m-</script> -->[m
[32m+[m[32m<div class="gallery">[m[41m[m
[32m+[m[32m    <h1>準備中...</h1>[m[41m[m
[32m+[m[32m</div>[m[41m[m
[32m+[m[41m[m
[32m+[m[32m<!--[m[41m [m
[32m+[m[32m<h1>gallery ejs</h1>[m[41m[m
[32m+[m[32m<div class="flex-images">[m[41m[m
[32m+[m[32m    <div class="item" data-w="200" data-h="150"><img src="/data/public/photo_club/P8060390.JPG"></div>[m[41m[m
[32m+[m[32m    <div class="item" data-w="250" data-h="150"><img src="/data/public/photo_club/IMGP0006.JPG"></div>[m[41m[m
[32m+[m[32m</div>[m[41m[m
[32m+[m[32m<link rel="stylesheet" type="text/css" href="/css/jquery.flex-images.css">[m[41m[m
[32m+[m[32m<script src="//ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>[m[41m[m
[32m+[m[32m<script src="/js/jquery.flex-images.min.js"></script>[m[41m[m
[32m+[m[32m<script type="text/javascript">[m[41m[m
[32m+[m[32m    $('.flex-images').flexImages({rowHeight: 140});[m[41m[m
[32m+[m[32m</script> -->[m[41m[m
[1mdiff --git a/static/themes/landscape/layout/index.ejs b/static/themes/landscape/layout/index.ejs[m
[1mindex 3e6cd97..c274fe8 100644[m
[1m--- a/static/themes/landscape/layout/index.ejs[m
[1m+++ b/static/themes/landscape/layout/index.ejs[m
[36m@@ -1,227 +1,227 @@[m
[31m-<div class="slide-show">[m
[31m-    <p class="txt">くぬぎだ祭<br>10月21,22日開催</p>[m
[31m-    <p class="txt">EVENTS</p>[m
[31m-    <p class="txt">BOOTH</p>[m
[31m-    <a href="/"><img class="mySlides" src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/banner_gear_silver.png"></a>[m
[31m-    <a href="/event"><img class="mySlides" src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_event.png"></a>[m
[31m-    <a href="/mogi-shop"><img class="mySlides" src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_booth.png"></a>[m
[31m-[m
[31m-    <button class="w3-button w3-black w3-display-left" onclick="plusDivs(-1)">&#10094;</button>[m
[31m-    <button class="w3-button w3-black w3-display-right" onclick="plusDivs(1)">&#10095;</button>[m
[31m-</div>[m
[31m-[m
[31m-<script>[m
[31m-[m
[31m-    var slideIndex = 1;[m
[31m-    showDivs(slideIndex);[m
[31m-[m
[31m-    function plusDivs(n) {[m
[31m-        showDivs(slideIndex += n);[m
[31m-    }[m
[31m-    function showDivs(n) {[m
[31m-    var i;[m
[31m-    var x = document.getElementsByClassName("mySlides");[m
[31m-    var y = document.getElementsByClassName("txt");[m
[31m-    if (n > x.length) {slideIndex = 1}    [m
[31m-    if (n < 1) {slideIndex = x.length}[m
[31m-    for (i = 0; i < x.length ; i++) {[m
[31m-        x[i].style.display = "none";[m
[31m-        y[i].style.display = "none";[m
[31m-    }[m
[31m-    x[slideIndex-1].style.display = "block";[m
[31m-    y[slideIndex-1].style.display = "block"; [m
[31m-    }[m
[31m-    //get loadtime[m
[31m-    function getNow() {[m
[31m-        function to_string(d) {[m
[31m-            return (d < 10) ? '0' + d.toString() : d.toString();[m
[31m-        }[m
[31m-        var date = new Date();[m
[31m-        var now = `${to_string(date.getDay())}/${date.getHours()}:${date.getMinutes()}`[m
[31m-        console.log(now);[m
[31m-        return now;[m
[31m-    }[m
[31m-[m
[31m-    //cat future data[m
[31m-    function catData(now) {[m
[31m-        for (var i = 0; i < data.length && i < 5; i++) {[m
[31m-            if (data[i].time <= now) break;[m
[31m-        }[m
[31m-        return i;[m
[31m-    }[m
[31m-    [m
[31m-    // //sort data[m
[31m-    // data.sort(function (a, b) {[m
[31m-    //     if (a.time > b.time) {[m
[31m-    //         return -1;[m
[31m-    //     }[m
[31m-    //     if (a.time < b.time) {[m
[31m-    //         return 1;[m
[31m-    //     }[m
[31m-    //     // names must be equal[m
[31m-    //     return 0;[m
[31m-    // });[m
[31m-</script>[m
[31m-<% var data = [[m
[31m-    {[m
[31m-        "timestamp": "12:30",[m
[31m-        "date": 21,[m
[31m-        "time": "22/18:00",[m
[31m-        "start_time": "10:00",[m
[31m-        "end_time": "11:00",[m
[31m-        "place": "place",[m
[31m-        "name": "name",[m
[31m-        "from": "brassband",[m
[31m-        "content": "discription"[m
[31m-    },{[m
[31m-        "timestamp": "13:30",[m
[31m-        "date": 21,[m
[31m-        "time": "21/13:30",[m
[31m-        "start_time": "11:00",[m
[31m-        "end_time": "12:00",[m
[31m-        "place": "place2",[m
[31m-        "name": "name2",[m
[31m-        "from": "けいおん",[m
[31m-        "content": "discription"[m
[31m-    },{[m
[31m-        "timestamp": "14:30",[m
[31m-        "date": 22,[m
[31m-        "time": "22/14:30",[m
[31m-        "start_time": "10:00",[m
[31m-        "end_time": "11:00",[m
[31m-        "place": "place",[m
[31m-        "name": "name",[m
[31m-        "from": "brassband",[m
[31m-        "content": "discription"[m
[31m-    },{[m
[31m-        "timestamp": "15:30",[m
[31m-        "date": 21,[m
[31m-        "time": "21/15:30",[m
[31m-        "start_time": "11:00",[m
[31m-        "end_time": "12:00",[m
[31m-        "place": "place2",[m
[31m-        "name": "name2",[m
[31m-        "from": "けいおん",[m
[31m-        "content": "discription"[m
[31m-    },{[m
[31m-        "timestamp": "09:30",[m
[31m-        "date": 21,[m
[31m-        "time": "21/09:30",[m
[31m-        "start_time": "10:00",[m
[31m-        "end_time": "11:00",[m
[31m-        "place": "place",[m
[31m-        "name": "name",[m
[31m-        "from": "brassband",[m
[31m-        "content": "discription"[m
[31m-    },{[m
[31m-        "timestamp": "10:30",[m
[31m-        "date": 21,[m
[31m-        "time": "21/10:30",[m
[31m-        "start_time": "11:00",[m
[31m-        "end_time": "12:00",[m
[31m-        "place": "place2",[m
[31m-        "name": "name2",[m
[31m-        "from": "けいおん",[m
[31m-        "content": "discription"[m
[31m-    },{[m
[31m-        "timestamp": "19:30",[m
[31m-        "date": 21,[m
[31m-        "time": "21/19:30",[m
[31m-        "start_time": "10:00",[m
[31m-        "end_time": "11:00",[m
[31m-        "place": "place",[m
[31m-        "name": "name",[m
[31m-        "from": "brassband",[m
[31m-        "content": "discription"[m
[31m-    },{[m
[31m-        "timestamp": "08:30",[m
[31m-        "date": 21,[m
[31m-        "time": "21/08:30",[m
[31m-        "start_time": "11:00",[m
[31m-        "end_time": "12:00",[m
[31m-        "place": "place2",[m
[31m-        "name": "name2",[m
[31m-        "from": "けいおん",[m
[31m-        "content": "discription"[m
[31m-    }]%>[m
[31m-<div class="">[m
[31m-    <div class="">[m
[31m-        <% function LoadNewsTime(diff) {[m
[31m-            function to_string(d) {[m
[31m-                return (d < 10) ? '0' + d.toString() : d.toString();[m
[31m-            }[m
[31m-            var date = new Date();[m
[31m-            var loadTime = `${to_string(date.getDay())}/${date.getHours()}:${date.getMinutes()-diff}`[m
[31m-            loadTime = "22/18:00";[m
[31m-            return loadTime;[m
[31m-        }%>[m
[31m-        <div class="news">[m
[31m-            <h1>TOP NEWS</h1>[m
[31m-            <% count = 0; %>[m
[31m-            <% loadTime = LoadNewsTime(10) %>[m
[31m-            <% for (i = 0; i < data.length && count < 4 ; i+=1 ) { %>[m
[31m-                <%if( loadTime >= data[i].time ){ %>[m
[31m-                    <% count += 1; %>[m
[31m-                    <div class="post icon">[m
[31m-                        <%if( LoadNewsTime(0) <= data[i].time ){ %>[m
[31m-                            <img src="https://png.icons8.com/ios/50/ffffff/new-filled.png">[m
[31m-                        <% } %>[m
[31m-                        <a href="/event" class="title"><%= data[i].name %></a>[m
[31m-                        <div class="post-meta">[m
[31m-                            <a href="/event" class="content">[m
[31m-                                <h6><%=data[i].content%></h6>[m
[31m-                            </a>[m
[31m-                            <p class="date"><span><%= data[i].date %></span>日 <span><%= data[i].start_time %></span></p>[m
[31m-                        </div>[m
[31m-                    </div>[m
[31m-                <% } %>[m
[31m-            <% } %>[m
[31m-        </div>[m
[31m-    </div>[m
[31m-</div>[m
[31m-<div class="about">[m
[31m-    <div class="about-content w3-round-large">[m
[31m-    <h1>椚田祭とは</h1>[m
[31m-    <%- partial('about', {pagination: 2, index: true}) %>[m
[31m-    </div>[m
[31m-</div>[m
[31m-<div class="">[m
[31m-    <!-- <p>[m
[31m-        <div class="w3-third link">[m
[31m-            <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_map.png">[m
[31m-            <p>[m
[31m-                <a href="/map">Map</a>[m
[31m-            </p>[m
[31m-        </div>[m
[31m-        <div class="w3-third link">[m
[31m-            <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_about.png">[m
[31m-            <p>[m
[31m-                <a href="/gallery">Photo</a>[m
[31m-            </p>[m
[31m-        </div>[m
[31m-        <div class="w3-third link">[m
[31m-            <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_booth.png">[m
[31m-            <p>[m
[31m-                <a href="/mogi-shop">Booth</a>[m
[31m-            </p>[m
[31m-        </div>[m
[31m-    </p>[m
[31m-    <div class="w3-third link">[m
[31m-        <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_event.png">[m
[31m-        <p>[m
[31m-            <a href="/event">Event</a>[m
[31m-        </p>[m
[31m-    </div>[m
[31m-    <div class="w3-third link">[m
[31m-        <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_link.png">[m
[31m-        <p>[m
[31m-            <a href="">Link</a>[m
[31m-        </p>[m
[31m-    </div>[m
[31m-    <div class="w3-third link">[m
[31m-        <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_access.png">[m
[31m-        <p>[m
[31m-            <a href="">Access</a>[m
[31m-        </p>[m
[31m-    </div> -->[m
[31m-</div>[m
[32m+[m[32m<div class="slide-show">[m[41m[m
[32m+[m[32m    <p class="txt">くぬぎだ祭<br>10月21,22日開催</p>[m[41m[m
[32m+[m[32m    <p class="txt">EVENTS</p>[m[41m[m
[32m+[m[32m    <p class="txt">BOOTH</p>[m[41m[m
[32m+[m[32m    <a href="/"><img class="mySlides" src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/banner_gear_silver.png"></a>[m[41m[m
[32m+[m[32m    <a href="/event"><img class="mySlides" src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_event.png"></a>[m[41m[m
[32m+[m[32m    <a href="/mogi-shop"><img class="mySlides" src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_booth.png"></a>[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    <button class="w3-button w3-black w3-display-left" onclick="plusDivs(-1)">&#10094;</button>[m[41m[m
[32m+[m[32m    <button class="w3-button w3-black w3-display-right" onclick="plusDivs(1)">&#10095;</button>[m[41m[m
[32m+[m[32m</div>[m[41m[m
[32m+[m[41m[m
[32m+[m[32m<script>[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    var slideIndex = 1;[m[41m[m
[32m+[m[32m    showDivs(slideIndex);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    function plusDivs(n) {[m[41m[m
[32m+[m[32m        showDivs(slideIndex += n);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    function showDivs(n) {[m[41m[m
[32m+[m[32m    var i;[m[41m[m
[32m+[m[32m    var x = document.getElementsByClassName("mySlides");[m[41m[m
[32m+[m[32m    var y = document.getElementsByClassName("txt");[m[41m[m
[32m+[m[32m    if (n > x.length) {slideIndex = 1}[m[41m    [m
[32m+[m[32m    if (n < 1) {slideIndex = x.length}[m[41m[m
[32m+[m[32m    for (i = 0; i < x.length ; i++) {[m[41m[m
[32m+[m[32m        x[i].style.display = "none";[m[41m[m
[32m+[m[32m        y[i].style.display = "none";[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    x[slideIndex-1].style.display = "block";[m[41m[m
[32m+[m[32m    y[slideIndex-1].style.display = "block";[m[41m [m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    //get loadtime[m[41m[m
[32m+[m[32m    function getNow() {[m[41m[m
[32m+[m[32m        function to_string(d) {[m[41m[m
[32m+[m[32m            return (d < 10) ? '0' + d.toString() : d.toString();[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        var date = new Date();[m[41m[m
[32m+[m[32m        var now = `${to_string(date.getDay())}/${date.getHours()}:${date.getMinutes()}`[m[41m[m
[32m+[m[32m        console.log(now);[m[41m[m
[32m+[m[32m        return now;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    //cat future data[m[41m[m
[32m+[m[32m    function catData(now) {[m[41m[m
[32m+[m[32m        for (var i = 0; i < data.length && i < 5; i++) {[m[41m[m
[32m+[m[32m            if (data[i].time <= now) break;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        return i;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m    [m
[32m+[m[32m    // //sort data[m[41m[m
[32m+[m[32m    // data.sort(function (a, b) {[m[41m[m
[32m+[m[32m    //     if (a.time > b.time) {[m[41m[m
[32m+[m[32m    //         return -1;[m[41m[m
[32m+[m[32m    //     }[m[41m[m
[32m+[m[32m    //     if (a.time < b.time) {[m[41m[m
[32m+[m[32m    //         return 1;[m[41m[m
[32m+[m[32m    //     }[m[41m[m
[32m+[m[32m    //     // names must be equal[m[41m[m
[32m+[m[32m    //     return 0;[m[41m[m
[32m+[m[32m    // });[m[41m[m
[32m+[m[32m</script>[m[41m[m
[32m+[m[32m<% var data = [[m[41m[m
[32m+[m[32m    {[m[41m[m
[32m+[m[32m        "timestamp": "12:30",[m[41m[m
[32m+[m[32m        "date": 21,[m[41m[m
[32m+[m[32m        "time": "22/18:00",[m[41m[m
[32m+[m[32m        "start_time": "10:00",[m[41m[m
[32m+[m[32m        "end_time": "11:00",[m[41m[m
[32m+[m[32m        "place": "place",[m[41m[m
[32m+[m[32m        "name": "name",[m[41m[m
[32m+[m[32m        "from": "brassband",[m[41m[m
[32m+[m[32m        "content": "discription"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m        "timestamp": "13:30",[m[41m[m
[32m+[m[32m        "date": 21,[m[41m[m
[32m+[m[32m        "time": "21/13:30",[m[41m[m
[32m+[m[32m        "start_time": "11:00",[m[41m[m
[32m+[m[32m        "end_time": "12:00",[m[41m[m
[32m+[m[32m        "place": "place2",[m[41m[m
[32m+[m[32m        "name": "name2",[m[41m[m
[32m+[m[32m        "from": "けいおん",[m[41m[m
[32m+[m[32m        "content": "discription"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m        "timestamp": "14:30",[m[41m[m
[32m+[m[32m        "date": 22,[m[41m[m
[32m+[m[32m        "time": "22/14:30",[m[41m[m
[32m+[m[32m        "start_time": "10:00",[m[41m[m
[32m+[m[32m        "end_time": "11:00",[m[41m[m
[32m+[m[32m        "place": "place",[m[41m[m
[32m+[m[32m        "name": "name",[m[41m[m
[32m+[m[32m        "from": "brassband",[m[41m[m
[32m+[m[32m        "content": "discription"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m        "timestamp": "15:30",[m[41m[m
[32m+[m[32m        "date": 21,[m[41m[m
[32m+[m[32m        "time": "21/15:30",[m[41m[m
[32m+[m[32m        "start_time": "11:00",[m[41m[m
[32m+[m[32m        "end_time": "12:00",[m[41m[m
[32m+[m[32m        "place": "place2",[m[41m[m
[32m+[m[32m        "name": "name2",[m[41m[m
[32m+[m[32m        "from": "けいおん",[m[41m[m
[32m+[m[32m        "content": "discription"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m        "timestamp": "09:30",[m[41m[m
[32m+[m[32m        "date": 21,[m[41m[m
[32m+[m[32m        "time": "21/09:30",[m[41m[m
[32m+[m[32m        "start_time": "10:00",[m[41m[m
[32m+[m[32m        "end_time": "11:00",[m[41m[m
[32m+[m[32m        "place": "place",[m[41m[m
[32m+[m[32m        "name": "name",[m[41m[m
[32m+[m[32m        "from": "brassband",[m[41m[m
[32m+[m[32m        "content": "discription"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m        "timestamp": "10:30",[m[41m[m
[32m+[m[32m        "date": 21,[m[41m[m
[32m+[m[32m        "time": "21/10:30",[m[41m[m
[32m+[m[32m        "start_time": "11:00",[m[41m[m
[32m+[m[32m        "end_time": "12:00",[m[41m[m
[32m+[m[32m        "place": "place2",[m[41m[m
[32m+[m[32m        "name": "name2",[m[41m[m
[32m+[m[32m        "from": "けいおん",[m[41m[m
[32m+[m[32m        "content": "discription"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m        "timestamp": "19:30",[m[41m[m
[32m+[m[32m        "date": 21,[m[41m[m
[32m+[m[32m        "time": "21/19:30",[m[41m[m
[32m+[m[32m        "start_time": "10:00",[m[41m[m
[32m+[m[32m        "end_time": "11:00",[m[41m[m
[32m+[m[32m        "place": "place",[m[41m[m
[32m+[m[32m        "name": "name",[m[41m[m
[32m+[m[32m        "from": "brassband",[m[41m[m
[32m+[m[32m        "content": "discription"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m        "timestamp": "08:30",[m[41m[m
[32m+[m[32m        "date": 21,[m[41m[m
[32m+[m[32m        "time": "21/08:30",[m[41m[m
[32m+[m[32m        "start_time": "11:00",[m[41m[m
[32m+[m[32m        "end_time": "12:00",[m[41m[m
[32m+[m[32m        "place": "place2",[m[41m[m
[32m+[m[32m        "name": "name2",[m[41m[m
[32m+[m[32m        "from": "けいおん",[m[41m[m
[32m+[m[32m        "content": "discription"[m[41m[m
[32m+[m[32m    }]%>[m[41m[m
[32m+[m[32m<div class="">[m[41m[m
[32m+[m[32m    <div class="">[m[41m[m
[32m+[m[32m        <% function LoadNewsTime(diff) {[m[41m[m
[32m+[m[32m            function to_string(d) {[m[41m[m
[32m+[m[32m                return (d < 10) ? '0' + d.toString() : d.toString();[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m            var date = new Date();[m[41m[m
[32m+[m[32m            var loadTime = `${to_string(date.getDay())}/${date.getHours()}:${date.getMinutes()-diff}`[m[41m[m
[32m+[m[32m            loadTime = "22/18:00";[m[41m[m
[32m+[m[32m            return loadTime;[m[41m[m
[32m+[m[32m        }%>[m[41m[m
[32m+[m[32m        <div class="news">[m[41m[m
[32m+[m[32m            <h1>TOP NEWS</h1>[m[41m[m
[32m+[m[32m            <% count = 0; %>[m[41m[m
[32m+[m[32m            <% loadTime = LoadNewsTime(10) %>[m[41m[m
[32m+[m[32m            <% for (i = 0; i < data.length && count < 4 ; i+=1 ) { %>[m[41m[m
[32m+[m[32m                <%if( loadTime >= data[i].time ){ %>[m[41m[m
[32m+[m[32m                    <% count += 1; %>[m[41m[m
[32m+[m[32m                    <div class="post icon">[m[41m[m
[32m+[m[32m                        <%if( LoadNewsTime(0) <= data[i].time ){ %>[m[41m[m
[32m+[m[32m                            <img src="https://png.icons8.com/ios/50/ffffff/new-filled.png">[m[41m[m
[32m+[m[32m                        <% } %>[m[41m[m
[32m+[m[32m                        <a href="/event" class="title"><%= data[i].name %></a>[m[41m[m
[32m+[m[32m                        <div class="post-meta">[m[41m[m
[32m+[m[32m                            <a href="/event" class="content">[m[41m[m
[32m+[m[32m                                <h6><%=data[i].content%></h6>[m[41m[m
[32m+[m[32m                            </a>[m[41m[m
[32m+[m[32m                            <p class="date"><span><%= data[i].date %></span>日 <span><%= data[i].start_time %></span></p>[m[41m[m
[32m+[m[32m                        </div>[m[41m[m
[32m+[m[32m                    </div>[m[41m[m
[32m+[m[32m                <% } %>[m[41m[m
[32m+[m[32m            <% } %>[m[41m[m
[32m+[m[32m        </div>[m[41m[m
[32m+[m[32m    </div>[m[41m[m
[32m+[m[32m</div>[m[41m[m
[32m+[m[32m<div class="about">[m[41m[m
[32m+[m[32m    <div class="about-content w3-round-large">[m[41m[m
[32m+[m[32m    <h1>椚田祭とは</h1>[m[41m[m
[32m+[m[32m    <%- partial('about', {pagination: 2, index: true}) %>[m[41m[m
[32m+[m[32m    </div>[m[41m[m
[32m+[m[32m</div>[m[41m[m
[32m+[m[32m<div class="">[m[41m[m
[32m+[m[32m    <!-- <p>[m[41m[m
[32m+[m[32m        <div class="w3-third link">[m[41m[m
[32m+[m[32m            <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_map.png">[m[41m[m
[32m+[m[32m            <p>[m[41m[m
[32m+[m[32m                <a href="/map">Map</a>[m[41m[m
[32m+[m[32m            </p>[m[41m[m
[32m+[m[32m        </div>[m[41m[m
[32m+[m[32m        <div class="w3-third link">[m[41m[m
[32m+[m[32m            <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_about.png">[m[41m[m
[32m+[m[32m            <p>[m[41m[m
[32m+[m[32m                <a href="/gallery">Photo</a>[m[41m[m
[32m+[m[32m            </p>[m[41m[m
[32m+[m[32m        </div>[m[41m[m
[32m+[m[32m        <div class="w3-third link">[m[41m[m
[32m+[m[32m            <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_booth.png">[m[41m[m
[32m+[m[32m            <p>[m[41m[m
[32m+[m[32m                <a href="/mogi-shop">Booth</a>[m[41m[m
[32m+[m[32m            </p>[m[41m[m
[32m+[m[32m        </div>[m[41m[m
[32m+[m[32m    </p>[m[41m[m
[32m+[m[32m    <div class="w3-third link">[m[41m[m
[32m+[m[32m        <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_event.png">[m[41m[m
[32m+[m[32m        <p>[m[41m[m
[32m+[m[32m            <a href="/event">Event</a>[m[41m[m
[32m+[m[32m        </p>[m[41m[m
[32m+[m[32m    </div>[m[41m[m
[32m+[m[32m    <div class="w3-third link">[m[41m[m
[32m+[m[32m        <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_link.png">[m[41m[m
[32m+[m[32m        <p>[m[41m[m
[32m+[m[32m            <a href="">Link</a>[m[41m[m
[32m+[m[32m        </p>[m[41m[m
[32m+[m[32m    </div>[m[41m[m
[32m+[m[32m    <div class="w3-third link">[m[41m[m
[32m+[m[32m        <img src="https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/icon_access.png">[m[41m[m
[32m+[m[32m        <p>[m[41m[m
[32m+[m[32m            <a href="">Access</a>[m[41m[m
[32m+[m[32m        </p>[m[41m[m
[32m+[m[32m    </div> -->[m[41m[m
[32m+[m[32m</div>[m[41m[m
[1mdiff --git a/static/themes/landscape/layout/lineat.ejs b/static/themes/landscape/layout/lineat.ejs[m
[1mindex 04557a3..fcd93b8 100644[m
[1m--- a/static/themes/landscape/layout/lineat.ejs[m
[1m+++ b/static/themes/landscape/layout/lineat.ejs[m
[36m@@ -1,9 +1,17 @@[m
[31m-<script src="/js/lineat.js" ></script>[m
[31m-<div class="w3-content line_bot">[m
[31m-    <p id = "mapinfo"></p>[m
[31m-    <p id = "thisinfo">LINE@登録用サイト[工事中]<br></p>[m
[31m-    @developers 開発中のため登録は控えて下さい。<br>[m
[31m-    QRコード<br>[m
[31m-    <img src="http://qr-official.line.me/L/0o4Bcz38gq.png"><br>[m
[31m-    <a href="https://line.me/R/ti/p/%40wey0128f"><img height="36" border="0" alt="友だち追加" src="https://scdn.line-apps.com/n/line_add_friends/btn/ja.png"></a><br>[m
[32m+[m[32m<style>[m[41m[m
[32m+[m[32m    @media (max-width: 500px){[m[41m[m
[32m+[m[32m        img{[m[41m[m
[32m+[m[32m            width : 80%;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m</style>[m[41m[m
[32m+[m[41m[m
[32m+[m[32m<script src="/js/lineat.js" ></script>[m[41m[m
[32m+[m[32m<div class="w3-content line_bot">[m[41m[m
[32m+[m[32m    <p id = "mapinfo"></p>[m[41m[m
[32m+[m[32m    <p id = "thisinfo">LINE@登録用サイト[工事中]<br></p>[m[41m[m
[32m+[m[32m    @developers 開発中のため登録は控えて下さい。<br>[m[41m[m
[32m+[m[32m    QRコード<br>[m[41m[m
[32m+[m[32m    <img src="http://qr-official.line.me/L/0o4Bcz38gq.png"><br>[m[41m[m
[32m+[m[32m    <a href="https://line.me/R/ti/p/%40wey0128f"><img height="36" border="0" alt="友だち追加" src="https://scdn.line-apps.com/n/line_add_friends/btn/ja.png"></a><br>[m[41m[m
 </div>[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/layout/link.ejs b/static/themes/landscape/layout/link.ejs[m
[1mindex 4c74594..47d42a1 100644[m
[1m--- a/static/themes/landscape/layout/link.ejs[m
[1m+++ b/static/themes/landscape/layout/link.ejs[m
[36m@@ -1,8 +1,8 @@[m
[31m-<section id="event">[m
[31m-    <div class="link-table">[m
[31m-        <h1>リンク</h1>[m
[31m-        <p><a href="https://www.tokyo-ct.ac.jp/">東京高専公式HP</a></p>[m
[31m-        <p><a href="https://tokyo-ct-s.jp/">東京高専後援会</a></p>[m
[31m-        <p><a href="">東京高専twitter</a></p>[m
[31m-    </div>[m
[32m+[m[32m<section id="event">[m[41m[m
[32m+[m[32m    <div class="link-table">[m[41m[m
[32m+[m[32m        <h1>リンク</h1>[m[41m[m
[32m+[m[32m        <p><a href="https://www.tokyo-ct.ac.jp/">東京高専公式HP</a></p>[m[41m[m
[32m+[m[32m        <p><a href="https://tokyo-ct-s.jp/">東京高専後援会</a></p>[m[41m[m
[32m+[m[32m        <p><a href="">東京高専twitter</a></p>[m[41m[m
[32m+[m[32m    </div>[m[41m[m
 </section>[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/layout/map.ejs b/static/themes/landscape/layout/map.ejs[m
[1mindex ef5d8be..c3f3c0e 100644[m
[1m--- a/static/themes/landscape/layout/map.ejs[m
[1m+++ b/static/themes/landscape/layout/map.ejs[m
[36m@@ -1,29 +1,29 @@[m
[31m-<style>[m
[31m-html,body {[m
[31m-	margin: 0;[m
[31m-	overflow: scroll;[m
[31m-	width: 100%;[m
[31m-	height:100%;[m
[31m-}[m
[31m-[m
[31m-[m
[31m-#myCanvas {[m
[31m-	width: 100%;[m
[31m-	/* height : 100%; */[m
[31m-}[m
[31m-[m
[31m-/*[m
[31m-#canvas{[m
[31m-	display : block;[m
[31m-	justify-content: center;[m
[31m-	align-items: center;[m
[31m-}[m
[31m-*/[m
[31m-</style>[m
[31m-<canvas id = "myCanvas"> </canvas>[m
[31m-<script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>[m
[31m-<script src="/js/map.js" ></script>[m
[31m-<h1 id = "info">info</h1>[m
[31m-<p id = "pin">pinID</p>[m
[31m-<p id = "boothdata">shopdata</p>[m
[31m-<p id = "price">price</p>[m
[32m+[m[32m<style>[m[41m[m
[32m+[m[32mhtml,body {[m[41m[m
[32m+[m	[32mmargin: 0;[m[41m[m
[32m+[m	[32moverflow: scroll;[m[41m[m
[32m+[m	[32mwidth: 100%;[m[41m[m
[32m+[m	[32mheight:100%;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#myCanvas {[m[41m[m
[32m+[m	[32mwidth: 100%;[m[41m[m
[32m+[m	[32m/* height : 100%; */[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/*[m[41m[m
[32m+[m[32m#canvas{[m[41m[m
[32m+[m	[32mdisplay : block;[m[41m[m
[32m+[m	[32mjustify-content: center;[m[41m[m
[32m+[m	[32malign-items: center;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[32m*/[m[41m[m
[32m+[m[32m</style>[m[41m[m
[32m+[m[32m<canvas id = "myCanvas"> </canvas>[m[41m[m
[32m+[m[32m<script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>[m[41m[m
[32m+[m[32m<script src="/js/map.js" ></script>[m[41m[m
[32m+[m[32m<h1 id = "info">info</h1>[m[41m[m
[32m+[m[32m<p id = "pin">pinID</p>[m[41m[m
[32m+[m[32m<p id = "boothdata">shopdata</p>[m[41m[m
[32m+[m[32m<p id = "price">price</p>[m[41m[m
[1mdiff --git a/static/themes/landscape/layout/mogi-shop.ejs b/static/themes/landscape/layout/mogi-shop.ejs[m
[1mindex 28b46e9..04df2dd 100644[m
[1m--- a/static/themes/landscape/layout/mogi-shop.ejs[m
[1m+++ b/static/themes/landscape/layout/mogi-shop.ejs[m
[36m@@ -1,304 +1,304 @@[m
[31m-<section id="mogi-shop">[m
[31m-    <header>[m
[31m-[m
[31m-    </header>[m
[31m-[m
[31m-    <% var data ={[m
[31m-        "c4J": {[m
[31m-            "goods": [[m
[31m-              {[m
[31m-                "name": "チョコ",[m
[31m-                "price": "3456"[m
[31m-              },[m
[31m-              {[m
[31m-                "name": "ちょこばなな",[m
[31m-                "price": "400"[m
[31m-              }[m
[31m-            ],[m
[31m-            "image": [[m
[31m-              "dispImage_cache.jpg"[m
[31m-            ],[m
[31m-            "label": [[m
[31m-              "0",[m
[31m-              "2",[m
[31m-              "6"[m
[31m-            ],[m
[31m-            "tstamp": "1539235736.000100",[m
[31m-            "shopname": "ちょこ"[m
[31m-          },[m
[31m-        "c4D": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "c2C": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "fs": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "pg": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "htb": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "vb": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "v5D": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "abd": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "v3D": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "c4M": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "tnf": {[m
[31m-          "goods": [[m
[31m-            {[m
[31m-              "name": "フランクフルト",[m
[31m-              "price": "100"[m
[31m-            }[m
[31m-          ],[m
[31m-          "image": [],[m
[31m-          "label": [[m
[31m-            "0",[m
[31m-            "2"[m
[31m-          ],[m
[31m-          "tstamp": "1539236221.000100",[m
[31m-          "shopname": "フランクフルト"[m
[31m-        },[m
[31m-        "tea": {[m
[31m-          "goods": [[m
[31m-            {[m
[31m-              "name": "お抹茶(お菓子付き)",[m
[31m-              "price": "300"[m
[31m-            }[m
[31m-          ],[m
[31m-          "image": [],[m
[31m-          "label": [[m
[31m-            "1",[m
[31m-            "2",[m
[31m-            "3",[m
[31m-            "4",[m
[31m-            "6",[m
[31m-            "8",[m
[31m-            "11"[m
[31m-          ],[m
[31m-          "tstamp": "1539229782.000200"[m
[31m-        },[m
[31m-        "v5C": {[m
[31m-          "goods": [[m
[31m-            {[m
[31m-              "name": "炒飯",[m
[31m-              "price": "300"[m
[31m-            }[m
[31m-          ],[m
[31m-          "image": [],[m
[31m-          "label": [[m
[31m-            "0",[m
[31m-            "3",[m
[31m-            "6"[m
[31m-          ],[m
[31m-          "tstamp": "1539228746.000100",[m
[31m-          "shopname": "RiceStyle"[m
[31m-        },[m
[31m-        "v14": {[m
[31m-          "goods": [[m
[31m-            {[m
[31m-              "name": "バトルドーム",[m
[31m-              "price": "50"[m
[31m-            },[m
[31m-            {[m
[31m-              "name": "ビーダマン",[m
[31m-              "price": "50"[m
[31m-            },[m
[31m-            {[m
[31m-              "name": "ベーブレード",[m
[31m-              "price": "50"[m
[31m-            }[m
[31m-          ],[m
[31m-          "image": [],[m
[31m-          "label": [[m
[31m-            "1",[m
[31m-            "1",[m
[31m-            "1"[m
[31m-          ],[m
[31m-          "tstamp": "1539229207.000100",[m
[31m-          "shopname": "超エキサイティンッ!"[m
[31m-        },[m
[31m-        "kusa": {[m
[31m-          "goods": [],[m
[31m-          "image": [],[m
[31m-          "label": [][m
[31m-        },[m
[31m-        "v4E": {[m
[31m-          "goods": [[m
[31m-            {[m
[31m-              "name": "だんご3本詰合せ",[m
[31m-              "price": "200"[m
[31m-            }[m
[31m-          ],[m
[31m-          "image": [],[m
[31m-          "label": [],[m
[31m-          "tstamp": "1539229425.000100"[m
[31m-        },[m
[31m-        "cyc": {[m
[31m-          "goods": [[m
[31m-            {[m
[31m-              "name": "今川焼",[m
[31m-              "price": "150"[m
[31m-            }[m
[31m-          ],[m
[31m-          "image": [],[m
[31m-          "label": [[m
[31m-            "2",[m
[31m-            "4",[m
[31m-            "6"[m
[31m-          ],[m
[31m-          "tstamp": "1539229653.000100"[m
[31m-        },[m
[31m-        "v2M": {[m
[31m-          "goods": [[m
[31m-            {[m
[31m-              "name": "たこ焼き",[m
[31m-              "price": "300"[m
[31m-            }[m
[31m-          ],[m
[31m-          "image": [],[m
[31m-          "label": [[m
[31m-            "2",[m
[31m-            "4",[m
[31m-            "7"[m
[31m-          ],[m
[31m-          "tstamp": "1539237550.000100",[m
[31m-          "shopname": "たこ焼き覇世神"[m
[31m-        },[m
[31m-        "hl": {[m
[31m-          "shopname": "タピオカ",[m
[31m-          "goods": [[m
[31m-            {[m
[31m-              "name": "タピオカミルクティー",[m
[31m-              "price": "200"[m
[31m-            },[m
[31m-            {[m
[31m-              "name": "タピオカカルピス",[m
[31m-              "price": "200"[m
[31m-            }[m
[31m-          ],[m
[31m-          "image": [],[m
[31m-          "label": [[m
[31m-            "0",[m
[31m-            "3",[m
[31m-            "8"[m
[31m-          ],[m
[31m-          "tstamp": "1539238129.000200"[m
[31m-        },[m
[31m-        "v2AS": {[m
[31m-          "shopname": "チヂミ屋さん",[m
[31m-          "goods": [[m
[31m-            {[m
[31m-              "name": "チヂミ",[m
[31m-              "price": "200"[m
[31m-            },[m
[31m-            {[m
[31m-              "name": "チーズ",[m
[31m-              "price": "50"[m
[31m-            },[m
[31m-            {[m
[31m-              "name": "キムチ",[m
[31m-              "price": "50"[m
[31m-            }[m
[31m-          ],[m
[31m-          "image": [[m
[31m-            "iOS の画像"[m
[31m-          ],[m
[31m-          "label": [[m
[31m-            "0",[m
[31m-            "2",[m
[31m-            "4",[m
[31m-            "7"[m
[31m-          ],[m
[31m-          "tstamp": "1539236968.000100"[m
[31m-        }[m
[31m-      }%>[m
[31m-    <input class="w3-input w3-border w3-padding" type="text" placeholder="Search for names.." id="search_shop_input"[m
[31m-        onkeyup="search_shop()">[m
[31m-    <!-- <iframe src=""></iframe> -->[m
[31m-    <% for(let id in data) {%>[m
[31m-        <% if( data[id].goods.length ){ %>[m
[31m-        <div class="shop">[m
[31m-            <!-- <% if( data[id].image.length ){ %>[m
[31m-                <img src="https://kunugida2018.tokyo-ct.ac.jp/data/<%=data[id].shopname %>/<%=data[id].image[0] %>">[m
[31m-            <% }else{ %>[m
[31m-                <img src="https://user-images.githubusercontent.com/38575274/46793140-f7660880-cd7f-11e8-9e1c-773c09a992c5.png">[m
[31m-            <% } %> -->[m
[31m-            <img src="https://user-images.githubusercontent.com/38575274/46794332-925fe200-cd82-11e8-83ce-c614b7235a7a.png">[m
[31m-            <table class="" id="search_shop_table">[m
[31m-                <p>[m
[31m-                    <%= data[id].shopname %>[m
[31m-                    <a class="icon" href="/map?booth=<%= id %>">[m
[31m-                        <img src="https://png.icons8.com/color/50/000000/marker.png">地図を表示[m
[31m-                    </a>[m
[31m-                </p>[m
[31m-                <tr>[m
[31m-                    <th></th>[m
[31m-                    <th></th>[m
[31m-                </tr>[m
[31m-                <%  for( var i=0 ; i < data[id].goods.length ; i+=1 ) { %>[m
[31m-                <tr>[m
[31m-                    <td>[m
[31m-                        <%= data[id].goods[i].name %>[m
[31m-                    </td>[m
[31m-                    <td>[m
[31m-                        <%= data[id].goods[i].price %>円</td>[m
[31m-                </tr>[m
[31m-                <% }; %>[m
[31m-            </table>[m
[31m-        </div>[m
[31m-        <% } %>[m
[31m-    <% } %>[m
[31m-[m
[31m-    <script>[m
[31m-        function search_shop() {[m
[31m-            var input, filter, table, tr, td, i;[m
[31m-            input = document.getElementById("search_shop_input");[m
[31m-            filter = input.value.toUpperCase();[m
[31m-            table = document.getElementById("search_shop_table");[m
[31m-            tr = table.getElementsByTagName("tr");[m
[31m-            for (i = 0; i < tr.length; i++) {[m
[31m-                td = tr[i].getElementsByTagName("td")[0];[m
[31m-                if (td) {[m
[31m-                    if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {[m
[31m-                        tr[i].style.display = "";[m
[31m-                    } else {[m
[31m-                        tr[i].style.display = "none";[m
[31m-                    }[m
[31m-                }[m
[31m-            }[m
[31m-        }[m
[31m-    </script>[m
[32m+[m[32m<section id="mogi-shop">[m[41m[m
[32m+[m[32m    <header>[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    </header>[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    <% var data ={[m[41m[m
[32m+[m[32m        "c4J": {[m[41m[m
[32m+[m[32m            "goods": [[m[41m[m
[32m+[m[32m              {[m[41m[m
[32m+[m[32m                "name": "チョコ",[m[41m[m
[32m+[m[32m                "price": "3456"[m[41m[m
[32m+[m[32m              },[m[41m[m
[32m+[m[32m              {[m[41m[m
[32m+[m[32m                "name": "ちょこばなな",[m[41m[m
[32m+[m[32m                "price": "400"[m[41m[m
[32m+[m[32m              }[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            "image": [[m[41m[m
[32m+[m[32m              "dispImage_cache.jpg"[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            "label": [[m[41m[m
[32m+[m[32m              "0",[m[41m[m
[32m+[m[32m              "2",[m[41m[m
[32m+[m[32m              "6"[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            "tstamp": "1539235736.000100",[m[41m[m
[32m+[m[32m            "shopname": "ちょこ"[m[41m[m
[32m+[m[32m          },[m[41m[m
[32m+[m[32m        "c4D": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "c2C": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "fs": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "pg": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "htb": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "vb": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "v5D": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "abd": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "v3D": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "c4M": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "tnf": {[m[41m[m
[32m+[m[32m          "goods": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "フランクフルト",[m[41m[m
[32m+[m[32m              "price": "100"[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [[m[41m[m
[32m+[m[32m            "0",[m[41m[m
[32m+[m[32m            "2"[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "tstamp": "1539236221.000100",[m[41m[m
[32m+[m[32m          "shopname": "フランクフルト"[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "tea": {[m[41m[m
[32m+[m[32m          "goods": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "お抹茶(お菓子付き)",[m[41m[m
[32m+[m[32m              "price": "300"[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [[m[41m[m
[32m+[m[32m            "1",[m[41m[m
[32m+[m[32m            "2",[m[41m[m
[32m+[m[32m            "3",[m[41m[m
[32m+[m[32m            "4",[m[41m[m
[32m+[m[32m            "6",[m[41m[m
[32m+[m[32m            "8",[m[41m[m
[32m+[m[32m            "11"[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "tstamp": "1539229782.000200"[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "v5C": {[m[41m[m
[32m+[m[32m          "goods": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "炒飯",[m[41m[m
[32m+[m[32m              "price": "300"[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [[m[41m[m
[32m+[m[32m            "0",[m[41m[m
[32m+[m[32m            "3",[m[41m[m
[32m+[m[32m            "6"[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "tstamp": "1539228746.000100",[m[41m[m
[32m+[m[32m          "shopname": "RiceStyle"[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "v14": {[m[41m[m
[32m+[m[32m          "goods": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "バトルドーム",[m[41m[m
[32m+[m[32m              "price": "50"[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "ビーダマン",[m[41m[m
[32m+[m[32m              "price": "50"[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "ベーブレード",[m[41m[m
[32m+[m[32m              "price": "50"[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [[m[41m[m
[32m+[m[32m            "1",[m[41m[m
[32m+[m[32m            "1",[m[41m[m
[32m+[m[32m            "1"[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "tstamp": "1539229207.000100",[m[41m[m
[32m+[m[32m          "shopname": "超エキサイティンッ!"[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "kusa": {[m[41m[m
[32m+[m[32m          "goods": [],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [][m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "v4E": {[m[41m[m
[32m+[m[32m          "goods": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "だんご3本詰合せ",[m[41m[m
[32m+[m[32m              "price": "200"[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [],[m[41m[m
[32m+[m[32m          "tstamp": "1539229425.000100"[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "cyc": {[m[41m[m
[32m+[m[32m          "goods": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "今川焼",[m[41m[m
[32m+[m[32m              "price": "150"[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [[m[41m[m
[32m+[m[32m            "2",[m[41m[m
[32m+[m[32m            "4",[m[41m[m
[32m+[m[32m            "6"[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "tstamp": "1539229653.000100"[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "v2M": {[m[41m[m
[32m+[m[32m          "goods": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "たこ焼き",[m[41m[m
[32m+[m[32m              "price": "300"[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [[m[41m[m
[32m+[m[32m            "2",[m[41m[m
[32m+[m[32m            "4",[m[41m[m
[32m+[m[32m            "7"[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "tstamp": "1539237550.000100",[m[41m[m
[32m+[m[32m          "shopname": "たこ焼き覇世神"[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "hl": {[m[41m[m
[32m+[m[32m          "shopname": "タピオカ",[m[41m[m
[32m+[m[32m          "goods": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "タピオカミルクティー",[m[41m[m
[32m+[m[32m              "price": "200"[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "タピオカカルピス",[m[41m[m
[32m+[m[32m              "price": "200"[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "image": [],[m[41m[m
[32m+[m[32m          "label": [[m[41m[m
[32m+[m[32m            "0",[m[41m[m
[32m+[m[32m            "3",[m[41m[m
[32m+[m[32m            "8"[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "tstamp": "1539238129.000200"[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        "v2AS": {[m[41m[m
[32m+[m[32m          "shopname": "チヂミ屋さん",[m[41m[m
[32m+[m[32m          "goods": [[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "チヂミ",[m[41m[m
[32m+[m[32m              "price": "200"[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "チーズ",[m[41m[m
[32m+[m[32m              "price": "50"[m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m              "name": "キムチ",[m[41m[m
[32m+[m[32m              "price": "50"[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "image": [[m[41m[m
[32m+[m[32m            "iOS の画像"[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "label": [[m[41m[m
[32m+[m[32m            "0",[m[41m[m
[32m+[m[32m            "2",[m[41m[m
[32m+[m[32m            "4",[m[41m[m
[32m+[m[32m            "7"[m[41m[m
[32m+[m[32m          ],[m[41m[m
[32m+[m[32m          "tstamp": "1539236968.000100"[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }%>[m[41m[m
[32m+[m[32m    <input class="w3-input w3-border w3-padding" type="text" placeholder="Search for names.." id="search_shop_input"[m[41m[m
[32m+[m[32m        onkeyup="search_shop()">[m[41m[m
[32m+[m[32m    <!-- <iframe src=""></iframe> -->[m[41m[m
[32m+[m[32m    <% for(let id in data) {%>[m[41m[m
[32m+[m[32m        <% if( data[id].goods.length ){ %>[m[41m[m
[32m+[m[32m        <div class="shop">[m[41m[m
[32m+[m[32m            <!-- <% if( data[id].image.length ){ %>[m[41m[m
[32m+[m[32m                <img src="https://kunugida2018.tokyo-ct.ac.jp/data/<%=data[id].shopname %>/<%=data[id].image[0] %>">[m[41m[m
[32m+[m[32m            <% }else{ %>[m[41m[m
[32m+[m[32m                <img src="https://user-images.githubusercontent.com/38575274/46793140-f7660880-cd7f-11e8-9e1c-773c09a992c5.png">[m[41m[m
[32m+[m[32m            <% } %> -->[m[41m[m
[32m+[m[32m            <img src="https://user-images.githubusercontent.com/38575274/46794332-925fe200-cd82-11e8-83ce-c614b7235a7a.png">[m[41m[m
[32m+[m[32m            <table class="" id="search_shop_table">[m[41m[m
[32m+[m[32m                <p>[m[41m[m
[32m+[m[32m                    <%= data[id].shopname %>[m[41m[m
[32m+[m[32m                    <a class="icon" href="/map?booth=<%= id %>">[m[41m[m
[32m+[m[32m                        <img src="https://png.icons8.com/color/50/000000/marker.png">地図を表示[m[41m[m
[32m+[m[32m                    </a>[m[41m[m
[32m+[m[32m                </p>[m[41m[m
[32m+[m[32m                <tr>[m[41m[m
[32m+[m[32m                    <th></th>[m[41m[m
[32m+[m[32m                    <th></th>[m[41m[m
[32m+[m[32m                </tr>[m[41m[m
[32m+[m[32m                <%  for( var i=0 ; i < data[id].goods.length ; i+=1 ) { %>[m[41m[m
[32m+[m[32m                <tr>[m[41m[m
[32m+[m[32m                    <td>[m[41m[m
[32m+[m[32m                        <%= data[id].goods[i].name %>[m[41m[m
[32m+[m[32m                    </td>[m[41m[m
[32m+[m[32m                    <td>[m[41m[m
[32m+[m[32m                        <%= data[id].goods[i].price %>円</td>[m[41m[m
[32m+[m[32m                </tr>[m[41m[m
[32m+[m[32m                <% }; %>[m[41m[m
[32m+[m[32m            </table>[m[41m[m
[32m+[m[32m        </div>[m[41m[m
[32m+[m[32m        <% } %>[m[41m[m
[32m+[m[32m    <% } %>[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    <script>[m[41m[m
[32m+[m[32m        function search_shop() {[m[41m[m
[32m+[m[32m            var input, filter, table, tr, td, i;[m[41m[m
[32m+[m[32m            input = document.getElementById("search_shop_input");[m[41m[m
[32m+[m[32m            filter = input.value.toUpperCase();[m[41m[m
[32m+[m[32m            table = document.getElementById("search_shop_table");[m[41m[m
[32m+[m[32m            tr = table.getElementsByTagName("tr");[m[41m[m
[32m+[m[32m            for (i = 0; i < tr.length; i++) {[m[41m[m
[32m+[m[32m                td = tr[i].getElementsByTagName("td")[0];[m[41m[m
[32m+[m[32m                if (td) {[m[41m[m
[32m+[m[32m                    if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {[m[41m[m
[32m+[m[32m                        tr[i].style.display = "";[m[41m[m
[32m+[m[32m                    } else {[m[41m[m
[32m+[m[32m                        tr[i].style.display = "none";[m[41m[m
[32m+[m[32m                    }[m[41m[m
[32m+[m[32m                }[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    </script>[m[41m[m
 </section>[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/css/_partial/header.styl b/static/themes/landscape/source/css/_partial/header.styl[m
[1mindex 0889856..6d1810e 100644[m
[1m--- a/static/themes/landscape/source/css/_partial/header.styl[m
[1m+++ b/static/themes/landscape/source/css/_partial/header.styl[m
[36m@@ -1,168 +1,168 @@[m
[31m-#header[m
[31m-  height: banner-height[m
[31m-  position: relative[m
[31m-  border-bottom: 1px solid color-border[m
[31m-  &:before, &:after[m
[31m-    content: ""[m
[31m-    position: absolute[m
[31m-    left: 0[m
[31m-    right: 0[m
[31m-    height: 40px[m
[31m-  &:before[m
[31m-    top: 0[m
[31m-    background: linear-gradient(rgba(0, 0, 0, 0.2), transparent)[m
[31m-  &:after[m
[31m-    bottom: 0[m
[31m-    background: linear-gradient(transparent, rgba(0, 0, 0, 0.2))[m
[31m-[m
[31m-#header-outer[m
[31m-  height: 100%[m
[31m-  position: relative[m
[31m-[m
[31m-#header-inner[m
[31m-  background: rgba(0, 0, 0, 0)[m
[31m-  position: relative[m
[31m-  overflow: hidden[m
[31m-[m
[31m-#banner[m
[31m-  position: absolute[m
[31m-  top: 0[m
[31m-  left: 0[m
[31m-  width: 100%[m
[31m-  height: 100%[m
[31m-  background: url(banner-url) center #000[m
[31m-  background-size: cover[m
[31m-  z-index: -1[m
[31m-[m
[31m-#header-title[m
[31m-  text-align: center[m
[31m-  height: logo-size[m
[31m-  position: absolute[m
[31m-  top: 50%[m
[31m-  left: 0[m
[31m-  margin-top: logo-size * -0.5[m
[31m-[m
[31m-$logo-text[m
[31m-  text-decoration: none[m
[31m-  color: #fff[m
[31m-  font-weight: 300[m
[31m-  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.3)[m
[31m-[m
[31m-#logo[m
[31m-  @extend $logo-text[m
[31m-  font-size: logo-size[m
[31m-  line-height: logo-size[m
[31m-  letter-spacing: 2px[m
[31m-[m
[31m-#subtitle[m
[31m-  @extend $logo-text[m
[31m-  font-size: subtitle-size[m
[31m-  line-height: subtitle-size[m
[31m-  letter-spacing: 1px[m
[31m-[m
[31m-#subtitle-wrap[m
[31m-  margin-top: subtitle-size[m
[31m-[m
[31m-#main-nav[m
[31m-  float: left[m
[31m-  margin-left: -15px[m
[31m-[m
[31m-$nav-link[m
[31m-  float: left[m
[31m-  color: #fbf9e2[m
[31m-  opacity: 0.6[m
[31m-  text-decoration: none[m
[31m-  text-shadow: 0 1px rgba(0, 0, 0, 0.2)[m
[31m-  transition: opacity 0.2s[m
[31m-  display: block[m
[31m-  padding: 20px 15px[m
[31m-  &:hover[m
[31m-    opacity: 1[m
[31m-    color: #e99130[m
[31m-[m
[31m-.nav-icon[m
[31m-  @extend $nav-link[m
[31m-  font-family: font-icon[m
[31m-  text-align: center[m
[31m-  font-size: font-size[m
[31m-  width: font-size[m
[31m-  height: font-size[m
[31m-  padding: 20px 15px[m
[31m-  position: relative[m
[31m-  cursor: pointer[m
[31m-[m
[31m-.main-nav-link[m
[31m-  @extend $nav-link[m
[31m-  font-weight: 400[m
[31m-  letter-spacing: 1px[m
[31m-  @media mq-mobile[m
[31m-    display: none[m
[31m-[m
[31m-#main-nav-toggle[m
[31m-  display: none[m
[31m-  &:before[m
[31m-    content: "\f0c9"[m
[31m-  @media mq-mobile[m
[31m-    display: block[m
[31m-[m
[31m-#sub-nav[m
[31m-  float: right[m
[31m-  margin-top: 10px[m
[31m-  margin-right: 10px[m
[31m-[m
[31m-#nav-rss-link[m
[31m-  &:before[m
[31m-    content: "\f09e"[m
[31m-[m
[31m-#nav-search-btn[m
[31m-  &:before[m
[31m-    content: "\f002"[m
[31m-[m
[31m-#search-form-wrap[m
[31m-  position: absolute[m
[31m-  top: 15px[m
[31m-  width: 150px[m
[31m-  height: 30px[m
[31m-  right: -150px[m
[31m-  opacity: 0[m
[31m-  transition: 0.2s ease-out[m
[31m-  &.on[m
[31m-    opacity: 1[m
[31m-    right: 0[m
[31m-  @media mq-mobile[m
[31m-    width: 100%[m
[31m-    right: -100%[m
[31m-[m
[31m-.search-form[m
[31m-  position: absolute[m
[31m-  top: 0[m
[31m-  left: 0[m
[31m-  right: 0[m
[31m-  background: #fff[m
[31m-  padding: 5px 15px[m
[31m-  border-radius: 15px[m
[31m-  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3)[m
[31m-[m
[31m-.search-form-input[m
[31m-  border: none[m
[31m-  background: none[m
[31m-  color: color-default[m
[31m-  width: 100%[m
[31m-  font: 13px font-sans[m
[31m-  outline: none[m
[31m-  &::-webkit-search-results-decoration[m
[31m-  &::-webkit-search-cancel-button[m
[31m-    -webkit-appearance: none[m
[31m-[m
[31m-.search-form-submit[m
[31m-  position: absolute[m
[31m-  top: 50%[m
[31m-  right: 10px[m
[31m-  margin-top: -7px[m
[31m-  font: 13px font-icon[m
[31m-  border: none[m
[31m-  background: none[m
[31m-  color: #bbb[m
[31m-  cursor: pointer[m
[31m-  &:hover, &:focus[m
[32m+[m[32m#header[m[41m[m
[32m+[m[32m  height: banner-height[m[41m[m
[32m+[m[32m  position: relative[m[41m[m
[32m+[m[32m  border-bottom: 1px solid color-border[m[41m[m
[32m+[m[32m  &:before, &:after[m[41m[m
[32m+[m[32m    content: ""[m[41m[m
[32m+[m[32m    position: absolute[m[41m[m
[32m+[m[32m    left: 0[m[41m[m
[32m+[m[32m    right: 0[m[41m[m
[32m+[m[32m    height: 40px[m[41m[m
[32m+[m[32m  &:before[m[41m[m
[32m+[m[32m    top: 0[m[41m[m
[32m+[m[32m    background: linear-gradient(rgba(0, 0, 0, 0.2), transparent)[m[41m[m
[32m+[m[32m  &:after[m[41m[m
[32m+[m[32m    bottom: 0[m[41m[m
[32m+[m[32m    background: linear-gradient(transparent, rgba(0, 0, 0, 0.2))[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#header-outer[m[41m[m
[32m+[m[32m  height: 100%[m[41m[m
[32m+[m[32m  position: relative[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#header-inner[m[41m[m
[32m+[m[32m  background: rgba(0, 0, 0, 0)[m[41m[m
[32m+[m[32m  position: relative[m[41m[m
[32m+[m[32m  overflow: hidden[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#banner[m[41m[m
[32m+[m[32m  position: absolute[m[41m[m
[32m+[m[32m  top: 0[m[41m[m
[32m+[m[32m  left: 0[m[41m[m
[32m+[m[32m  width: 100%[m[41m[m
[32m+[m[32m  height: 100%[m[41m[m
[32m+[m[32m  background: url(banner-url) center #000[m[41m[m
[32m+[m[32m  background-size: cover[m[41m[m
[32m+[m[32m  z-index: -1[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#header-title[m[41m[m
[32m+[m[32m  text-align: center[m[41m[m
[32m+[m[32m  height: logo-size[m[41m[m
[32m+[m[32m  position: absolute[m[41m[m
[32m+[m[32m  top: 50%[m[41m[m
[32m+[m[32m  left: 0[m[41m[m
[32m+[m[32m  margin-top: logo-size * -0.5[m[41m[m
[32m+[m[41m[m
[32m+[m[32m$logo-text[m[41m[m
[32m+[m[32m  text-decoration: none[m[41m[m
[32m+[m[32m  color: #fff[m[41m[m
[32m+[m[32m  font-weight: 300[m[41m[m
[32m+[m[32m  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.3)[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#logo[m[41m[m
[32m+[m[32m  @extend $logo-text[m[41m[m
[32m+[m[32m  font-size: logo-size[m[41m[m
[32m+[m[32m  line-height: logo-size[m[41m[m
[32m+[m[32m  letter-spacing: 2px[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#subtitle[m[41m[m
[32m+[m[32m  @extend $logo-text[m[41m[m
[32m+[m[32m  font-size: subtitle-size[m[41m[m
[32m+[m[32m  line-height: subtitle-size[m[41m[m
[32m+[m[32m  letter-spacing: 1px[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#subtitle-wrap[m[41m[m
[32m+[m[32m  margin-top: subtitle-size[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#main-nav[m[41m[m
[32m+[m[32m  float: left[m[41m[m
[32m+[m[32m  margin-left: -15px[m[41m[m
[32m+[m[41m[m
[32m+[m[32m$nav-link[m[41m[m
[32m+[m[32m  float: left[m[41m[m
[32m+[m[32m  color: #fbf9e2[m[41m[m
[32m+[m[32m  opacity: 0.6[m[41m[m
[32m+[m[32m  text-decoration: none[m[41m[m
[32m+[m[32m  text-shadow: 0 1px rgba(0, 0, 0, 0.2)[m[41m[m
[32m+[m[32m  transition: opacity 0.2s[m[41m[m
[32m+[m[32m  display: block[m[41m[m
[32m+[m[32m  padding: 20px 15px[m[41m[m
[32m+[m[32m  &:hover[m[41m[m
[32m+[m[32m    opacity: 1[m[41m[m
[32m+[m[32m    color: #e99130[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.nav-icon[m[41m[m
[32m+[m[32m  @extend $nav-link[m[41m[m
[32m+[m[32m  font-family: font-icon[m[41m[m
[32m+[m[32m  text-align: center[m[41m[m
[32m+[m[32m  font-size: font-size[m[41m[m
[32m+[m[32m  width: font-size[m[41m[m
[32m+[m[32m  height: font-size[m[41m[m
[32m+[m[32m  padding: 20px 15px[m[41m[m
[32m+[m[32m  position: relative[m[41m[m
[32m+[m[32m  cursor: pointer[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.main-nav-link[m[41m[m
[32m+[m[32m  @extend $nav-link[m[41m[m
[32m+[m[32m  font-weight: 400[m[41m[m
[32m+[m[32m  letter-spacing: 1px[m[41m[m
[32m+[m[32m  @media mq-mobile[m[41m[m
[32m+[m[32m    display: none[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#main-nav-toggle[m[41m[m
[32m+[m[32m  display: none[m[41m[m
[32m+[m[32m  &:before[m[41m[m
[32m+[m[32m    content: "\f0c9"[m[41m[m
[32m+[m[32m  @media mq-mobile[m[41m[m
[32m+[m[32m    display: block[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#sub-nav[m[41m[m
[32m+[m[32m  float: right[m[41m[m
[32m+[m[32m  margin-top: 10px[m[41m[m
[32m+[m[32m  margin-right: 10px[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#nav-rss-link[m[41m[m
[32m+[m[32m  &:before[m[41m[m
[32m+[m[32m    content: "\f09e"[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#nav-search-btn[m[41m[m
[32m+[m[32m  &:before[m[41m[m
[32m+[m[32m    content: "\f002"[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#search-form-wrap[m[41m[m
[32m+[m[32m  position: absolute[m[41m[m
[32m+[m[32m  top: 15px[m[41m[m
[32m+[m[32m  width: 150px[m[41m[m
[32m+[m[32m  height: 30px[m[41m[m
[32m+[m[32m  right: -150px[m[41m[m
[32m+[m[32m  opacity: 0[m[41m[m
[32m+[m[32m  transition: 0.2s ease-out[m[41m[m
[32m+[m[32m  &.on[m[41m[m
[32m+[m[32m    opacity: 1[m[41m[m
[32m+[m[32m    right: 0[m[41m[m
[32m+[m[32m  @media mq-mobile[m[41m[m
[32m+[m[32m    width: 100%[m[41m[m
[32m+[m[32m    right: -100%[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.search-form[m[41m[m
[32m+[m[32m  position: absolute[m[41m[m
[32m+[m[32m  top: 0[m[41m[m
[32m+[m[32m  left: 0[m[41m[m
[32m+[m[32m  right: 0[m[41m[m
[32m+[m[32m  background: #fff[m[41m[m
[32m+[m[32m  padding: 5px 15px[m[41m[m
[32m+[m[32m  border-radius: 15px[m[41m[m
[32m+[m[32m  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3)[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.search-form-input[m[41m[m
[32m+[m[32m  border: none[m[41m[m
[32m+[m[32m  background: none[m[41m[m
[32m+[m[32m  color: color-default[m[41m[m
[32m+[m[32m  width: 100%[m[41m[m
[32m+[m[32m  font: 13px font-sans[m[41m[m
[32m+[m[32m  outline: none[m[41m[m
[32m+[m[32m  &::-webkit-search-results-decoration[m[41m[m
[32m+[m[32m  &::-webkit-search-cancel-button[m[41m[m
[32m+[m[32m    -webkit-appearance: none[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.search-form-submit[m[41m[m
[32m+[m[32m  position: absolute[m[41m[m
[32m+[m[32m  top: 50%[m[41m[m
[32m+[m[32m  right: 10px[m[41m[m
[32m+[m[32m  margin-top: -7px[m[41m[m
[32m+[m[32m  font: 13px font-icon[m[41m[m
[32m+[m[32m  border: none[m[41m[m
[32m+[m[32m  background: none[m[41m[m
[32m+[m[32m  color: #bbb[m[41m[m
[32m+[m[32m  cursor: pointer[m[41m[m
[32m+[m[32m  &:hover, &:focus[m[41m[m
     color: #777[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/css/_variables.styl b/static/themes/landscape/source/css/_variables.styl[m
[1mindex f12cf1a..4902d16 100644[m
[1m--- a/static/themes/landscape/source/css/_variables.styl[m
[1m+++ b/static/themes/landscape/source/css/_variables.styl[m
[36m@@ -1,64 +1,64 @@[m
[31m-// Config[m
[31m-support-for-ie = false[m
[31m-vendor-prefixes = webkit moz ms official[m
[31m-[m
[31m-// Colors[m
[31m-color-default = #555[m
[31m-color-grey = #999[m
[31m-color-border = #fbf9e2[m
[31m-color-link = #fd971f[m
[31m-color-background = #272822[m
[31m-color-sidebar-text = #777[m
[31m-color-widget-background = #ddd[m
[31m-color-widget-border = #ccc[m
[31m-color-footer-background = #162f57[m
[31m-color-mobile-nav-background = #191919[m
[31m-color-twitter = #00aced[m
[31m-color-facebook = #3b5998[m
[31m-color-pinterest = #cb2027[m
[31m-color-google = #dd4b39[m
[31m-[m
[31m-// Fonts[m
[31m-font-sans = -apple-system, BlinkMacSystemFont,[m
[31m-    "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell",[m
[31m-    "Fira Sans", "Droid Sans", "Helvetica Neue",[m
[31m-    sans-serif[m
[31m-font-serif = Georgia, "Times New Roman", serif[m
[31m-font-mono = "Source Code Pro", Consolas, Monaco, Menlo, Consolas, monospace[m
[31m-font-icon = FontAwesome[m
[31m-font-icon-path = "fonts/fontawesome-webfont"[m
[31m-font-icon-version = "4.0.3"[m
[31m-font-size = 14px[m
[31m-line-height = 1.6em[m
[31m-line-height-title = 1.1em[m
[31m-[m
[31m-// Header[m
[31m-logo-size = 40px[m
[31m-subtitle-size = 16px[m
[31m-banner-height = 30%[m
[31m-//banner-url="/img/banner.png"[m
[31m-banner-url = "https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/banner_gear_silver.png"[m
[31m-[m
[31m-sidebar = hexo-config("sidebar")[m
[31m-[m
[31m-// Layout[m
[31m-block-margin = 50px[m
[31m-article-padding = 20px[m
[31m-mobile-nav-width = 280px[m
[31m-main-column = 9[m
[31m-sidebar-column = 3[m
[31m-[m
[31m-if sidebar and sidebar isnt bottom[m
[31m-  _sidebar-column = sidebar-column[m
[31m-else[m
[31m-  _sidebar-column = 0[m
[31m-[m
[31m-// Grids[m
[31m-column-width = 80px[m
[31m-gutter-width = 20px[m
[31m-columns = main-column + _sidebar-column[m
[31m-[m
[31m-// Media queries[m
[31m-mq-mobile = "screen and (max-width: 479px)"[m
[31m-mq-tablet = "screen and (min-width: 480px) and (max-width: 767px)"[m
[31m-mq-normal = "screen and (min-width: 768px)"[m
[32m+[m[32m// Config[m[41m[m
[32m+[m[32msupport-for-ie = false[m[41m[m
[32m+[m[32mvendor-prefixes = webkit moz ms official[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// Colors[m[41m[m
[32m+[m[32mcolor-default = #555[m[41m[m
[32m+[m[32mcolor-grey = #999[m[41m[m
[32m+[m[32mcolor-border = #fbf9e2[m[41m[m
[32m+[m[32mcolor-link = #fd971f[m[41m[m
[32m+[m[32mcolor-background = #272822[m[41m[m
[32m+[m[32mcolor-sidebar-text = #777[m[41m[m
[32m+[m[32mcolor-widget-background = #ddd[m[41m[m
[32m+[m[32mcolor-widget-border = #ccc[m[41m[m
[32m+[m[32mcolor-footer-background = #162f57[m[41m[m
[32m+[m[32mcolor-mobile-nav-background = #191919[m[41m[m
[32m+[m[32mcolor-twitter = #00aced[m[41m[m
[32m+[m[32mcolor-facebook = #3b5998[m[41m[m
[32m+[m[32mcolor-pinterest = #cb2027[m[41m[m
[32m+[m[32mcolor-google = #dd4b39[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// Fonts[m[41m[m
[32m+[m[32mfont-sans = -apple-system, BlinkMacSystemFont,[m[41m[m
[32m+[m[32m    "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell",[m[41m[m
[32m+[m[32m    "Fira Sans", "Droid Sans", "Helvetica Neue",[m[41m[m
[32m+[m[32m    sans-serif[m[41m[m
[32m+[m[32mfont-serif = Georgia, "Times New Roman", serif[m[41m[m
[32m+[m[32mfont-mono = "Source Code Pro", Consolas, Monaco, Menlo, Consolas, monospace[m[41m[m
[32m+[m[32mfont-icon = FontAwesome[m[41m[m
[32m+[m[32mfont-icon-path = "fonts/fontawesome-webfont"[m[41m[m
[32m+[m[32mfont-icon-version = "4.0.3"[m[41m[m
[32m+[m[32mfont-size = 14px[m[41m[m
[32m+[m[32mline-height = 1.6em[m[41m[m
[32m+[m[32mline-height-title = 1.1em[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// Header[m[41m[m
[32m+[m[32mlogo-size = 40px[m[41m[m
[32m+[m[32msubtitle-size = 16px[m[41m[m
[32m+[m[32mbanner-height = 30%[m[41m[m
[32m+[m[32m//banner-url="/img/banner.png"[m[41m[m
[32m+[m[32mbanner-url = "https://raw.githubusercontent.com/teamET/2018.perform/develop/static/themes/landscape/source/img/banner_gear_silver.png"[m[41m[m
[32m+[m[41m[m
[32m+[m[32msidebar = hexo-config("sidebar")[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// Layout[m[41m[m
[32m+[m[32mblock-margin = 50px[m[41m[m
[32m+[m[32marticle-padding = 20px[m[41m[m
[32m+[m[32mmobile-nav-width = 280px[m[41m[m
[32m+[m[32mmain-column = 9[m[41m[m
[32m+[m[32msidebar-column = 3[m[41m[m
[32m+[m[41m[m
[32m+[m[32mif sidebar and sidebar isnt bottom[m[41m[m
[32m+[m[32m  _sidebar-column = sidebar-column[m[41m[m
[32m+[m[32melse[m[41m[m
[32m+[m[32m  _sidebar-column = 0[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// Grids[m[41m[m
[32m+[m[32mcolumn-width = 80px[m[41m[m
[32m+[m[32mgutter-width = 20px[m[41m[m
[32m+[m[32mcolumns = main-column + _sidebar-column[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// Media queries[m[41m[m
[32m+[m[32mmq-mobile = "screen and (max-width: 479px)"[m[41m[m
[32m+[m[32mmq-tablet = "screen and (min-width: 480px) and (max-width: 767px)"[m[41m[m
[32m+[m[32mmq-normal = "screen and (min-width: 768px)"[m[41m[m
[1mdiff --git a/static/themes/landscape/source/css/jquery.flex-images.css b/static/themes/landscape/source/css/jquery.flex-images.css[m
[1mindex 6f4083e..28db042 100644[m
[1m--- a/static/themes/landscape/source/css/jquery.flex-images.css[m
[1m+++ b/static/themes/landscape/source/css/jquery.flex-images.css[m
[36m@@ -1,3 +1,3 @@[m
[31m-.flex-images { overflow: hidden; }[m
[31m-.flex-images .item { float: left; margin: 4px; border: 1px solid #eee; box-sizing: content-box; overflow: hidden; position: relative;  }[m
[31m-.flex-images .item img { display: block; width: auto; height: 100%; }[m
[32m+[m[32m.flex-images { overflow: hidden; }[m[41m[m
[32m+[m[32m.flex-images .item { float: left; margin: 4px; border: 1px solid #eee; box-sizing: content-box; overflow: hidden; position: relative;  }[m[41m[m
[32m+[m[32m.flex-images .item img { display: block; width: auto; height: 100%; }[m[41m[m
[1mdiff --git a/static/themes/landscape/source/css/style.styl b/static/themes/landscape/source/css/style.styl[m
[1mindex 4437b47..7880c6d 100644[m
[1m--- a/static/themes/landscape/source/css/style.styl[m
[1m+++ b/static/themes/landscape/source/css/style.styl[m
[36m@@ -1,373 +1,373 @@[m
[31m-@import "nib"[m
[31m-@import "_variables"[m
[31m-@import "_util/mixin"[m
[31m-@import "_util/grid"[m
[31m-[m
[31m-global-reset()[m
[31m-[m
[31m-input, button[m
[31m-  margin: 0[m
[31m-  padding: 0[m
[31m-  &::-moz-focus-inner[m
[31m-    border: 0[m
[31m-    padding: 0[m
[31m-[m
[31m-@font-face[m
[31m-  font-family: FontAwesome[m
[31m-  font-style: normal[m
[31m-  font-weight: normal[m
[31m-  src: url(font-icon-path + ".eot?v=#" + font-icon-version)[m
[31m-  src: url(font-icon-path + ".eot?#iefix&v=#" + font-icon-version) format("embedded-opentype"),[m
[31m-       url(font-icon-path + ".woff?v=#" + font-icon-version) format("woff"),[m
[31m-       url(font-icon-path + ".ttf?v=#" + font-icon-version) format("truetype"),[m
[31m-       url(font-icon-path + ".svg#fontawesomeregular?v=#" + font-icon-version) format("svg")[m
[31m-[m
[31m-html, body, #container[m
[31m-  height: 500px;[m
[31m-[m
[31m-body[m
[31m-  max-width: 100%[m
[31m-  margin: 0 0[m
[31m-  padding: 0 0[m
[31m-  background: color-background[m
[31m-  font: font-size font-sans[m
[31m-  -webkit-text-size-adjust: 100%[m
[31m-[m
[31m-.outer[m
[31m-  clearfix()[m
[31m-[m
[31m-[m
[31m-.inner[m
[31m-  column(columns)[m
[31m-[m
[31m-.left, .alignleft[m
[31m-  float: left[m
[31m-[m
[31m-.right, .alignright[m
[31m-  float: right[m
[31m-[m
[31m-.clear[m
[31m-  clear: both[m
[31m-[m
[31m-#container[m
[31m-  position: relative[m
[31m-[m
[31m-.mobile-nav-on[m
[31m-  overflow: hidden[m
[31m-[m
[31m-#wrap[m
[31m-  height: 100%[m
[31m-  width: 100%[m
[31m-  position: absolute[m
[31m-  top: 0[m
[31m-  left: 0[m
[31m-  transition: 0.2s ease-out[m
[31m-  z-index: 1[m
[31m-  background: color-background[m
[31m-  .mobile-nav-on &[m
[31m-    left: mobile-nav-width[m
[31m-[m
[31m-if sidebar and sidebar isnt bottom[m
[31m-  #main[m
[31m-    @media mq-normal[m
[31m-      column(main-column)[m
[31m-[m
[31m-if sidebar is left[m
[31m-  @media mq-normal[m
[31m-    #main[m
[31m-      float: right[m
[31m-[m
[31m-@import "_extend"[m
[31m-@import "_partial/header"[m
[31m-@import "_partial/article"[m
[31m-@import "_partial/comment"[m
[31m-@import "_partial/archive"[m
[31m-@import "_partial/footer"[m
[31m-@import "_partial/highlight"[m
[31m-@import "_partial/mobile"[m
[31m-[m
[31m-if sidebar[m
[31m-  @import "_partial/sidebar"[m
[31m-[m
[31m-.shop {[m
[31m-  background-color: #272822;[m
[31m-  color: #fbf9e2;[m
[31m-  box-sizing: inherit;[m
[31m-  width: 32%;[m
[31m-  padding: 10px 10px 30px 10px;[m
[31m-  display: inline-block;[m
[31m-}[m
[31m-[m
[31m-.shop img {[m
[31m-  box-sizing: inherit;[m
[31m-  width: 100%;[m
[31m-}[m
[31m-[m
[31m-.shop table {[m
[31m-  background-color: rgba(0,0,0,0.4);[m
[31m-  box-sizing: inherit;[m
[31m-  width: 100%;[m
[31m-  color: #fbf9e2;[m
[31m-  box-shadow: 0px .125em .25em rgba(0,0,0,.25);[m
[31m-}[m
[31m-[m
[31m-.shop td {[m
[31m-  border: solid 0.5px #272822;  /* 枠線指定 */[m
[31m-  padding: 10px;      /* 余白指定 */[m
[31m-}[m
[31m-[m
[31m-.slide-show {[m
[31m-  position: relative;[m
[31m-}[m
[31m-[m
[31m-.slide-show p {[m
[31m-  font-size: 36px;[m
[31m-  text-align: center;[m
[31m-  position: absolute;[m
[31m-  color: white;[m
[31m-  top: 50%;[m
[31m-  left: 50%;[m
[31m-  -ms-transform: translate(-50%,-50%);[m
[31m-  -webkit-transform: translate(-50%,-50%);[m
[31m-  transform: translate(-50%,-50%);[m
[31m-  margin:0;[m
[31m-  padding:0;[m
[31m-}[m
[31m-.slide-show img {[m
[31m-  width: 100%;[m
[31m-  }[m
[31m-[m
[31m-table{[m
[31m-    width: 100%;[m
[31m-    background-color: #ffffff;[m
[31m-    height auto;[m
[31m-    margin: 15px auto 10px auto;[m
[31m-}[m
[31m-[m
[31m-td {[m
[31m-    border: solid 0.5px;  /* 枠線指定 */[m
[31m-    padding: 10px;      /* 余白指定 */[m
[31m-}[m
[31m-[m
[31m-.odd td {[m
[31m-    background: #ccc;[m
[31m-}[m
[31m-[m
[31m-.post {[m
[31m-    position: relative;[m
[31m-    border-bottom: 2px solid #d0d5d8;[m
[31m-    padding: 5px;[m
[31m-    width: 48%;[m
[31m-    display: inline-block;  [m
[31m-}[m
[31m-[m
[31m-.post:first-child {[m
[31m-    padding-top: 0;[m
[31m-}[m
[31m-[m
[31m-.post .title {[m
[31m-    font-size: 14px;[m
[31m-    color: #e99130;[m
[31m-    text-transform: uppercase;[m
[31m-    font-weight: 700;[m
[31m-    margin-bottom: 10px;[m
[31m-    display: inline-block;[m
[31m-}[m
[31m-[m
[31m-.post .content h6 {[m
[31m-    color: #fbf9e2;[m
[31m-    font-size: 14px;[m
[31m-    line-height: 1.6;[m
[31m-    margin-bottom: 10px;[m
[31m-    font-weight: 700;[m
[31m-}[m
[31m-[m
[31m-.post .content h6:focus {[m
[31m-    color: #e99130;[m
[31m-}[m
[31m-[m
[31m-.post .date {[m
[31m-    color: #fbf9e2;[m
[31m-    margin-bottom: 0;[m
[31m-    line-height: 1;[m
[31m-}[m
[31m-[m
[31m-.post:hover {[m
[31m-  background: rgba(0,0,0,0.5);  [m
[31m-}[m
[31m-.icon img{[m
[31m-    max-width: 28px;[m
[31m-}[m
[31m-[m
[31m-.news {[m
[31m-    float: left;[m
[31m-    background-color: #272822;[m
[31m-    position: relative;[m
[31m-    width: 45%;[m
[31m-    min-height: 1px;[m
[31m-    padding: 50px 20px 20px 20px;[m
[31m-}[m
[31m-[m
[31m-.about{[m
[31m-  width: 49%;[m
[31m-  float: left;[m
[31m-  }[m
[31m-[m
[31m-.about-content { [m
[31m-  box-sizing: inherit;[m
[31m-  width: 100%;[m
[31m-  margin: 20px;[m
[31m-  padding: 20px;[m
[31m-  color:  #fbf9e2;[m
[31m-  background-color: rgba(0,0,0,0.5);[m
[31m-  // background-image: url("https://user-images.githubusercontent.com/38575274/46751773-731b7300-ccf6-11e8-98fd-5416c5258d20.png");[m
[31m-  }[m
[31m-[m
[31m-.gallery h1,.about h1,.access h1,.news h1,.link-table h1 {[m
[31m-  text-align: center;[m
[31m-  color:#fbf9e2;[m
[31m-  font-size: 28px;[m
[31m-  padding-bottom: 20px;[m
[31m-  }[m
[31m-[m
[31m-.about p {[m
[31m-  opacity: 1;[m
[31m-  line-height: 200%;[m
[31m-  }[m
[31m-[m
[31m-.gallery {[m
[31m-  min-height: 200px;[m
[31m-  [m
[31m-  }[m
[31m-[m
[31m-html,[m
[31m-body {[m
[31m-/*    margin: 0;*/[m
[31m-/*    overflow: scroll;*/[m
[31m-    width: 100%;[m
[31m-    height:100%;[m
[31m-}[m
[31m-[m
[31m-#myCanvas {[m
[31m-    [m
[31m-    width: 100%;[m
[31m-    /* height : 100%; */[m
[31m-}[m
[31m-[m
[31m-#canvas{[m
[31m-    display : block;[m
[31m-    justify-content: center;[m
[31m-    align-items: center;[m
[31m-}[m
[31m-[m
[31m-.link-table {[m
[31m-  text-align: center;[m
[31m-  min-height: 300px;[m
[31m-  color: #fbf9e2;[m
[31m-  font-size: 18px;[m
[31m-  }[m
[31m-.link-table p:hover{[m
[31m-  color: #fd971f;[m
[31m-  }[m
[31m-[m
[31m-// .link {[m
[31m-//   position: relative;[m
[31m-//   border: solid 0.5px #ffffff;[m
[31m-// }[m
[31m-[m
[31m-// .link p {[m
[31m-//   font-size: 36px;[m
[31m-//   text-align: center;[m
[31m-//   position: absolute;[m
[31m-//   color: white;[m
[31m-//   top: 50%;[m
[31m-//   left: 50%;[m
[31m-//   -ms-transform: translate(-50%,-50%);[m
[31m-//   -webkit-transform: translate(-50%,-50%);[m
[31m-//   transform: translate(-50%,-50%);[m
[31m-//   margin:0;[m
[31m-//   padding:0;[m
[31m-// }[m
[31m-[m
[31m-// .link img {[m
[31m-//   width: 100%;[m
[31m-//   height: 200px;[m
[31m-[m
[31m-//   overflow: hidden;[m
[31m-//   }[m
[31m-[m
[31m-.access{[m
[31m-  text-align: center;[m
[31m-  color: #fbf9e2;[m
[31m-  }[m
[31m-[m
[31m-[m
[31m-.line_bot{[m
[31m-  color: #ffffff;[m
[31m-  min-height: 200px;[m
[31m-  text-align: center;[m
[31m-  }[m
[31m-[m
[31m-@media screen and (min-width: 500px) {[m
[31m-  .header_title {[m
[31m-    display: none; [m
[31m-    }[m
[31m-}[m
[31m-[m
[31m-@media screen and (max-width: 1024px) {[m
[31m-  .shop {[m
[31m-  width: 49.5%;[m
[31m-  }[m
[31m-}[m
[31m-[m
[31m-@media screen and (max-width: 500px) {[m
[31m-  .shop {[m
[31m-  box-sizing: inherit;[m
[31m-  width: 100%;[m
[31m-  padding: 10px;[m
[31m-  display: inline-block;[m
[31m-  }[m
[31m-[m
[31m-  .post {[m
[31m-  width: 100%;[m
[31m-  }[m
[31m-[m
[31m-  .about{[m
[31m-  width: 100%;[m
[31m-  overflow: hidden;[m
[31m-  }[m
[31m-[m
[31m-  .about-content{[m
[31m-    margin: 0;[m
[31m-  }[m
[31m-[m
[31m-  .slide-show p {[m
[31m-    font-size: 18px;[m
[31m-  }[m
[31m-[m
[31m-  .link p {[m
[31m-    height: 30px;[m
[31m-    font-size: 15px;[m
[31m-  }[m
[31m-[m
[31m-  .link {[m
[31m-  width:  33.33%;[m
[31m-  height 30px;[m
[31m-  overflow: hidden;[m
[31m-  }[m
[31m-[m
[31m-[m
[31m-  .news{[m
[31m-  padding: 10px;  [m
[31m-  width: 100%;[m
[31m-  }[m
[31m-[m
[31m-  .post {[m
[31m-    line-height: 1.2;[m
[31m-    font-weight: 500;[m
[31m-  }[m
[31m-[m
[31m-  body {[m
[31m-    padding:0;[m
[31m-  }[m
[31m-}[m
[32m+[m[32m@import "nib"[m[41m[m
[32m+[m[32m@import "_variables"[m[41m[m
[32m+[m[32m@import "_util/mixin"[m[41m[m
[32m+[m[32m@import "_util/grid"[m[41m[m
[32m+[m[41m[m
[32m+[m[32mglobal-reset()[m[41m[m
[32m+[m[41m[m
[32m+[m[32minput, button[m[41m[m
[32m+[m[32m  margin: 0[m[41m[m
[32m+[m[32m  padding: 0[m[41m[m
[32m+[m[32m  &::-moz-focus-inner[m[41m[m
[32m+[m[32m    border: 0[m[41m[m
[32m+[m[32m    padding: 0[m[41m[m
[32m+[m[41m[m
[32m+[m[32m@font-face[m[41m[m
[32m+[m[32m  font-family: FontAwesome[m[41m[m
[32m+[m[32m  font-style: normal[m[41m[m
[32m+[m[32m  font-weight: normal[m[41m[m
[32m+[m[32m  src: url(font-icon-path + ".eot?v=#" + font-icon-version)[m[41m[m
[32m+[m[32m  src: url(font-icon-path + ".eot?#iefix&v=#" + font-icon-version) format("embedded-opentype"),[m[41m[m
[32m+[m[32m       url(font-icon-path + ".woff?v=#" + font-icon-version) format("woff"),[m[41m[m
[32m+[m[32m       url(font-icon-path + ".ttf?v=#" + font-icon-version) format("truetype"),[m[41m[m
[32m+[m[32m       url(font-icon-path + ".svg#fontawesomeregular?v=#" + font-icon-version) format("svg")[m[41m[m
[32m+[m[41m[m
[32m+[m[32mhtml, body, #container[m[41m[m
[32m+[m[32m  height: 500px;[m[41m[m
[32m+[m[41m[m
[32m+[m[32mbody[m[41m[m
[32m+[m[32m  max-width: 100%[m[41m[m
[32m+[m[32m  margin: 0 0[m[41m[m
[32m+[m[32m  padding: 0 0[m[41m[m
[32m+[m[32m  background: color-background[m[41m[m
[32m+[m[32m  font: font-size font-sans[m[41m[m
[32m+[m[32m  -webkit-text-size-adjust: 100%[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.outer[m[41m[m
[32m+[m[32m  clearfix()[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.inner[m[41m[m
[32m+[m[32m  column(columns)[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.left, .alignleft[m[41m[m
[32m+[m[32m  float: left[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.right, .alignright[m[41m[m
[32m+[m[32m  float: right[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.clear[m[41m[m
[32m+[m[32m  clear: both[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#container[m[41m[m
[32m+[m[32m  position: relative[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.mobile-nav-on[m[41m[m
[32m+[m[32m  overflow: hidden[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#wrap[m[41m[m
[32m+[m[32m  height: 100%[m[41m[m
[32m+[m[32m  width: 100%[m[41m[m
[32m+[m[32m  position: absolute[m[41m[m
[32m+[m[32m  top: 0[m[41m[m
[32m+[m[32m  left: 0[m[41m[m
[32m+[m[32m  transition: 0.2s ease-out[m[41m[m
[32m+[m[32m  z-index: 1[m[41m[m
[32m+[m[32m  background: color-background[m[41m[m
[32m+[m[32m  .mobile-nav-on &[m[41m[m
[32m+[m[32m    left: mobile-nav-width[m[41m[m
[32m+[m[41m[m
[32m+[m[32mif sidebar and sidebar isnt bottom[m[41m[m
[32m+[m[32m  #main[m[41m[m
[32m+[m[32m    @media mq-normal[m[41m[m
[32m+[m[32m      column(main-column)[m[41m[m
[32m+[m[41m[m
[32m+[m[32mif sidebar is left[m[41m[m
[32m+[m[32m  @media mq-normal[m[41m[m
[32m+[m[32m    #main[m[41m[m
[32m+[m[32m      float: right[m[41m[m
[32m+[m[41m[m
[32m+[m[32m@import "_extend"[m[41m[m
[32m+[m[32m@import "_partial/header"[m[41m[m
[32m+[m[32m@import "_partial/article"[m[41m[m
[32m+[m[32m@import "_partial/comment"[m[41m[m
[32m+[m[32m@import "_partial/archive"[m[41m[m
[32m+[m[32m@import "_partial/footer"[m[41m[m
[32m+[m[32m@import "_partial/highlight"[m[41m[m
[32m+[m[32m@import "_partial/mobile"[m[41m[m
[32m+[m[41m[m
[32m+[m[32mif sidebar[m[41m[m
[32m+[m[32m  @import "_partial/sidebar"[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.shop {[m[41m[m
[32m+[m[32m  background-color: #272822;[m[41m[m
[32m+[m[32m  color: #fbf9e2;[m[41m[m
[32m+[m[32m  box-sizing: inherit;[m[41m[m
[32m+[m[32m  width: 32%;[m[41m[m
[32m+[m[32m  padding: 10px 10px 30px 10px;[m[41m[m
[32m+[m[32m  display: inline-block;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.shop img {[m[41m[m
[32m+[m[32m  box-sizing: inherit;[m[41m[m
[32m+[m[32m  width: 100%;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.shop table {[m[41m[m
[32m+[m[32m  background-color: rgba(0,0,0,0.4);[m[41m[m
[32m+[m[32m  box-sizing: inherit;[m[41m[m
[32m+[m[32m  width: 100%;[m[41m[m
[32m+[m[32m  color: #fbf9e2;[m[41m[m
[32m+[m[32m  box-shadow: 0px .125em .25em rgba(0,0,0,.25);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.shop td {[m[41m[m
[32m+[m[32m  border: solid 0.5px #272822;  /* 枠線指定 */[m[41m[m
[32m+[m[32m  padding: 10px;      /* 余白指定 */[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.slide-show {[m[41m[m
[32m+[m[32m  position: relative;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.slide-show p {[m[41m[m
[32m+[m[32m  font-size: 36px;[m[41m[m
[32m+[m[32m  text-align: center;[m[41m[m
[32m+[m[32m  position: absolute;[m[41m[m
[32m+[m[32m  color: white;[m[41m[m
[32m+[m[32m  top: 50%;[m[41m[m
[32m+[m[32m  left: 50%;[m[41m[m
[32m+[m[32m  -ms-transform: translate(-50%,-50%);[m[41m[m
[32m+[m[32m  -webkit-transform: translate(-50%,-50%);[m[41m[m
[32m+[m[32m  transform: translate(-50%,-50%);[m[41m[m
[32m+[m[32m  margin:0;[m[41m[m
[32m+[m[32m  padding:0;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[32m.slide-show img {[m[41m[m
[32m+[m[32m  width: 100%;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32mtable{[m[41m[m
[32m+[m[32m    width: 100%;[m[41m[m
[32m+[m[32m    background-color: #ffffff;[m[41m[m
[32m+[m[32m    height auto;[m[41m[m
[32m+[m[32m    margin: 15px auto 10px auto;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32mtd {[m[41m[m
[32m+[m[32m    border: solid 0.5px;  /* 枠線指定 */[m[41m[m
[32m+[m[32m    padding: 10px;      /* 余白指定 */[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.odd td {[m[41m[m
[32m+[m[32m    background: #ccc;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.post {[m[41m[m
[32m+[m[32m    position: relative;[m[41m[m
[32m+[m[32m    border-bottom: 2px solid #d0d5d8;[m[41m[m
[32m+[m[32m    padding: 5px;[m[41m[m
[32m+[m[32m    width: 48%;[m[41m[m
[32m+[m[32m    display: inline-block;[m[41m  [m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.post:first-child {[m[41m[m
[32m+[m[32m    padding-top: 0;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.post .title {[m[41m[m
[32m+[m[32m    font-size: 14px;[m[41m[m
[32m+[m[32m    color: #e99130;[m[41m[m
[32m+[m[32m    text-transform: uppercase;[m[41m[m
[32m+[m[32m    font-weight: 700;[m[41m[m
[32m+[m[32m    margin-bottom: 10px;[m[41m[m
[32m+[m[32m    display: inline-block;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.post .content h6 {[m[41m[m
[32m+[m[32m    color: #fbf9e2;[m[41m[m
[32m+[m[32m    font-size: 14px;[m[41m[m
[32m+[m[32m    line-height: 1.6;[m[41m[m
[32m+[m[32m    margin-bottom: 10px;[m[41m[m
[32m+[m[32m    font-weight: 700;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.post .content h6:focus {[m[41m[m
[32m+[m[32m    color: #e99130;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.post .date {[m[41m[m
[32m+[m[32m    color: #fbf9e2;[m[41m[m
[32m+[m[32m    margin-bottom: 0;[m[41m[m
[32m+[m[32m    line-height: 1;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.post:hover {[m[41m[m
[32m+[m[32m  background: rgba(0,0,0,0.5);[m[41m  [m
[32m+[m[32m}[m[41m[m
[32m+[m[32m.icon img{[m[41m[m
[32m+[m[32m    max-width: 28px;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.news {[m[41m[m
[32m+[m[32m    float: left;[m[41m[m
[32m+[m[32m    background-color: #272822;[m[41m[m
[32m+[m[32m    position: relative;[m[41m[m
[32m+[m[32m    width: 45%;[m[41m[m
[32m+[m[32m    min-height: 1px;[m[41m[m
[32m+[m[32m    padding: 50px 20px 20px 20px;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.about{[m[41m[m
[32m+[m[32m  width: 49%;[m[41m[m
[32m+[m[32m  float: left;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.about-content {[m[41m [m
[32m+[m[32m  box-sizing: inherit;[m[41m[m
[32m+[m[32m  width: 100%;[m[41m[m
[32m+[m[32m  margin: 20px;[m[41m[m
[32m+[m[32m  padding: 20px;[m[41m[m
[32m+[m[32m  color:  #fbf9e2;[m[41m[m
[32m+[m[32m  background-color: rgba(0,0,0,0.5);[m[41m[m
[32m+[m[32m  // background-image: url("https://user-images.githubusercontent.com/38575274/46751773-731b7300-ccf6-11e8-98fd-5416c5258d20.png");[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.gallery h1,.about h1,.access h1,.news h1,.link-table h1 {[m[41m[m
[32m+[m[32m  text-align: center;[m[41m[m
[32m+[m[32m  color:#fbf9e2;[m[41m[m
[32m+[m[32m  font-size: 28px;[m[41m[m
[32m+[m[32m  padding-bottom: 20px;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.about p {[m[41m[m
[32m+[m[32m  opacity: 1;[m[41m[m
[32m+[m[32m  line-height: 200%;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.gallery {[m[41m[m
[32m+[m[32m  min-height: 200px;[m[41m[m
[32m+[m[41m  [m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32mhtml,[m[41m[m
[32m+[m[32mbody {[m[41m[m
[32m+[m[32m/*    margin: 0;*/[m[41m[m
[32m+[m[32m/*    overflow: scroll;*/[m[41m[m
[32m+[m[32m    width: 100%;[m[41m[m
[32m+[m[32m    height:100%;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#myCanvas {[m[41m[m
[32m+[m[41m    [m
[32m+[m[32m    width: 100%;[m[41m[m
[32m+[m[32m    /* height : 100%; */[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#canvas{[m[41m[m
[32m+[m[32m    display : block;[m[41m[m
[32m+[m[32m    justify-content: center;[m[41m[m
[32m+[m[32m    align-items: center;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.link-table {[m[41m[m
[32m+[m[32m  text-align: center;[m[41m[m
[32m+[m[32m  min-height: 300px;[m[41m[m
[32m+[m[32m  color: #fbf9e2;[m[41m[m
[32m+[m[32m  font-size: 18px;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m.link-table p:hover{[m[41m[m
[32m+[m[32m  color: #fd971f;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// .link {[m[41m[m
[32m+[m[32m//   position: relative;[m[41m[m
[32m+[m[32m//   border: solid 0.5px #ffffff;[m[41m[m
[32m+[m[32m// }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// .link p {[m[41m[m
[32m+[m[32m//   font-size: 36px;[m[41m[m
[32m+[m[32m//   text-align: center;[m[41m[m
[32m+[m[32m//   position: absolute;[m[41m[m
[32m+[m[32m//   color: white;[m[41m[m
[32m+[m[32m//   top: 50%;[m[41m[m
[32m+[m[32m//   left: 50%;[m[41m[m
[32m+[m[32m//   -ms-transform: translate(-50%,-50%);[m[41m[m
[32m+[m[32m//   -webkit-transform: translate(-50%,-50%);[m[41m[m
[32m+[m[32m//   transform: translate(-50%,-50%);[m[41m[m
[32m+[m[32m//   margin:0;[m[41m[m
[32m+[m[32m//   padding:0;[m[41m[m
[32m+[m[32m// }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// .link img {[m[41m[m
[32m+[m[32m//   width: 100%;[m[41m[m
[32m+[m[32m//   height: 200px;[m[41m[m
[32m+[m[41m[m
[32m+[m[32m//   overflow: hidden;[m[41m[m
[32m+[m[32m//   }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.access{[m[41m[m
[32m+[m[32m  text-align: center;[m[41m[m
[32m+[m[32m  color: #fbf9e2;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.line_bot{[m[41m[m
[32m+[m[32m  color: #ffffff;[m[41m[m
[32m+[m[32m  min-height: 200px;[m[41m[m
[32m+[m[32m  text-align: center;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m@media screen and (min-width: 500px) {[m[41m[m
[32m+[m[32m  .header_title {[m[41m[m
[32m+[m[32m    display: none;[m[41m [m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m@media screen and (max-width: 1024px) {[m[41m[m
[32m+[m[32m  .shop {[m[41m[m
[32m+[m[32m  width: 49.5%;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m@media screen and (max-width: 500px) {[m[41m[m
[32m+[m[32m  .shop {[m[41m[m
[32m+[m[32m  box-sizing: inherit;[m[41m[m
[32m+[m[32m  width: 100%;[m[41m[m
[32m+[m[32m  padding: 10px;[m[41m[m
[32m+[m[32m  display: inline-block;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .post {[m[41m[m
[32m+[m[32m  width: 100%;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .about{[m[41m[m
[32m+[m[32m  width: 100%;[m[41m[m
[32m+[m[32m  overflow: hidden;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .about-content{[m[41m[m
[32m+[m[32m    margin: 0;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .slide-show p {[m[41m[m
[32m+[m[32m    font-size: 18px;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .link p {[m[41m[m
[32m+[m[32m    height: 30px;[m[41m[m
[32m+[m[32m    font-size: 15px;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .link {[m[41m[m
[32m+[m[32m  width:  33.33%;[m[41m[m
[32m+[m[32m  height 30px;[m[41m[m
[32m+[m[32m  overflow: hidden;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .news{[m[41m[m
[32m+[m[32m  padding: 10px;[m[41m  [m
[32m+[m[32m  width: 100%;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .post {[m[41m[m
[32m+[m[32m    line-height: 1.2;[m[41m[m
[32m+[m[32m    font-weight: 500;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  body {[m[41m[m
[32m+[m[32m    padding:0;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m}[m[41m[m
[1mdiff --git a/static/themes/landscape/source/data/BoothID.xlsx b/static/themes/landscape/source/data/BoothID.xlsx[m
[1mindex 18b2564..03e76f9 100644[m
Binary files a/static/themes/landscape/source/data/BoothID.xlsx and b/static/themes/landscape/source/data/BoothID.xlsx differ
[1mdiff --git a/static/themes/landscape/source/data/booth.json b/static/themes/landscape/source/data/booth.json[m
[1mindex d39c683..4094c0b 100644[m
[1m--- a/static/themes/landscape/source/data/booth.json[m
[1m+++ b/static/themes/landscape/source/data/booth.json[m
[36m@@ -1,30 +1,37 @@[m
 {[m
[31m-	"v4E": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>v4E</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"abd": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>abd</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"c4C": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>c4C</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"cm": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>cm</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"htb": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>htb</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"c2D": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>c2D</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"hb": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>hb</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"v2AC": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>v2AC</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"bsk": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>bsk</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"v5E": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>v5E</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"v2M": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>v2M</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"fb": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>fb</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"bd": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>bd</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"kusa": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>kusa</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"sw": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>sw</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"yku": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>yku</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"vb": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>vb</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"fs": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>fs</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"1AC": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>1AC</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"hl": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>hl</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"v5C": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>v5C</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"c4J": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>c4J</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"tnf": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>tnf</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"v3D": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>v3D</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"cyc": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>cyc</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"c2C": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>c2C</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"c4M": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>c4M</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>",[m
[31m-	"mada": "<divclass='w3-half'style='display:block;'><imgclass='w3-marginw3-circle'src='https://avatars0.githubusercontent.com/u/28134110?s=200&v=4'><tableclass='w3-tablew3-white'style='width:250px;display:block'id='search_shop_table'><p>mada</p><td>a</td><tr>100</tr><td>b</td><tr>200</tr></table></div>"[m
[32m+[m	[32m"v4E": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v4E</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"abd": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>abd</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v4C": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v4C</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"cm": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>cm</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"htb": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>htb</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c2D": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c2D</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"hb": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>hb</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v2AC": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v2AC</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"bsk": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>bsk</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v5E": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v5E</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v2M": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v2M</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"fb": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>fb</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"bd": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>bd</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"nr": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>nr</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"sw": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>sw</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"yku": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>yku</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"vb": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>vb</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"fs": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>fs</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"1AC": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>1AC</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"hl": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>hl</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v5C": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v5C</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c4J": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c4J</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"tnf": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>tnf</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v3D": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v3D</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"cyc": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>cyc</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c2C": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c2C</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c4M": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c4M</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"pg": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>pg</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c4D": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c4D</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"tea": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>tea</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v4D": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v4D</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c14": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c14</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c13": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c13</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v11": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v11</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"gcat": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>gcat</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>"[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/data/boothID.json b/static/themes/landscape/source/data/boothID.json[m
[1mindex 19a85bf..6ee0d59 100644[m
[1m--- a/static/themes/landscape/source/data/boothID.json[m
[1m+++ b/static/themes/landscape/source/data/boothID.json[m
[36m@@ -1,7 +1,7 @@[m
 {[m
 	"OutsideA1": "v4E",[m
 	"OutsideA2": "abd",[m
[31m-	"OutsideA3": "c4C",[m
[32m+[m	[32m"OutsideA3": "v4C",[m
 	"OutsideA4": "cm",[m
 	"OutsideA5": "htb",[m
 	"OutsideB1": "c2D",[m
[36m@@ -12,7 +12,7 @@[m
 	"OutsideC2": "v2M",[m
 	"OutsideD1": "fb",[m
 	"OutsideD2": "bd",[m
[31m-	"OutsideD3": "kusa",[m
[32m+[m	[32m"OutsideD3": "nr",[m
 	"OutsideD4": "sw",[m
 	"OutsideD5": "yku",[m
 	"OutsideD6": "vb",[m
[36m@@ -27,38 +27,30 @@[m
 	"OutsideF1": "c2C",[m
 	"OutsideF2": "c4M",[m
 	"OutsideF3": "v5E",[m
[31m-	"Inside211": "mada",[m
[31m-	"Inside212": "mada",[m
[31m-	"Inside213": "mada",[m
[31m-	"Inside214": "mada",[m
[31m-	"Inside221": "mada",[m
[31m-	"Inside222": "mada",[m
[31m-	"Inside223": "mada",[m
[31m-	"Inside224": "mada",[m
[31m-	"Inside225": "mada",[m
[31m-	"Inside231": "mada",[m
[31m-	"Inside232": "mada",[m
[31m-	"Inside233": "mada",[m
[31m-	"Inside234": "mada",[m
[31m-	"Inside235": "mada",[m
[31m-	"Inside241": "mada",[m
[31m-	"Inside242": "mada",[m
[31m-	"Inside243": "mada",[m
[31m-	"Inside244": "mada",[m
[31m-	"Inside245": "mada",[m
[31m-	"Inside311": "mada",[m
[31m-	"Inside312": "mada",[m
[31m-	"Inside321": "mada",[m
[31m-	"Inside322": "mada",[m
[31m-	"Inside331": "mada",[m
[31m-	"Inside332": "mada",[m
[31m-	"Inside341": "mada",[m
[31m-	"Inside342": "mada",[m
[31m-	"Inside511": "mada",[m
[31m-	"Inside512": "mada",[m
[31m-	"Inside521": "mada",[m
[31m-	"Inside811": "mada",[m
[31m-	"Inside812": "mada",[m
[31m-	"Inside821": "mada",[m
[31m-	"Inside822": "mada"[m
[32m+[m	[32m"Inside211": "labo2",[m
[32m+[m	[32m"Inside212": "labo1",[m
[32m+[m	[32m"Inside213": "pg",[m
[32m+[m	[32m"Inside221": "labo3",[m
[32m+[m	[32m"Inside222": "c4D",[m
[32m+[m	[32m"Inside223": "tea",[m
[32m+[m	[32m"Inside231": "v4D",[m
[32m+[m	[32m"Inside232": "c14",[m
[32m+[m	[32m"Inside233": "c13",[m
[32m+[m	[32m"Inside234": "v11",[m
[32m+[m	[32m"Inside235": "gcat",[m
[32m+[m	[32m"Inside311": "labo5",[m
[32m+[m	[32m"Inside312": "labo4",[m
[32m+[m	[32m"Inside321": "labo6",[m
[32m+[m	[32m"Inside322": "labo6",[m
[32m+[m	[32m"Inside323": "labo7",[m
[32m+[m	[32m"Inside331": "labo9",[m
[32m+[m	[32m"Inside332": "labo8",[m
[32m+[m	[32m"Inside341": "labo14",[m
[32m+[m	[32m"Inside342": "labo13",[m
[32m+[m	[32m"Inside343": "labo15",[m
[32m+[m	[32m"Inside344": "labo12",[m
[32m+[m	[32m"Inside511": "labo16",[m
[32m+[m	[32m"Inside521": "concert",[m
[32m+[m	[32m"Inside811": "labo24",[m
[32m+[m	[32m"Inside821": "labo25"[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/data/boothsample.json b/static/themes/landscape/source/data/boothsample.json[m
[1mindex 0679b09..4094c0b 100644[m
[1m--- a/static/themes/landscape/source/data/boothsample.json[m
[1m+++ b/static/themes/landscape/source/data/boothsample.json[m
[36m@@ -1,7 +1,7 @@[m
 {[m
 	"v4E": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v4E</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"abd": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>abd</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[31m-	"c4C": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c4C</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v4C": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v4C</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"cm": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>cm</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"htb": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>htb</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"c2D": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c2D</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[36m@@ -12,7 +12,7 @@[m
 	"v2M": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v2M</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"fb": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>fb</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"bd": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>bd</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[31m-	"kusa": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>kusa</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"nr": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>nr</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"sw": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>sw</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"yku": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>yku</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"vb": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>vb</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[36m@@ -26,5 +26,12 @@[m
 	"cyc": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>cyc</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"c2C": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c2C</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
 	"c4M": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c4M</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[31m-	"mada": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>mada</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>"[m
[32m+[m	[32m"pg": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>pg</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c4D": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c4D</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"tea": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>tea</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v4D": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v4D</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c14": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c14</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"c13": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>c13</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"v11": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>v11</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>",[m
[32m+[m	[32m"gcat": "<div class=\"w3-half\" style=\"display: block;\"><img class=\"w3-margin w3-circle\" src=\"https://avatars0.githubusercontent.com/u/28134110?s=200&v=4\"><table class=\"w3-table w3-white\" style=\"width: 250px; display: block\" id=\"search_shop_table\"><p>gcat</p> <td>a</td><tr>100</tr> <td>b</td><tr>200</tr></table></div>"[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/data/mapImgData.json b/static/themes/landscape/source/data/mapImgData.json[m
[1mindex c9d2b25..ed006ac 100644[m
[1m--- a/static/themes/landscape/source/data/mapImgData.json[m
[1m+++ b/static/themes/landscape/source/data/mapImgData.json[m
[36m@@ -1,321 +1,325 @@[m
[31m-{[m
[31m-    "ToCampusArrow":"map-tool-toInside.png",[m
[31m-    "ToOutsideArrow":"map-tool-toOutside.png",[m
[31m-    "Generalview": "map.png",[m
[31m-    "AreaRects":[[m
[31m-        {"x":1050,"y":300,"width":500,"height":250,"color":"DarkRed"},[m
[31m-        {"x":1750,"y":270,"width":450,"height":250,"color":"DarkRed"},[m
[31m-        {"x":1730,"y":580,"width":450,"height":250,"color":"DarkRed"},[m
[31m-        {"x":1850,"y":900,"width":300,"height":400,"color":"DarkRed"},[m
[31m-        {"x":2450,"y":1150,"width":350,"height":230,"color":"DarkRed"},[m
[31m-        {"x":2250,"y":850,"width":230,"height":200,"color":"DarkRed"}[m
[31m-    ],[m
[31m-    "ToDisplayPinImg":"map-tool-pin-on.png",[m
[31m-    "ToHidePinImg":"map-tool-pin-off.png",[m
[31m-    "PinImg_1":"map-pin_1.png",[m
[31m-    "PinImg_2":"map-pin_2.png",[m
[31m-    "GotoGeneralImg":"map-tool-toOutsideTop.png",[m
[31m-    "OutsideAreas":[[m
[31m-        {[m
[31m-            "area":"A",[m
[31m-            "img":"map-mogi-A.png",[m
[31m-            "pins":[[m
[31m-                {"x":290,"y":250},[m
[31m-                {"x":460,"y":250},[m
[31m-                {"x":940,"y":250},[m
[31m-                {"x":1120,"y":250},[m
[31m-                {"x":1650,"y":450}[m
[31m-            ],[m
[31m-            "goGeneral":{"x":2300,"y":0},[m
[31m-            "toDisplayPins":{"x":320,"y":1240},[m
[31m-            "toHidePins":{"x":320,"y":1250}[m
[31m-        },[m
[31m-        {[m
[31m-            "area":"B",[m
[31m-            "img":"map-mogi-B.png",[m
[31m-            "pins":[[m
[31m-                {"x":470,"y":60},[m
[31m-                {"x":700,"y":60},[m
[31m-                {"x":920,"y":60},[m
[31m-                {"x":1150,"y":60}[m
[31m-            ],[m
[31m-            "goGeneral":{"x":2500,"y":1500},[m
[31m-            "toDisplayPins":{"x":3110,"y":930},[m
[31m-            "toHidePins":{"x":3110,"y":930}[m
[31m-        },[m
[31m-        {[m
[31m-            "area":"C",[m
[31m-            "img":"map-mogi-C.png",[m
[31m-            "pins":[[m
[31m-                {"x":900,"y":770},[m
[31m-                {"x":900,"y":920}[m
[31m-            ],[m
[31m-            "goGeneral":{"x":1900,"y":0},[m
[31m-            "toDisplayPins":{"x":2990,"y":300},[m
[31m-            "toHidePins":{"x":2990,"y":300}[m
[31m-        },[m
[31m-        {[m
[31m-            "area":"D",[m
[31m-            "img":"map-mogi-D.png",[m
[31m-            "pins":[[m
[31m-                {"x":920,"y":200},[m
[31m-                {"x":920,"y":360},[m
[31m-                {"x":920,"y":680},[m
[31m-                {"x":920,"y":840},[m
[31m-                {"x":1432,"y":255},[m
[31m-                {"x":1432,"y":410},[m
[31m-                {"x":1432,"y":560},[m
[31m-                {"x":1432,"y":720}[m
[31m-            ],[m
[31m-            "goGeneral":{"x":1900,"y":-40},[m
[31m-            "toDisplayPins":{"x":3000,"y":50},[m
[31m-            "toHidePins":{"x":3000,"y":50}[m
[31m-        },[m
[31m-        {[m
[31m-            "area":"E",[m
[31m-            "img":"map-mogi-E.png",[m
[31m-            "pins":[[m
[31m-                {"x":330,"y":260},[m
[31m-                {"x":507,"y":260},[m
[31m-                {"x":852,"y":260},[m
[31m-                {"x":1030,"y":260},[m
[31m-                {"x":1207,"y":260},[m
[31m-                {"x":1375,"y":260}[m
[31m-            ],[m
[31m-            "goGeneral":{"x":1600,"y":0},[m
[31m-            "toDisplayPins":{"x":2750,"y":70},[m
[31m-            "toHidePins":{"x":2750,"y":70}[m
[31m-        },[m
[31m-        {[m
[31m-            "area":"F",[m
[31m-            "img":"map-mogi-F.png",[m
[31m-            "pins":[[m
[31m-                {"x":350,"y":580},[m
[31m-                {"x":595,"y":580},[m
[31m-                {"x":830,"y":580}  [m
[31m-            ],[m
[31m-            "goGeneral":{"x":1900,"y":-40},[m
[31m-            "toDisplayPins":{"x":2980,"y":100},[m
[31m-            "toHidePins":{"x":2980,"y":100}[m
[31m-        }[m
[31m-    ],[m
[31m-    "Campus":{[m
[31m-        "top":"map-inside.png",[m
[31m-        "goTopArrow":"map-tool-toInsideTop.png",[m
[31m-        "goUpperFloorImg":"map-tool-toUpper.png",[m
[31m-        "goLowerFloorImg":"map-tool-toLower.png",[m
[31m-        "goUpperFloorImg_8":"map-tool-toUpper-8.png",[m
[31m-        "goLowerFloorImg_8":"map-tool-toLower-8.png",[m
[31m-        "buildingRects":[[m
[31m-            {"x":1050,"y":1100,"width":1450,"height":280,"color":"DarkRed"},[m
[31m-            {"x":1050,"y":550,"width":1450,"height":290,"color":"DarkRed"},[m
[31m-            {"x":1050,"y":30,"width":1450,"height":280,"color":"DarkRed"},[m
[31m-            {"x":550,"y":1635,"width":510,"height":285,"color":"DarkRed"}[m
[31m-        ],[m
[31m-        "balloons":[[m
[31m-            {"img":"map-inside-balloon2.png","x":2300,"y":500},[m
[31m-            {"img":"map-inside-balloon3.png","x":2300,"y":160},[m
[31m-            {"img":"map-inside-balloon8.png","x":1000,"y":1300}[m
[31m-        ],[m
[31m-        "balloonRects":[[m
[31m-            [[m
[31m-                {"x":2470,"y":1370,"width":850,"height":290},[m
[31m-                {"x":2470,"y":1080,"width":850,"height":290},[m
[31m-                {"x":2470,"y":790,"width":850,"height":290},[m
[31m-                {"x":2470,"y":500,"width":850,"height":290}[m
[31m-            ],[m
[31m-            [[m
[31m-                {"x":2470,"y":1030,"width":850,"height":290},[m
[31m-                {"x":2470,"y":740,"width":850,"height":290},[m
[31m-                {"x":2470,"y":450,"width":850,"height":290},[m
[31m-                {"x":2470,"y":160,"width":850,"height":290}[m
[31m-            ],[m
[31m-            [[m
[31m-                {"x":1150,"y":1590,"width":850,"height":290},[m
[31m-                {"x":1150,"y":1300,"width":850,"height":290}[m
[31m-            ][m
[31m-        ],[m
[31m-        "buildings":[[m
[31m-            {[m
[31m-                "buildNum":2,[m
[31m-                "floorImg":[[m
[31m-                    "map-inside-2-1.png",[m
[31m-                    "map-inside-2-2.png",[m
[31m-                    "map-inside-2-3.png",[m
[31m-                    "map-inside-2-4.png"[m
[31m-                ],[m
[31m-                "goUpper":[[m
[31m-                    {"floor":0,"x":2100,"y":0},[m
[31m-                    {"floor":1,"x":2100,"y":0},[m
[31m-                    {"floor":2,"x":2100,"y":0}[m
[31m-                ],[m
[31m-                "goLower":[[m
[31m-                    {"floor":1,"x":2100,"y":1350},[m
[31m-                    {"floor":2,"x":2100,"y":1350},[m
[31m-                    {"floor":3,"x":2100,"y":1350}[m
[31m-                ],[m
[31m-                "pins":[[m
[31m-                    [[m
[31m-                        {"x":2200,"y":700}[m
[31m-                    ],[m
[31m-                    [[m
[31m-                        {"x":2660,"y":700},[m
[31m-                        {"x":3130,"y":700}[m
[31m-                    ],[m
[31m-                    [[m
[31m-                        {"x":1300,"y":700},[m
[31m-                        {"x":1740,"y":700},[m
[31m-                        {"x":2200,"y":700},[m
[31m-                        {"x":2660,"y":700},[m
[31m-                        {"x":3130,"y":700}[m
[31m-                    ],[m
[31m-                    [[m
[31m-                        [m
[31m-                    ][m
[31m-                ],[m
[31m-                "goTop":[[m
[31m-                    {"x":-10,"y":-50},[m
[31m-                    {"x":-80,"y":-70},[m
[31m-                    {"x":-10,"y":-50},[m
[31m-                    {"x":-10,"y":-50}[m
[31m-                ],[m
[31m-                "toDisplayPins":[[m
[31m-                    {"x":2900,"y":1450},[m
[31m-                    {"x":3100,"y":1450},[m
[31m-                    {"x":3100,"y":1450},[m
[31m-                    {"x":3100,"y":1450}[m
[31m-                ],[m
[31m-                "toHidePins":[[m
[31m-                    {"x":2900,"y":1450},[m
[31m-                    {"x":3100,"y":1450},[m
[31m-                    {"x":3100,"y":1450},[m
[31m-                    {"x":3100,"y":1450}[m
[31m-                ][m
[31m-            },[m
[31m-            {[m
[31m-                "buildNum":3,[m
[31m-                "floorImg":[[m
[31m-                    "map-inside-3-1.png",[m
[31m-                    "map-inside-3-2.png",[m
[31m-                    "map-inside-3-3.png",[m
[31m-                    "map-inside-3-4.png"[m
[31m-                ],[m
[31m-                "goUpper":[[m
[31m-                    {"floor":0,"x":2100,"y":-20},[m
[31m-                    {"floor":1,"x":2100,"y":-20},[m
[31m-                    {"floor":2,"x":2100,"y":-20}[m
[31m-                ],[m
[31m-                "goLower":[[m
[31m-                    {"floor":1,"x":2100,"y":1580},[m
[31m-                    {"floor":2,"x":2100,"y":1580},[m
[31m-                    {"floor":3,"x":2100,"y":1580}[m
[31m-                ],[m
[31m-                "pins":[[m
[31m-                    [[m
[31m-                        {"x":2920,"y":1200},[m
[31m-                        {"x":3225,"y":800}[m
[31m-                    ],[m
[31m-                    [[m
[31m-                        {"x":1325,"y":400},[m
[31m-                        {"x":1325,"y":1200},[m
[31m-                        {"x":3225,"y":800}[m
[31m-                    ],[m
[31m-                    [[m
[31m-                        {"x":2470,"y":1200},[m
[31m-                        {"x":2970,"y":1200}[m
[31m-                    ],[m
[31m-                    [[m
[31m-                        {"x": 120,"y":800},[m
[31m-                        {"x":1277,"y":1200},[m
[31m-                        {"x":1605,"y":400},[m
[31m-                        {"x":2340,"y":1200}[m
[31m-                    ][m
[31m-                ],[m
[31m-                "goTop":[[m
[31m-                    {"x":-10,"y":-30},[m
[31m-                    {"x":-10,"y":-30},[m
[31m-                    {"x":-10,"y":-30},[m
[31m-                    {"x":-10,"y":-30}[m
[31m-                ],[m
[31m-                "toDisplayPins":[[m
[31m-                    {"x":1000,"y":50},[m
[31m-                    {"x":1000,"y":50},[m
[31m-                    {"x":1000,"y":50},[m
[31m-                    {"x":1000,"y":50}[m
[31m-                ],[m
[31m-                "toHidePins":[[m
[31m-                    {"x":1000,"y":50},[m
[31m-                    {"x":1000,"y":50},[m
[31m-                    {"x":1000,"y":50},[m
[31m-                    {"x":1000,"y":50}[m
[31m-                ][m
[31m-            },[m
[31m-            {[m
[31m-                "buildNum":5,[m
[31m-                "floorImg":[[m
[31m-                    "map-inside-5-1.png",[m
[31m-                    "map-inside-5-2.png"[m
[31m-                ],[m
[31m-                "goUpper":[[m
[31m-                    {"floor":0,"x":1200,"y":-10}[m
[31m-                ],[m
[31m-                "goLower":[[m
[31m-                    {"floor":1,"x":1400,"y":1300}[m
[31m-                ],[m
[31m-                "pins":[[m
[31m-                    [[m
[31m-                        [m
[31m-                    ],[m
[31m-                    [[m
[31m-                        {"x":1650,"y":800}[m
[31m-                    ][m
[31m-                ],[m
[31m-                "goTop":[[m
[31m-                    {"x":-10,"y":-30},[m
[31m-                    {"x":-10,"y":-70}[m
[31m-                ],[m
[31m-                "toDisplayPins":[[m
[31m-                    {"x":10000,"y":1080},[m
[31m-                    {"x":2400,"y":400}[m
[31m-                ],[m
[31m-                "toHidePins":[[m
[31m-                    {"x":10000,"y":1080},[m
[31m-                    {"x":2400,"y":400}[m
[31m-                ][m
[31m-            },[m
[31m-            {[m
[31m-                "buildNum":8,[m
[31m-                "floorImg":[[m
[31m-                    "map-inside-8-1.png",[m
[31m-                    "map-inside-8-3.png"[m
[31m-                ],[m
[31m-                "goUpper":[[m
[31m-                    {"floor":0,"x":1000,"y":-25}[m
[31m-                ],[m
[31m-                "goLower":[[m
[31m-                    {"floor":1,"x":1300,"y":1220}[m
[31m-                ],[m
[31m-                "pins":[[m
[31m-                    [[m
[31m-                        {"x":1130,"y":1300}[m
[31m-                    ],[m
[31m-                    [[m
[31m-                        {"x":800,"y":1300}[m
[31m-                    ][m
[31m-                ],[m
[31m-                "goTop":[[m
[31m-                    {"x":-10,"y":-60},[m
[31m-                    {"x":-10,"y":-30}[m
[31m-                ],[m
[31m-                "toDisplayPins":[[m
[31m-                    {"x":2213,"y":400},[m
[31m-                    {"x":2213,"y":400}[m
[31m-                ],[m
[31m-                "toHidePins":[[m
[31m-                    {"x":2215,"y":400},[m
[31m-                    {"x":2215,"y":400}[m
[31m-                ][m
[31m-            }[m
[31m-        ][m
[31m-    }[m
[32m+[m[32m{[m[41m[m
[32m+[m[32m    "ToCampusArrow":"map-tool-toInside.png",[m[41m[m
[32m+[m[32m    "ToOutsideArrow":"map-tool-toOutside.png",[m[41m[m
[32m+[m[32m    "Generalview": "map.png",[m[41m[m
[32m+[m[32m    "AreaRects":[[m[41m[m
[32m+[m[32m        {"x":1050,"y":300,"width":500,"height":250,"color":"DarkRed"},[m[41m[m
[32m+[m[32m        {"x":1750,"y":270,"width":450,"height":250,"color":"DarkRed"},[m[41m[m
[32m+[m[32m        {"x":1730,"y":580,"width":450,"height":250,"color":"DarkRed"},[m[41m[m
[32m+[m[32m        {"x":1850,"y":900,"width":300,"height":400,"color":"DarkRed"},[m[41m[m
[32m+[m[32m        {"x":2450,"y":1150,"width":350,"height":230,"color":"DarkRed"},[m[41m[m
[32m+[m[32m        {"x":2250,"y":850,"width":230,"height":200,"color":"DarkRed"}[m[41m[m
[32m+[m[32m    ],[m[41m[m
[32m+[m[32m    "ToDisplayPinImg":"map-tool-pin-on.png",[m[41m[m
[32m+[m[32m    "ToHidePinImg":"map-tool-pin-off.png",[m[41m[m
[32m+[m[32m    "PinImg_1":"map-pin_1.png",[m[41m[m
[32m+[m[32m    "PinImg_2":"map-pin_2.png",[m[41m[m
[32m+[m[32m    "GotoGeneralImg":"map-tool-toOutsideTop.png",[m[41m[m
[32m+[m[32m    "OutsideAreas":[[m[41m[m
[32m+[m[32m        {[m[41m[m
[32m+[m[32m            "area":"A",[m[41m[m
[32m+[m[32m            "img":"map-mogi-A.png",[m[41m[m
[32m+[m[32m            "pins":[[m[41m[m
[32m+[m[32m                {"x":290,"y":250},[m[41m[m
[32m+[m[32m                {"x":460,"y":250},[m[41m[m
[32m+[m[32m                {"x":940,"y":250},[m[41m[m
[32m+[m[32m                {"x":1120,"y":250},[m[41m[m
[32m+[m[32m                {"x":1650,"y":450}[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            "goGeneral":{"x":2300,"y":0},[m[41m[m
[32m+[m[32m            "toDisplayPins":{"x":320,"y":1240},[m[41m[m
[32m+[m[32m            "toHidePins":{"x":320,"y":1250}[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        {[m[41m[m
[32m+[m[32m            "area":"B",[m[41m[m
[32m+[m[32m            "img":"map-mogi-B.png",[m[41m[m
[32m+[m[32m            "pins":[[m[41m[m
[32m+[m[32m                {"x":470,"y":60},[m[41m[m
[32m+[m[32m                {"x":700,"y":60},[m[41m[m
[32m+[m[32m                {"x":920,"y":60},[m[41m[m
[32m+[m[32m                {"x":1150,"y":60}[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            "goGeneral":{"x":2500,"y":1500},[m[41m[m
[32m+[m[32m            "toDisplayPins":{"x":3110,"y":930},[m[41m[m
[32m+[m[32m            "toHidePins":{"x":3110,"y":930}[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        {[m[41m[m
[32m+[m[32m            "area":"C",[m[41m[m
[32m+[m[32m            "img":"map-mogi-C.png",[m[41m[m
[32m+[m[32m            "pins":[[m[41m[m
[32m+[m[32m                {"x":900,"y":770},[m[41m[m
[32m+[m[32m                {"x":900,"y":920}[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            "goGeneral":{"x":1900,"y":0},[m[41m[m
[32m+[m[32m            "toDisplayPins":{"x":2990,"y":300},[m[41m[m
[32m+[m[32m            "toHidePins":{"x":2990,"y":300}[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        {[m[41m[m
[32m+[m[32m            "area":"D",[m[41m[m
[32m+[m[32m            "img":"map-mogi-D.png",[m[41m[m
[32m+[m[32m            "pins":[[m[41m[m
[32m+[m[32m                {"x":920,"y":200},[m[41m[m
[32m+[m[32m                {"x":920,"y":360},[m[41m[m
[32m+[m[32m                {"x":920,"y":680},[m[41m[m
[32m+[m[32m                {"x":920,"y":840},[m[41m[m
[32m+[m[32m                {"x":1432,"y":255},[m[41m[m
[32m+[m[32m                {"x":1432,"y":410},[m[41m[m
[32m+[m[32m                {"x":1432,"y":560},[m[41m[m
[32m+[m[32m                {"x":1432,"y":720}[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            "goGeneral":{"x":1900,"y":-40},[m[41m[m
[32m+[m[32m            "toDisplayPins":{"x":3000,"y":50},[m[41m[m
[32m+[m[32m            "toHidePins":{"x":3000,"y":50}[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        {[m[41m[m
[32m+[m[32m            "area":"E",[m[41m[m
[32m+[m[32m            "img":"map-mogi-E.png",[m[41m[m
[32m+[m[32m            "pins":[[m[41m[m
[32m+[m[32m                {"x":330,"y":260},[m[41m[m
[32m+[m[32m                {"x":507,"y":260},[m[41m[m
[32m+[m[32m                {"x":852,"y":260},[m[41m[m
[32m+[m[32m                {"x":1030,"y":260},[m[41m[m
[32m+[m[32m                {"x":1207,"y":260},[m[41m[m
[32m+[m[32m                {"x":1375,"y":260}[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            "goGeneral":{"x":1600,"y":0},[m[41m[m
[32m+[m[32m            "toDisplayPins":{"x":2750,"y":70},[m[41m[m
[32m+[m[32m            "toHidePins":{"x":2750,"y":70}[m[41m[m
[32m+[m[32m        },[m[41m[m
[32m+[m[32m        {[m[41m[m
[32m+[m[32m            "area":"F",[m[41m[m
[32m+[m[32m            "img":"map-mogi-F.png",[m[41m[m
[32m+[m[32m            "pins":[[m[41m[m
[32m+[m[32m                {"x":350,"y":580},[m[41m[m
[32m+[m[32m                {"x":595,"y":580},[m[41m[m
[32m+[m[32m                {"x":830,"y":580}[m[41m  [m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            "goGeneral":{"x":1900,"y":-40},[m[41m[m
[32m+[m[32m            "toDisplayPins":{"x":2980,"y":100},[m[41m[m
[32m+[m[32m            "toHidePins":{"x":2980,"y":100}[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m    ],[m[41m[m
[32m+[m[32m    "Campus":{[m[41m[m
[32m+[m[32m        "top":"map-inside.png",[m[41m[m
[32m+[m[32m        "goTopArrow":"map-tool-toInsideTop.png",[m[41m[m
[32m+[m[32m        "goUpperFloorImg":"map-tool-toUpper.png",[m[41m[m
[32m+[m[32m        "goLowerFloorImg":"map-tool-toLower.png",[m[41m[m
[32m+[m[32m        "goUpperFloorImg_8":"map-tool-toUpper-8.png",[m[41m[m
[32m+[m[32m        "goLowerFloorImg_8":"map-tool-toLower-8.png",[m[41m[m
[32m+[m[32m        "buildingRects":[[m[41m[m
[32m+[m[32m            {"x":1050,"y":1100,"width":1450,"height":280,"color":"DarkRed"},[m[41m[m
[32m+[m[32m            {"x":1050,"y":550,"width":1450,"height":290,"color":"DarkRed"},[m[41m[m
[32m+[m[32m            {"x":1050,"y":30,"width":1450,"height":280,"color":"DarkRed"},[m[41m[m
[32m+[m[32m            {"x":3010,"y":320,"width":560,"height":405,"color":"DarkRed"},[m[41m            [m
[32m+[m[32m            {"x":550,"y":1635,"width":510,"height":285,"color":"DarkRed"}[m[41m[m
[32m+[m[32m        ],[m[41m[m
[32m+[m[32m        "balloons":[[m[41m[m
[32m+[m[32m            {"img":"map-inside-balloon2.png","x":2300,"y":500},[m[41m[m
[32m+[m[32m            {"img":"map-inside-balloon3.png","x":2300,"y":160},[m[41m[m
[32m+[m[32m            {"img":"map-inside-balloon8.png","x":1000,"y":1300}[m[41m[m
[32m+[m[32m        ],[m[41m[m
[32m+[m[32m        "balloonRects":[[m[41m[m
[32m+[m[32m            [[m[41m[m
[32m+[m[32m                {"x":2470,"y":1370,"width":850,"height":290},[m[41m[m
[32m+[m[32m                {"x":2470,"y":1080,"width":850,"height":290},[m[41m[m
[32m+[m[32m                {"x":2470,"y":790,"width":850,"height":290},[m[41m[m
[32m+[m[32m                {"x":2470,"y":500,"width":850,"height":290}[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            [[m[41m[m
[32m+[m[32m                {"x":2470,"y":1030,"width":850,"height":290},[m[41m[m
[32m+[m[32m                {"x":2470,"y":740,"width":850,"height":290},[m[41m[m
[32m+[m[32m                {"x":2470,"y":450,"width":850,"height":290},[m[41m[m
[32m+[m[32m                {"x":2470,"y":160,"width":850,"height":290}[m[41m[m
[32m+[m[32m            ],[m[41m[m
[32m+[m[32m            [[m[41m[m
[32m+[m[32m                {"x":1150,"y":1590,"width":850,"height":290},[m[41m[m
[32m+[m[32m                {"x":1150,"y":1300,"width":850,"height":290}[m[41m[m
[32m+[m[32m            ][m[41m[m
[32m+[m[32m        ],[m[41m[m
[32m+[m[32m        "buildings":[[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "buildNum":2,[m[41m[m
[32m+[m[32m                "floorImg":[[m[41m[m
[32m+[m[32m                    "map-inside-2-1.png",[m[41m[m
[32m+[m[32m                    "map-inside-2-2.png",[m[41m[m
[32m+[m[32m                    "map-inside-2-3.png",[m[41m[m
[32m+[m[32m                    "map-inside-2-4.png"[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goUpper":[[m[41m[m
[32m+[m[32m                    {"floor":0,"x":2100,"y":0},[m[41m[m
[32m+[m[32m                    {"floor":1,"x":2100,"y":0},[m[41m[m
[32m+[m[32m                    {"floor":2,"x":2100,"y":0}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goLower":[[m[41m[m
[32m+[m[32m                    {"floor":1,"x":2100,"y":1350},[m[41m[m
[32m+[m[32m                    {"floor":2,"x":2100,"y":1350},[m[41m[m
[32m+[m[32m                    {"floor":3,"x":2100,"y":1350}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "pins":[[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":170,"y":450},[m[41m[m
[32m+[m[32m                        {"x":170,"y":1100},[m[41m[m
[32m+[m[32m                        {"x":2200,"y":700}[m[41m[m
[32m+[m[32m                    ],[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":1300,"y":700},[m[41m[m
[32m+[m[32m                        {"x":2660,"y":700},[m[41m[m
[32m+[m[32m                        {"x":3130,"y":700}[m[41m[m
[32m+[m[32m                    ],[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":1300,"y":700},[m[41m[m
[32m+[m[32m                        {"x":1740,"y":700},[m[41m[m
[32m+[m[32m                        {"x":2200,"y":700},[m[41m[m
[32m+[m[32m                        {"x":2660,"y":700},[m[41m[m
[32m+[m[32m                        {"x":3130,"y":700}[m[41m[m
[32m+[m[32m                    ],[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[41m                        [m
[32m+[m[32m                    ][m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goTop":[[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-50},[m[41m[m
[32m+[m[32m                    {"x":-80,"y":-70},[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-50},[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-50}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "toDisplayPins":[[m[41m[m
[32m+[m[32m                    {"x":2900,"y":1450},[m[41m[m
[32m+[m[32m                    {"x":3100,"y":1450},[m[41m[m
[32m+[m[32m                    {"x":3100,"y":1450},[m[41m[m
[32m+[m[32m                    {"x":3100,"y":1450}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "toHidePins":[[m[41m[m
[32m+[m[32m                    {"x":2900,"y":1450},[m[41m[m
[32m+[m[32m                    {"x":3100,"y":1450},[m[41m[m
[32m+[m[32m                    {"x":3100,"y":1450},[m[41m[m
[32m+[m[32m                    {"x":3100,"y":1450}[m[41m[m
[32m+[m[32m                ][m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "buildNum":3,[m[41m[m
[32m+[m[32m                "floorImg":[[m[41m[m
[32m+[m[32m                    "map-inside-3-1.png",[m[41m[m
[32m+[m[32m                    "map-inside-3-2.png",[m[41m[m
[32m+[m[32m                    "map-inside-3-3.png",[m[41m[m
[32m+[m[32m                    "map-inside-3-4.png"[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goUpper":[[m[41m[m
[32m+[m[32m                    {"floor":0,"x":2100,"y":-20},[m[41m[m
[32m+[m[32m                    {"floor":1,"x":2100,"y":-20},[m[41m[m
[32m+[m[32m                    {"floor":2,"x":2100,"y":-20}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goLower":[[m[41m[m
[32m+[m[32m                    {"floor":1,"x":2100,"y":1580},[m[41m[m
[32m+[m[32m                    {"floor":2,"x":2100,"y":1580},[m[41m[m
[32m+[m[32m                    {"floor":3,"x":2100,"y":1580}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "pins":[[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":2920,"y":1200},[m[41m[m
[32m+[m[32m                        {"x":3225,"y":800}[m[41m[m
[32m+[m[32m                    ],[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":1325,"y":400},[m[41m[m
[32m+[m[32m                        {"x":1325,"y":1200},[m[41m[m
[32m+[m[32m                        {"x":3225,"y":800}[m[41m[m
[32m+[m[32m                    ],[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":2472,"y":1200},[m[41m[m
[32m+[m[32m                        {"x":2960,"y":1200}[m[41m[m
[32m+[m[32m                    ],[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x": 110,"y":800},[m[41m[m
[32m+[m[32m                        {"x":1267,"y":1200},[m[41m[m
[32m+[m[32m                        {"x":1605,"y":400},[m[41m[m
[32m+[m[32m                        {"x":2330,"y":1200}[m[41m[m
[32m+[m[32m                    ][m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goTop":[[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-30},[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-30},[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-30},[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-30}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "toDisplayPins":[[m[41m[m
[32m+[m[32m                    {"x":1000,"y":50},[m[41m[m
[32m+[m[32m                    {"x":1000,"y":50},[m[41m[m
[32m+[m[32m                    {"x":1000,"y":50},[m[41m[m
[32m+[m[32m                    {"x":1000,"y":50}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "toHidePins":[[m[41m[m
[32m+[m[32m                    {"x":1000,"y":50},[m[41m[m
[32m+[m[32m                    {"x":1000,"y":50},[m[41m[m
[32m+[m[32m                    {"x":1000,"y":50},[m[41m[m
[32m+[m[32m                    {"x":1000,"y":50}[m[41m[m
[32m+[m[32m                ][m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "buildNum":5,[m[41m[m
[32m+[m[32m                "floorImg":[[m[41m[m
[32m+[m[32m                    "map-inside-5-1.png",[m[41m[m
[32m+[m[32m                    "map-inside-5-2.png"[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goUpper":[[m[41m[m
[32m+[m[32m                    {"floor":0,"x":1200,"y":-10}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goLower":[[m[41m[m
[32m+[m[32m                    {"floor":1,"x":1400,"y":1300}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "pins":[[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":1020,"y":480}[m[41m[m
[32m+[m[32m                    ],[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":1650,"y":800}[m[41m[m
[32m+[m[32m                    ][m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goTop":[[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-30},[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-70}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "toDisplayPins":[[m[41m[m
[32m+[m[32m                    {"x":10000,"y":1080},[m[41m[m
[32m+[m[32m                    {"x":2400,"y":400}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "toHidePins":[[m[41m[m
[32m+[m[32m                    {"x":10000,"y":1080},[m[41m[m
[32m+[m[32m                    {"x":2400,"y":400}[m[41m[m
[32m+[m[32m                ][m[41m[m
[32m+[m[32m            },[m[41m[m
[32m+[m[32m            {[m[41m[m
[32m+[m[32m                "buildNum":8,[m[41m[m
[32m+[m[32m                "floorImg":[[m[41m[m
[32m+[m[32m                    "map-inside-8-1.png",[m[41m[m
[32m+[m[32m                    "map-inside-8-3.png"[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goUpper":[[m[41m[m
[32m+[m[32m                    {"floor":0,"x":1000,"y":-25}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goLower":[[m[41m[m
[32m+[m[32m                    {"floor":1,"x":1300,"y":1220}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "pins":[[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":1130,"y":1300}[m[41m[m
[32m+[m[32m                    ],[m[41m[m
[32m+[m[32m                    [[m[41m[m
[32m+[m[32m                        {"x":800,"y":1300}[m[41m[m
[32m+[m[32m                    ][m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "goTop":[[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-60},[m[41m[m
[32m+[m[32m                    {"x":-10,"y":-30}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "toDisplayPins":[[m[41m[m
[32m+[m[32m                    {"x":2213,"y":400},[m[41m[m
[32m+[m[32m                    {"x":2213,"y":400}[m[41m[m
[32m+[m[32m                ],[m[41m[m
[32m+[m[32m                "toHidePins":[[m[41m[m
[32m+[m[32m                    {"x":2215,"y":400},[m[41m[m
[32m+[m[32m                    {"x":2215,"y":400}[m[41m[m
[32m+[m[32m                ][m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m        ][m[41m[m
[32m+[m[32m    }[m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/fancybox/jquery.skeduler.css b/static/themes/landscape/source/fancybox/jquery.skeduler.css[m
[1mindex 9dd0fdc..5478854 100644[m
[1m--- a/static/themes/landscape/source/fancybox/jquery.skeduler.css[m
[1m+++ b/static/themes/landscape/source/fancybox/jquery.skeduler.css[m
[36m@@ -1,150 +1,150 @@[m
[31m-[m
[31m-.skeduler-container {[m
[31m-  font-family: Helvetica, ​Arial, ​sans-serif;[m
[31m-  box-sizing: inherit;[m
[31m-}[m
[31m-[m
[31m-.skeduler-container * {[m
[31m-  box-sizing: content-box;[m
[31m-  text-align: center;[m
[31m-}[m
[31m-[m
[31m-.skeduler-headers {[m
[31m-  color: #fbf9e2;[m
[31m-  border-left: 1px solid #272822 ;[m
[31m-  display: flex;[m
[31m-  padding-left: 60px;[m
[31m-  position: relative;[m
[31m-}[m
[31m-[m
[31m-.skeduler-headers:before {[m
[31m-  border-top: 1px solid #272822 ;[m
[31m-  content: "";[m
[31m-  width: 60px;[m
[31m-  position: absolute;[m
[31m-  left: 0;[m
[31m-}[m
[31m-[m
[31m-.skeduler-headers > div {[m
[31m-  flex: 0 0 200px;[m
[31m-  height: 30px;[m
[31m-  padding-top: 10px;[m
[31m-  background-color: rgba(0,0,0,.5);[m
[31m-  border-left: 1px solid #272822;[m
[31m-  border-bottom: 1px solid #272822;[m
[31m-  border-top: 1px solid #272822;[m
[31m-  text-align: center;[m
[31m-}[m
[31m-[m
[31m-.skeduler-headers > div:last-child,[m
[31m-.skeduler-main-body > div > div.skeduler-cell  {[m
[31m-  border-right: 1px solid #272822;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main {[m
[31m-  display: flex;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-timeline {[m
[31m-  margin-top: -1px;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-timeline div {[m
[31m-  width: 50px;[m
[31m-  height: 27px;[m
[31m-  text-align: left;[m
[31m-  padding-left: 10px;[m
[31m-  padding-top: 3px;[m
[31m-  color: #fff;[m
[31m-  border-right: 1px solid #272822 ;[m
[31m-  border-left: 1px solid #272822 ;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-timeline div:first-child {[m
[31m-    border-top: 1px solid #272822 ;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-body {[m
[31m-  display: flex;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-timeline div,[m
[31m-.skeduler-main-body > div > div.skeduler-cell {[m
[31m-  background-color: rgba(0,0,0,.8);[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-timeline div:nth-child(even),[m
[31m-.skeduler-main-body > div > div.skeduler-cell:nth-child(odd) {[m
[31m-  /* border-top: 0.5px dotted #fff; */[m
[31m-  border-bottom: 1px dotted #fff;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-body > div > div.skeduler-cell {[m
[31m-  width: 200px;[m
[31m-  height: 30px;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-body > div > .skeduler-task-placeholder {[m
[31m-  height: 0;[m
[31m-  position: relative;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-body > div > .skeduler-task-placeholder > div {[m
[31m-  position: absolute;[m
[31m-  overflow: hidden;[m
[31m-  background-color: #fd971f;[m
[31m-  padding: 10px;[m
[31m-  box-sizing: border-box;[m
[31m-  box-shadow: 0px .125em .25em rgba(0,0,0,.25);[m
[31m-  margin-top: 2px;[m
[31m-  cursor: pointer;[m
[31m-  color: #FFFFFF;[m
[31m-  word-wrap: break-word;[m
[31m-  min-width: 0;[m
[31m-  min-height: 0;[m
[31m-  transition: all .4s;[m
[31m-}[m
[31m-[m
[31m-.skeduler-main-body > div > .skeduler-task-placeholder > div:hover {[m
[31m-  box-shadow: 0 .25em .5em rgba(0,0,0,.5);[m
[31m-  background-color: #162f57;[m
[31m-  min-height: 150px;[m
[31m-  min-width: 200px;[m
[31m-  opacity: 0.9;[m
[31m-  z-index: 9999;[m
[31m-}[m
[31m-[m
[31m-.hide-content{[m
[31m-  display: none;[m
[31m-}[m
[31m-[m
[31m-#scheduler-task div:hover~.hide-content {[m
[31m-  display: block;[m
[31m-}[m
[31m-[m
[31m-@media screen and (max-width: 500px) {[m
[31m-  .skeduler-headers > div {[m
[31m-    flex: 0 0 90px;[m
[31m-  }[m
[31m-[m
[31m-  .skeduler-headers {[m
[31m-    padding-left: 51px;[m
[31m-  }[m
[31m-[m
[31m-  skeduler-headers:before {[m
[31m-    width: 40px;[m
[31m-  }[m
[31m-[m
[31m-  .skeduler-main-body > div > div.skeduler-cell {[m
[31m-    width: 90px;[m
[31m-  }[m
[31m-[m
[31m-  .skeduler-main-timeline div {[m
[31m-    width: 40px;[m
[31m-    text-align: left;[m
[31m-  }[m
[31m-  .skeduler-main-body > div > .skeduler-task-placeholder > div:hover {[m
[31m-    min-width: 82px;[m
[31m-    min-height: 110px;[m
[31m-  }[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-container {[m[41m[m
[32m+[m[32m  font-family: Helvetica, ​Arial, ​sans-serif;[m[41m[m
[32m+[m[32m  box-sizing: inherit;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-container * {[m[41m[m
[32m+[m[32m  box-sizing: content-box;[m[41m[m
[32m+[m[32m  text-align: center;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-headers {[m[41m[m
[32m+[m[32m  color: #fbf9e2;[m[41m[m
[32m+[m[32m  border-left: 1px solid #272822 ;[m[41m[m
[32m+[m[32m  display: flex;[m[41m[m
[32m+[m[32m  padding-left: 60px;[m[41m[m
[32m+[m[32m  position: relative;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-headers:before {[m[41m[m
[32m+[m[32m  border-top: 1px solid #272822 ;[m[41m[m
[32m+[m[32m  content: "";[m[41m[m
[32m+[m[32m  width: 60px;[m[41m[m
[32m+[m[32m  position: absolute;[m[41m[m
[32m+[m[32m  left: 0;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-headers > div {[m[41m[m
[32m+[m[32m  flex: 0 0 200px;[m[41m[m
[32m+[m[32m  height: 30px;[m[41m[m
[32m+[m[32m  padding-top: 10px;[m[41m[m
[32m+[m[32m  background-color: rgba(0,0,0,.5);[m[41m[m
[32m+[m[32m  border-left: 1px solid #272822;[m[41m[m
[32m+[m[32m  border-bottom: 1px solid #272822;[m[41m[m
[32m+[m[32m  border-top: 1px solid #272822;[m[41m[m
[32m+[m[32m  text-align: center;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-headers > div:last-child,[m[41m[m
[32m+[m[32m.skeduler-main-body > div > div.skeduler-cell  {[m[41m[m
[32m+[m[32m  border-right: 1px solid #272822;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main {[m[41m[m
[32m+[m[32m  display: flex;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-timeline {[m[41m[m
[32m+[m[32m  margin-top: -1px;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-timeline div {[m[41m[m
[32m+[m[32m  width: 50px;[m[41m[m
[32m+[m[32m  height: 27px;[m[41m[m
[32m+[m[32m  text-align: left;[m[41m[m
[32m+[m[32m  padding-left: 10px;[m[41m[m
[32m+[m[32m  padding-top: 3px;[m[41m[m
[32m+[m[32m  color: #fff;[m[41m[m
[32m+[m[32m  border-right: 1px solid #272822 ;[m[41m[m
[32m+[m[32m  border-left: 1px solid #272822 ;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-timeline div:first-child {[m[41m[m
[32m+[m[32m    border-top: 1px solid #272822 ;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-body {[m[41m[m
[32m+[m[32m  display: flex;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-timeline div,[m[41m[m
[32m+[m[32m.skeduler-main-body > div > div.skeduler-cell {[m[41m[m
[32m+[m[32m  background-color: rgba(0,0,0,.8);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-timeline div:nth-child(even),[m[41m[m
[32m+[m[32m.skeduler-main-body > div > div.skeduler-cell:nth-child(odd) {[m[41m[m
[32m+[m[32m  /* border-top: 0.5px dotted #fff; */[m[41m[m
[32m+[m[32m  border-bottom: 1px dotted #fff;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-body > div > div.skeduler-cell {[m[41m[m
[32m+[m[32m  width: 200px;[m[41m[m
[32m+[m[32m  height: 30px;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-body > div > .skeduler-task-placeholder {[m[41m[m
[32m+[m[32m  height: 0;[m[41m[m
[32m+[m[32m  position: relative;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-body > div > .skeduler-task-placeholder > div {[m[41m[m
[32m+[m[32m  position: absolute;[m[41m[m
[32m+[m[32m  overflow: hidden;[m[41m[m
[32m+[m[32m  background-color: #fd971f;[m[41m[m
[32m+[m[32m  padding: 10px;[m[41m[m
[32m+[m[32m  box-sizing: border-box;[m[41m[m
[32m+[m[32m  box-shadow: 0px .125em .25em rgba(0,0,0,.25);[m[41m[m
[32m+[m[32m  margin-top: 2px;[m[41m[m
[32m+[m[32m  cursor: pointer;[m[41m[m
[32m+[m[32m  color: #FFFFFF;[m[41m[m
[32m+[m[32m  word-wrap: break-word;[m[41m[m
[32m+[m[32m  min-width: 0;[m[41m[m
[32m+[m[32m  min-height: 0;[m[41m[m
[32m+[m[32m  transition: all .4s;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.skeduler-main-body > div > .skeduler-task-placeholder > div:hover {[m[41m[m
[32m+[m[32m  box-shadow: 0 .25em .5em rgba(0,0,0,.5);[m[41m[m
[32m+[m[32m  background-color: #162f57;[m[41m[m
[32m+[m[32m  min-height: 150px;[m[41m[m
[32m+[m[32m  min-width: 200px;[m[41m[m
[32m+[m[32m  opacity: 0.9;[m[41m[m
[32m+[m[32m  z-index: 9999;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m.hide-content{[m[41m[m
[32m+[m[32m  display: none;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m#scheduler-task div:hover~.hide-content {[m[41m[m
[32m+[m[32m  display: block;[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m@media screen and (max-width: 500px) {[m[41m[m
[32m+[m[32m  .skeduler-headers > div {[m[41m[m
[32m+[m[32m    flex: 0 0 90px;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .skeduler-headers {[m[41m[m
[32m+[m[32m    padding-left: 51px;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  skeduler-headers:before {[m[41m[m
[32m+[m[32m    width: 40px;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .skeduler-main-body > div > div.skeduler-cell {[m[41m[m
[32m+[m[32m    width: 90px;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  .skeduler-main-timeline div {[m[41m[m
[32m+[m[32m    width: 40px;[m[41m[m
[32m+[m[32m    text-align: left;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m  .skeduler-main-body > div > .skeduler-task-placeholder > div:hover {[m[41m[m
[32m+[m[32m    min-width: 82px;[m[41m[m
[32m+[m[32m    min-height: 110px;[m[41m[m
[32m+[m[32m  }[m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/fancybox/jquery.skeduler.js b/static/themes/landscape/source/fancybox/jquery.skeduler.js[m
[1mindex 1ff32b8..2c682dc 100644[m
[1m--- a/static/themes/landscape/source/fancybox/jquery.skeduler.js[m
[1m+++ b/static/themes/landscape/source/fancybox/jquery.skeduler.js[m
[36m@@ -1,228 +1,228 @@[m
[31m-(function ($) {[m
[31m-  $win = $(window);[m
[31m-  var windowWidth = $win.width();[m
[31m-  console.log(windowWidth);[m
[31m-  var defaultSettings = {[m
[31m-    // Data attributes[m
[31m-    headers: [],  // String[] - Array of column headers[m
[31m-    tasks: [],    // Task[] - Array of tasks. Required fields: [m
[31m-    // id: number, startTime: number, duration: number, column: number[m
[31m-[m
[31m-    // Card template - Inner content of task card. [m
[31m-    // You're able to use ${key} inside template, where key is any property from task.[m
[31m-    cardTemplate: '<div>${id}</div>',[m
[31m-[m
[31m-    // OnClick event handler[m
[31m-    onClick: function (e, task) { },[m
[31m-[m
[31m-    // Css classes[m
[31m-    containerCssClass: 'skeduler-container',[m
[31m-    headerContainerCssClass: 'skeduler-headers',[m
[31m-    schedulerContainerCssClass: 'skeduler-main',[m
[31m-    taskPlaceholderCssClass: 'skeduler-task-placeholder',[m
[31m-    cellCssClass: 'skeduler-cell',[m
[31m-    oddCellCssClass: 'odd skeduler-cell',[m
[31m-    lineHeight: 30,      // height of one half-hour line in grid[m
[31m-    borderWidth: 1,      // width of board of grid cell[m
[31m-[m
[31m-    debug: false[m
[31m-  };[m
[31m-  var settings = {};[m
[31m-[m
[31m-  /**[m
[31m-   * Convert double value of hours to zero-preposited string with 30 or 00 value of minutes[m
[31m-   */[m
[31m-  function toTimeString(value) {[m
[31m-    return (value < 10 ? '0' : '') + Math.floor(value) + (Math.ceil(value) > Math.floor(value) ? ':30' : ':00');[m
[31m-  }[m
[31m-[m
[31m-  /**[m
[31m-   * Return height of task card based on duration of the task[m
[31m-   * duration - in hours[m
[31m-   */[m
[31m-  function getCardHeight(duration) {[m
[31m-    return (settings.lineHeight + settings.borderWidth) * (duration * 2) - 1;[m
[31m-  }[m
[31m-[m
[31m-  /**[m
[31m-   * Return top offset of task card based on start time of the task[m
[31m-   * startTime - in hours[m
[31m-   */[m
[31m-  function getCardTopPosition(startTime) {[m
[31m-    return (settings.lineHeight + settings.borderWidth) * (startTime * 2);[m
[31m-  }[m
[31m-[m
[31m-  /**[m
[31m-  * Render card template[m
[31m-  */[m
[31m-  function renderInnerCardContent(task) {[m
[31m-    var result = settings.cardTemplate;[m
[31m-    for (var key in task) {[m
[31m-      if (task.hasOwnProperty(key)) {[m
[31m-        // TODO: replace all[m
[31m-        result = result.replace('${' + key + '}', task[key]);[m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-    return $(result);[m
[31m-  }[m
[31m-[m
[31m-  /**[m
[31m-   * Generate task cards[m
[31m-   */[m
[31m-  function appendTasks(placeholder, tasks) {[m
[31m-    var findCoefficients = function () {[m
[31m-      var coefficients = [];[m
[31m-      for (var i = 0; i < tasks.length - 1; i++) {[m
[31m-        var k = 0;[m
[31m-        var j = i + 1;[m
[31m-        while (j < tasks.length && tasks[i].startTime < tasks[j].startTime[m
[31m-          && tasks[i].startTime + tasks[i].duration > tasks[j].startTime) {[m
[31m-          k++;[m
[31m-          j++;[m
[31m-        }[m
[31m-        coefficients.push(k);[m
[31m-      }[m
[31m-[m
[31m-      coefficients.push(0);[m
[31m-      return coefficients;[m
[31m-    };[m
[31m-[m
[31m-    var normalize = function (args) {[m
[31m-      var indexes = {};[m
[31m-      for (var i = 0; i < args.length; i++) {[m
[31m-        var start = i;[m
[31m-        var count = 0;[m
[31m-        while (args[i] != 0) {[m
[31m-          i++;[m
[31m-          count++;[m
[31m-        }[m
[31m-        var end = i;[m
[31m-        if (count) {[m
[31m-          count++;[m
[31m-        }[m
[31m-[m
[31m-        var index = 0;[m
[31m-        for (var j = start; j <= end; j++) {[m
[31m-          args[j] = count;[m
[31m-          indexes[j] = index++;[m
[31m-        }[m
[31m-      }[m
[31m-[m
[31m-      return {args: args, indexes: indexes};[m
[31m-    };[m
[31m-[m
[31m-    var args =[m
[31m-      normalize([m
[31m-        findCoefficients()[m
[31m-      );[m
[31m-    if ( windowWidth < 500) {[m
[31m-      var widht_default = 90;[m
[31m-    }else{[m
[31m-      var widht_default = 194;[m
[31m-    }[m
[31m-    for (var i = 0; i < args.args.length; i++) {[m
[31m-      var width = widht_default / (args.args[i] || 1);[m
[31m-      tasks[i].width = width;[m
[31m-      tasks[i].left = (args.indexes[i] * width) || 4;[m
[31m-    }[m
[31m-[m
[31m-    tasks.forEach(function (task, index) {[m
[31m-      var innerContent = renderInnerCardContent(task);[m
[31m-      var top = getCardTopPosition(task.startTime-9) + 2;[m
[31m-      var height = getCardHeight(task.duration);[m
[31m-      if ( windowWidth < 500) {[m
[31m-        var width = task.width || 194*0.5;[m
[31m-      }else{[m
[31m-       var width = task.width || 194;[m
[31m-      }[m
[31m-      var left = task.left || 4;[m
[31m-      var card = $('<div></div>')[m
[31m-        .attr({[m
[31m-          id: 'scheduler-task',[m
[31m-          style: 'top: ' + top + 'px; height: ' + (height - 4) + 'px; ' + 'width: ' + (width - 8) + 'px; left: ' + left + 'px',[m
[31m-          title: toTimeString(task.startTime) + ' - ' + toTimeString(task.startTime + task.duration)[m
[31m-        });[m
[31m-      card.on('click', function (e) { settings.onClick && settings.onClick(e, task) });[m
[31m-      card.append(innerContent)[m
[31m-        .appendTo(placeholder);[m
[31m-      });[m
[31m-  }[m
[31m-  [m
[31m-  /**[m
[31m-  * Generate scheduler grid with task cards[m
[31m-  * options:[m
[31m-  * - headers: string[] - array of headers[m
[31m-  * - tasks: Task[] - array of tasks[m
[31m-  * - containerCssClass: string - css class of main container[m
[31m-  * - headerContainerCssClass: string - css class of header container[m
[31m-  * - schedulerContainerCssClass: string - css class of scheduler[m
[31m-  * - lineHeight - height of one half-hour cell in grid[m
[31m-  * - borderWidth - width of border of cell in grid[m
[31m-  */[m
[31m-  $.fn.skeduler = function (options) {[m
[31m-    settings = $.extend(defaultSettings, options);[m
[31m-[m
[31m-    if (settings.debug) {[m
[31m-      console.time('skeduler');[m
[31m-    }[m
[31m-[m
[31m-    var skedulerEl = $(this);[m
[31m-[m
[31m-    skedulerEl.empty();[m
[31m-    skedulerEl.addClass(settings.containerCssClass);[m
[31m-[m
[31m-    var div = $('<div></div>');[m
[31m-[m
[31m-    // Add headers[m
[31m-    var headerContainer = div.clone().addClass(settings.headerContainerCssClass);[m
[31m-    settings.headers.forEach(function (element) {[m
[31m-      div.clone().text(element).appendTo(headerContainer);[m
[31m-    }, this);[m
[31m-    skedulerEl.append(headerContainer);[m
[31m-[m
[31m-    // Add schedule[m
[31m-    var scheduleEl = div.clone().addClass(settings.schedulerContainerCssClass);[m
[31m-    var scheduleTimelineEl = div.clone().addClass(settings.schedulerContainerCssClass + '-timeline');[m
[31m-    var scheduleBodyEl = div.clone().addClass(settings.schedulerContainerCssClass + '-body');[m
[31m-[m
[31m-    var gridColumnElement = div.clone();[m
[31m-[m
[31m-    for (var i = 9; i < 19; i++) {[m
[31m-      // Populate timeline[m
[31m-      div.clone()[m
[31m-        .text(toTimeString(i))[m
[31m-        .appendTo(scheduleTimelineEl);[m
[31m-      div.clone().appendTo(scheduleTimelineEl);[m
[31m-      if(i%2==0){[m
[31m-        gridColumnElement.append(div.clone().addClass(settings.cellCssClass));[m
[31m-        gridColumnElement.append(div.clone().addClass(settings.cellCssClass));[m
[31m-      }else{[m
[31m-        gridColumnElement.append(div.clone().addClass(settings.oddCellCssClass));[m
[31m-        gridColumnElement.append(div.clone().addClass(settings.oddCellCssClass));[m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-    // Populate grid[m
[31m-    for (var j = 0; j < settings.headers.length; j++) {[m
[31m-      var el = gridColumnElement.clone();[m
[31m-[m
[31m-      var placeholder = div.clone().addClass(settings.taskPlaceholderCssClass);[m
[31m-      appendTasks(placeholder, settings.tasks.filter(function (t) { return t.column == j }));[m
[31m-[m
[31m-      el.prepend(placeholder);[m
[31m-      el.appendTo(scheduleBodyEl);[m
[31m-    }[m
[31m-[m
[31m-    scheduleEl.append(scheduleTimelineEl);[m
[31m-    scheduleEl.append(scheduleBodyEl);[m
[31m-[m
[31m-    skedulerEl.append(scheduleEl);[m
[31m-[m
[31m-    if (settings.debug) {[m
[31m-      console.timeEnd('skeduler');[m
[31m-    }[m
[31m-[m
[31m-    return skedulerEl;[m
[31m-  };[m
[32m+[m[32m(function ($) {[m[41m[m
[32m+[m[32m  $win = $(window);[m[41m[m
[32m+[m[32m  var windowWidth = $win.width();[m[41m[m
[32m+[m[32m  console.log(windowWidth);[m[41m[m
[32m+[m[32m  var defaultSettings = {[m[41m[m
[32m+[m[32m    // Data attributes[m[41m[m
[32m+[m[32m    headers: [],  // String[] - Array of column headers[m[41m[m
[32m+[m[32m    tasks: [],    // Task[] - Array of tasks. Required fields:[m[41m [m
[32m+[m[32m    // id: number, startTime: number, duration: number, column: number[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // Card template - Inner content of task card.[m[41m [m
[32m+[m[32m    // You're able to use ${key} inside template, where key is any property from task.[m[41m[m
[32m+[m[32m    cardTemplate: '<div>${id}</div>',[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // OnClick event handler[m[41m[m
[32m+[m[32m    onClick: function (e, task) { },[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // Css classes[m[41m[m
[32m+[m[32m    containerCssClass: 'skeduler-container',[m[41m[m
[32m+[m[32m    headerContainerCssClass: 'skeduler-headers',[m[41m[m
[32m+[m[32m    schedulerContainerCssClass: 'skeduler-main',[m[41m[m
[32m+[m[32m    taskPlaceholderCssClass: 'skeduler-task-placeholder',[m[41m[m
[32m+[m[32m    cellCssClass: 'skeduler-cell',[m[41m[m
[32m+[m[32m    oddCellCssClass: 'odd skeduler-cell',[m[41m[m
[32m+[m[32m    lineHeight: 30,      // height of one half-hour line in grid[m[41m[m
[32m+[m[32m    borderWidth: 1,      // width of board of grid cell[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    debug: false[m[41m[m
[32m+[m[32m  };[m[41m[m
[32m+[m[32m  var settings = {};[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  /**[m[41m[m
[32m+[m[32m   * Convert double value of hours to zero-preposited string with 30 or 00 value of minutes[m[41m[m
[32m+[m[32m   */[m[41m[m
[32m+[m[32m  function toTimeString(value) {[m[41m[m
[32m+[m[32m    return (value < 10 ? '0' : '') + Math.floor(value) + (Math.ceil(value) > Math.floor(value) ? ':30' : ':00');[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  /**[m[41m[m
[32m+[m[32m   * Return height of task card based on duration of the task[m[41m[m
[32m+[m[32m   * duration - in hours[m[41m[m
[32m+[m[32m   */[m[41m[m
[32m+[m[32m  function getCardHeight(duration) {[m[41m[m
[32m+[m[32m    return (settings.lineHeight + settings.borderWidth) * (duration * 2) - 1;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  /**[m[41m[m
[32m+[m[32m   * Return top offset of task card based on start time of the task[m[41m[m
[32m+[m[32m   * startTime - in hours[m[41m[m
[32m+[m[32m   */[m[41m[m
[32m+[m[32m  function getCardTopPosition(startTime) {[m[41m[m
[32m+[m[32m    return (settings.lineHeight + settings.borderWidth) * (startTime * 2);[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  /**[m[41m[m
[32m+[m[32m  * Render card template[m[41m[m
[32m+[m[32m  */[m[41m[m
[32m+[m[32m  function renderInnerCardContent(task) {[m[41m[m
[32m+[m[32m    var result = settings.cardTemplate;[m[41m[m
[32m+[m[32m    for (var key in task) {[m[41m[m
[32m+[m[32m      if (task.hasOwnProperty(key)) {[m[41m[m
[32m+[m[32m        // TODO: replace all[m[41m[m
[32m+[m[32m        result = result.replace('${' + key + '}', task[key]);[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    return $(result);[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  /**[m[41m[m
[32m+[m[32m   * Generate task cards[m[41m[m
[32m+[m[32m   */[m[41m[m
[32m+[m[32m  function appendTasks(placeholder, tasks) {[m[41m[m
[32m+[m[32m    var findCoefficients = function () {[m[41m[m
[32m+[m[32m      var coefficients = [];[m[41m[m
[32m+[m[32m      for (var i = 0; i < tasks.length - 1; i++) {[m[41m[m
[32m+[m[32m        var k = 0;[m[41m[m
[32m+[m[32m        var j = i + 1;[m[41m[m
[32m+[m[32m        while (j < tasks.length && tasks[i].startTime < tasks[j].startTime[m[41m[m
[32m+[m[32m          && tasks[i].startTime + tasks[i].duration > tasks[j].startTime) {[m[41m[m
[32m+[m[32m          k++;[m[41m[m
[32m+[m[32m          j++;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        coefficients.push(k);[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m      coefficients.push(0);[m[41m[m
[32m+[m[32m      return coefficients;[m[41m[m
[32m+[m[32m    };[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    var normalize = function (args) {[m[41m[m
[32m+[m[32m      var indexes = {};[m[41m[m
[32m+[m[32m      for (var i = 0; i < args.length; i++) {[m[41m[m
[32m+[m[32m        var start = i;[m[41m[m
[32m+[m[32m        var count = 0;[m[41m[m
[32m+[m[32m        while (args[i] != 0) {[m[41m[m
[32m+[m[32m          i++;[m[41m[m
[32m+[m[32m          count++;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        var end = i;[m[41m[m
[32m+[m[32m        if (count) {[m[41m[m
[32m+[m[32m          count++;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m        var index = 0;[m[41m[m
[32m+[m[32m        for (var j = start; j <= end; j++) {[m[41m[m
[32m+[m[32m          args[j] = count;[m[41m[m
[32m+[m[32m          indexes[j] = index++;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m      return {args: args, indexes: indexes};[m[41m[m
[32m+[m[32m    };[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    var args =[m[41m[m
[32m+[m[32m      normalize([m[41m[m
[32m+[m[32m        findCoefficients()[m[41m[m
[32m+[m[32m      );[m[41m[m
[32m+[m[32m    if ( windowWidth < 500) {[m[41m[m
[32m+[m[32m      var widht_default = 90;[m[41m[m
[32m+[m[32m    }else{[m[41m[m
[32m+[m[32m      var widht_default = 194;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    for (var i = 0; i < args.args.length; i++) {[m[41m[m
[32m+[m[32m      var width = widht_default / (args.args[i] || 1);[m[41m[m
[32m+[m[32m      tasks[i].width = width;[m[41m[m
[32m+[m[32m      tasks[i].left = (args.indexes[i] * width) || 4;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    tasks.forEach(function (task, index) {[m[41m[m
[32m+[m[32m      var innerContent = renderInnerCardContent(task);[m[41m[m
[32m+[m[32m      var top = getCardTopPosition(task.startTime-9) + 2;[m[41m[m
[32m+[m[32m      var height = getCardHeight(task.duration);[m[41m[m
[32m+[m[32m      if ( windowWidth < 500) {[m[41m[m
[32m+[m[32m        var width = task.width || 194*0.5;[m[41m[m
[32m+[m[32m      }else{[m[41m[m
[32m+[m[32m       var width = task.width || 194;[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      var left = task.left || 4;[m[41m[m
[32m+[m[32m      var card = $('<div></div>')[m[41m[m
[32m+[m[32m        .attr({[m[41m[m
[32m+[m[32m          id: 'scheduler-task',[m[41m[m
[32m+[m[32m          style: 'top: ' + top + 'px; height: ' + (height - 4) + 'px; ' + 'width: ' + (width - 8) + 'px; left: ' + left + 'px',[m[41m[m
[32m+[m[32m          title: toTimeString(task.startTime) + ' - ' + toTimeString(task.startTime + task.duration)[m[41m[m
[32m+[m[32m        });[m[41m[m
[32m+[m[32m      card.on('click', function (e) { settings.onClick && settings.onClick(e, task) });[m[41m[m
[32m+[m[32m      card.append(innerContent)[m[41m[m
[32m+[m[32m        .appendTo(placeholder);[m[41m[m
[32m+[m[32m      });[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m  [m
[32m+[m[32m  /**[m[41m[m
[32m+[m[32m  * Generate scheduler grid with task cards[m[41m[m
[32m+[m[32m  * options:[m[41m[m
[32m+[m[32m  * - headers: string[] - array of headers[m[41m[m
[32m+[m[32m  * - tasks: Task[] - array of tasks[m[41m[m
[32m+[m[32m  * - containerCssClass: string - css class of main container[m[41m[m
[32m+[m[32m  * - headerContainerCssClass: string - css class of header container[m[41m[m
[32m+[m[32m  * - schedulerContainerCssClass: string - css class of scheduler[m[41m[m
[32m+[m[32m  * - lineHeight - height of one half-hour cell in grid[m[41m[m
[32m+[m[32m  * - borderWidth - width of border of cell in grid[m[41m[m
[32m+[m[32m  */[m[41m[m
[32m+[m[32m  $.fn.skeduler = function (options) {[m[41m[m
[32m+[m[32m    settings = $.extend(defaultSettings, options);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    if (settings.debug) {[m[41m[m
[32m+[m[32m      console.time('skeduler');[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    var skedulerEl = $(this);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    skedulerEl.empty();[m[41m[m
[32m+[m[32m    skedulerEl.addClass(settings.containerCssClass);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    var div = $('<div></div>');[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // Add headers[m[41m[m
[32m+[m[32m    var headerContainer = div.clone().addClass(settings.headerContainerCssClass);[m[41m[m
[32m+[m[32m    settings.headers.forEach(function (element) {[m[41m[m
[32m+[m[32m      div.clone().text(element).appendTo(headerContainer);[m[41m[m
[32m+[m[32m    }, this);[m[41m[m
[32m+[m[32m    skedulerEl.append(headerContainer);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // Add schedule[m[41m[m
[32m+[m[32m    var scheduleEl = div.clone().addClass(settings.schedulerContainerCssClass);[m[41m[m
[32m+[m[32m    var scheduleTimelineEl = div.clone().addClass(settings.schedulerContainerCssClass + '-timeline');[m[41m[m
[32m+[m[32m    var scheduleBodyEl = div.clone().addClass(settings.schedulerContainerCssClass + '-body');[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    var gridColumnElement = div.clone();[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    for (var i = 9; i < 19; i++) {[m[41m[m
[32m+[m[32m      // Populate timeline[m[41m[m
[32m+[m[32m      div.clone()[m[41m[m
[32m+[m[32m        .text(toTimeString(i))[m[41m[m
[32m+[m[32m        .appendTo(scheduleTimelineEl);[m[41m[m
[32m+[m[32m      div.clone().appendTo(scheduleTimelineEl);[m[41m[m
[32m+[m[32m      if(i%2==0){[m[41m[m
[32m+[m[32m        gridColumnElement.append(div.clone().addClass(settings.cellCssClass));[m[41m[m
[32m+[m[32m        gridColumnElement.append(div.clone().addClass(settings.cellCssClass));[m[41m[m
[32m+[m[32m      }else{[m[41m[m
[32m+[m[32m        gridColumnElement.append(div.clone().addClass(settings.oddCellCssClass));[m[41m[m
[32m+[m[32m        gridColumnElement.append(div.clone().addClass(settings.oddCellCssClass));[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // Populate grid[m[41m[m
[32m+[m[32m    for (var j = 0; j < settings.headers.length; j++) {[m[41m[m
[32m+[m[32m      var el = gridColumnElement.clone();[m[41m[m
[32m+[m[41m[m
[32m+[m[32m      var placeholder = div.clone().addClass(settings.taskPlaceholderCssClass);[m[41m[m
[32m+[m[32m      appendTasks(placeholder, settings.tasks.filter(function (t) { return t.column == j }));[m[41m[m
[32m+[m[41m[m
[32m+[m[32m      el.prepend(placeholder);[m[41m[m
[32m+[m[32m      el.appendTo(scheduleBodyEl);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    scheduleEl.append(scheduleTimelineEl);[m[41m[m
[32m+[m[32m    scheduleEl.append(scheduleBodyEl);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    skedulerEl.append(scheduleEl);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    if (settings.debug) {[m[41m[m
[32m+[m[32m      console.timeEnd('skeduler');[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    return skedulerEl;[m[41m[m
[32m+[m[32m  };[m[41m[m
 }(jQuery));[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/fancybox/skeduler.js b/static/themes/landscape/source/fancybox/skeduler.js[m
[1mindex 469e6dc..39dd689 100644[m
[1m--- a/static/themes/landscape/source/fancybox/skeduler.js[m
[1m+++ b/static/themes/landscape/source/fancybox/skeduler.js[m
[36m@@ -1,194 +1,194 @@[m
[31m-(function generate() {[m
[31m-  console.log("generate");[m
[31m-  var tasks = [];[m
[31m-  var places = ["第一体育館", "第二体育館", "購買前", "企画"][m
[31m-  var data = [[{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": "10.5",[m
[31m-      "duration": 2,[m
[31m-      "end_time": 11,[m
[31m-      "place": "第一体育館",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription1"[m
[31m-    },{[m
[31m-      "timestamp": "13:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": "14.30",[m
[31m-      "end_time": "12:00",[m
[31m-      "place": "第一体育館",[m
[31m-      "duration": 1,[m
[31m-      "name" : "name2",[m
[31m-      "from": "けいおん",[m
[31m-      "content": "discription5"[m
[31m-    },{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 15,[m
[31m-      "duration": 1,[m
[31m-      "end_time": 11,[m
[31m-      "place": "第一体育館",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription6"[m
[31m-    }],[{[m
[31m-      "timestamp": "13:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 11,[m
[31m-      "end_time": "12:00",[m
[31m-      "place": "第二体育館",[m
[31m-      "duration": 1,[m
[31m-      "name" : "name2",[m
[31m-      "from": "けいおん",[m
[31m-      "content": "discription2"[m
[31m-    },{[m
[31m-      "timestamp": "13:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 11,[m
[31m-      "end_time": "12:00",[m
[31m-      "place": "第二体育館",[m
[31m-      "duration": 1,[m
[31m-      "name" : "name2",[m
[31m-      "from": "けいおん",[m
[31m-      "content": "discription2"[m
[31m-    },{[m
[31m-      "timestamp": "13:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 13,[m
[31m-      "end_time": "12:00",[m
[31m-      "place": "第二体育館",[m
[31m-      "duration": 1,[m
[31m-      "name" : "name2",[m
[31m-      "from": "けいおん",[m
[31m-      "content": "discription2"[m
[31m-    },{[m
[31m-      "timestamp": "13:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 14,[m
[31m-      "end_time": "12:00",[m
[31m-      "place": "第二体育館",[m
[31m-      "duration": 2,[m
[31m-      "name" : "name2",[m
[31m-      "from": "けいおん",[m
[31m-      "content": "discription2"[m
[31m-    }],[{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 16,[m
[31m-      "duration": 1,[m
[31m-      "end_time": 11,[m
[31m-      "place": "購買前",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription3"[m
[31m-    },{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 13,[m
[31m-      "duration": 1,[m
[31m-      "end_time": 11,[m
[31m-      "place": "購買前",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription4"[m
[31m-    },{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 10,[m
[31m-      "duration": 1,[m
[31m-      "end_time": 11,[m
[31m-      "place": "購買前",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription3"[m
[31m-    },{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 17,[m
[31m-      "duration": 1,[m
[31m-      "end_time": 11,[m
[31m-      "place": "購買前",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription4"[m
[31m-    }],[{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 12,[m
[31m-      "duration": 1,[m
[31m-      "end_time": 11,[m
[31m-      "place": "企画",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription3"[m
[31m-    },{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 13,[m
[31m-      "duration": 1,[m
[31m-      "end_time": 11,[m
[31m-      "place": "企画",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription4"[m
[31m-    },{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 9,[m
[31m-      "duration": 1,[m
[31m-      "end_time": 11,[m
[31m-      "place": "企画",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription3"[m
[31m-    },{[m
[31m-      "timestamp": "12:30",[m
[31m-      "date" : 21,[m
[31m-      "start_time": 17,[m
[31m-      "duration": 1,[m
[31m-      "end_time": 11,[m
[31m-      "place": "企画",[m
[31m-      "name" : "name",[m
[31m-      "from": "brassband",[m
[31m-      "content": "discription4"[m
[31m-    }]][m
[31m-  var date = new Date();[m
[31m-  function getNow() {[m
[31m-    function to_string(d) {[m
[31m-      return (d < 10) ? '0' + d.toString() : d.toString();[m
[31m-    }[m
[31m-    var date = new Date();[m
[31m-    var now = `${to_string(date.getDay())}/${date.getHours()}:${date.getMinutes()}`[m
[31m-    console.log(now);[m
[31m-    return now;[m
[31m-  }[m
[31m-  for (var i = 0; i < places.length; i++) {[m
[31m-    for (var j = 0; j < data[i].length; j++) {[m
[31m-      startTime=data[i][j].start_time;[m
[31m-      //width 0->100% 0.5->half[m
[31m-      duration=data[i][j].duration;[m
[31m-      var columun= places.findIndex(function(x) { x == data[i][j].place; });[m
[31m-[m
[31m-      var columun = places.indexOf(data[i][j].place);[m
[31m-      var task = {[m
[31m-        startTime: startTime,[m
[31m-        duration: duration,[m
[31m-        column: columun,[m
[31m-        id: data[i][j].from,[m
[31m-        title: data[i][j].name,[m
[31m-        content: data[i][j].content,[m
[31m-        width: 0[m
[31m-      };[m
[31m-      tasks.push(task);[m
[31m-    }[m
[31m-  }[m
[31m-  //console.log("tasks count: " + tasks.length);[m
[31m-  //console.log(JSON.stringify(tasks));[m
[31m-  jQuery("#skeduler-container").skeduler({[m
[31m-    headers: places,[m
[31m-    tasks: tasks,[m
[31m-    cardTemplate: '<div>${id}</div><div>${title}</div><div class="hide-content">${content}</div>',[m
[31m-    onClick: function (e, t) { console.log(e, t); }[m
[31m-  });[m
[32m+[m[32m(function generate() {[m[41m[m
[32m+[m[32m  console.log("generate");[m[41m[m
[32m+[m[32m  var tasks = [];[m[41m[m
[32m+[m[32m  var places = ["第一体育館", "第二体育館", "購買前", "企画"][m[41m[m
[32m+[m[32m  var data = [[{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": "10.5",[m[41m[m
[32m+[m[32m      "duration": 2,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "第一体育館",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription1"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "13:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": "14.30",[m[41m[m
[32m+[m[32m      "end_time": "12:00",[m[41m[m
[32m+[m[32m      "place": "第一体育館",[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "name" : "name2",[m[41m[m
[32m+[m[32m      "from": "けいおん",[m[41m[m
[32m+[m[32m      "content": "discription5"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 15,[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "第一体育館",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription6"[m[41m[m
[32m+[m[32m    }],[{[m[41m[m
[32m+[m[32m      "timestamp": "13:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 11,[m[41m[m
[32m+[m[32m      "end_time": "12:00",[m[41m[m
[32m+[m[32m      "place": "第二体育館",[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "name" : "name2",[m[41m[m
[32m+[m[32m      "from": "けいおん",[m[41m[m
[32m+[m[32m      "content": "discription2"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "13:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 11,[m[41m[m
[32m+[m[32m      "end_time": "12:00",[m[41m[m
[32m+[m[32m      "place": "第二体育館",[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "name" : "name2",[m[41m[m
[32m+[m[32m      "from": "けいおん",[m[41m[m
[32m+[m[32m      "content": "discription2"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "13:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 13,[m[41m[m
[32m+[m[32m      "end_time": "12:00",[m[41m[m
[32m+[m[32m      "place": "第二体育館",[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "name" : "name2",[m[41m[m
[32m+[m[32m      "from": "けいおん",[m[41m[m
[32m+[m[32m      "content": "discription2"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "13:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 14,[m[41m[m
[32m+[m[32m      "end_time": "12:00",[m[41m[m
[32m+[m[32m      "place": "第二体育館",[m[41m[m
[32m+[m[32m      "duration": 2,[m[41m[m
[32m+[m[32m      "name" : "name2",[m[41m[m
[32m+[m[32m      "from": "けいおん",[m[41m[m
[32m+[m[32m      "content": "discription2"[m[41m[m
[32m+[m[32m    }],[{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 16,[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "購買前",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription3"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 13,[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "購買前",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription4"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 10,[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "購買前",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription3"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 17,[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "購買前",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription4"[m[41m[m
[32m+[m[32m    }],[{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 12,[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "企画",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription3"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 13,[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "企画",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription4"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 9,[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "企画",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription3"[m[41m[m
[32m+[m[32m    },{[m[41m[m
[32m+[m[32m      "timestamp": "12:30",[m[41m[m
[32m+[m[32m      "date" : 21,[m[41m[m
[32m+[m[32m      "start_time": 17,[m[41m[m
[32m+[m[32m      "duration": 1,[m[41m[m
[32m+[m[32m      "end_time": 11,[m[41m[m
[32m+[m[32m      "place": "企画",[m[41m[m
[32m+[m[32m      "name" : "name",[m[41m[m
[32m+[m[32m      "from": "brassband",[m[41m[m
[32m+[m[32m      "content": "discription4"[m[41m[m
[32m+[m[32m    }]][m[41m[m
[32m+[m[32m  var date = new Date();[m[41m[m
[32m+[m[32m  function getNow() {[m[41m[m
[32m+[m[32m    function to_string(d) {[m[41m[m
[32m+[m[32m      return (d < 10) ? '0' + d.toString() : d.toString();[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    var date = new Date();[m[41m[m
[32m+[m[32m    var now = `${to_string(date.getDay())}/${date.getHours()}:${date.getMinutes()}`[m[41m[m
[32m+[m[32m    console.log(now);[m[41m[m
[32m+[m[32m    return now;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m  for (var i = 0; i < places.length; i++) {[m[41m[m
[32m+[m[32m    for (var j = 0; j < data[i].length; j++) {[m[41m[m
[32m+[m[32m      startTime=data[i][j].start_time;[m[41m[m
[32m+[m[32m      //width 0->100% 0.5->half[m[41m[m
[32m+[m[32m      duration=data[i][j].duration;[m[41m[m
[32m+[m[32m      var columun= places.findIndex(function(x) { x == data[i][j].place; });[m[41m[m
[32m+[m[41m[m
[32m+[m[32m      var columun = places.indexOf(data[i][j].place);[m[41m[m
[32m+[m[32m      var task = {[m[41m[m
[32m+[m[32m        startTime: startTime,[m[41m[m
[32m+[m[32m        duration: duration,[m[41m[m
[32m+[m[32m        column: columun,[m[41m[m
[32m+[m[32m        id: data[i][j].from,[m[41m[m
[32m+[m[32m        title: data[i][j].name,[m[41m[m
[32m+[m[32m        content: data[i][j].content,[m[41m[m
[32m+[m[32m        width: 0[m[41m[m
[32m+[m[32m      };[m[41m[m
[32m+[m[32m      tasks.push(task);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m  //console.log("tasks count: " + tasks.length);[m[41m[m
[32m+[m[32m  //console.log(JSON.stringify(tasks));[m[41m[m
[32m+[m[32m  jQuery("#skeduler-container").skeduler({[m[41m[m
[32m+[m[32m    headers: places,[m[41m[m
[32m+[m[32m    tasks: tasks,[m[41m[m
[32m+[m[32m    cardTemplate: '<div>${id}</div><div>${title}</div><div class="hide-content">${content}</div>',[m[41m[m
[32m+[m[32m    onClick: function (e, t) { console.log(e, t); }[m[41m[m
[32m+[m[32m  });[m[41m[m
 })(jQuery);[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/js/jquery.flex-images.min.js b/static/themes/landscape/source/js/jquery.flex-images.min.js[m
[1mindex caaa1c2..fb63606 100644[m
[1m--- a/static/themes/landscape/source/js/jquery.flex-images.min.js[m
[1m+++ b/static/themes/landscape/source/js/jquery.flex-images.min.js[m
[36m@@ -1,3 +1,3 @@[m
[31m-// jQuery flexImages v1.0.4[m
[31m-// https://github.com/Pixabay/jQuery-flexImages[m
[32m+[m[32m// jQuery flexImages v1.0.4[m[41m[m
[32m+[m[32m// https://github.com/Pixabay/jQuery-flexImages[m[41m[m
 !function(t){function e(t,a,r,n){function o(t){r.maxRows&&d>r.maxRows||r.truncate&&t&&d>1?w[g][0].style.display="none":(w[g][4]&&(w[g][3].attr("src",w[g][4]),w[g][4]=""),w[g][0].style.width=l+"px",w[g][0].style.height=u+"px",w[g][0].style.display="block")}var g,l,s=1,d=1,f=t.width()-2,w=[],c=0,u=r.rowHeight;for(f||(f=t.width()-2),i=0;i<a.length;i++)if(w.push(a[i]),c+=a[i][2]+r.margin,c>=f){var m=w.length*r.margin;for(s=(f-m)/(c-m),u=Math.ceil(r.rowHeight*s),exact_w=0,l,g=0;g<w.length;g++)l=Math.ceil(w[g][2]*s),exact_w+=l+r.margin,exact_w>f&&(l-=exact_w-f),o();w=[],c=0,d++}for(g=0;g<w.length;g++)l=Math.floor(w[g][2]*s),h=Math.floor(r.rowHeight*s),o(!0);n||f==t.width()||e(t,a,r,!0)}t.fn.flexImages=function(a){var i=t.extend({container:".item",object:"img",rowHeight:180,maxRows:0,truncate:0},a);return this.each(function(){var a=t(this),r=t(a).find(i.container),n=[],o=(new Date).getTime(),h=window.getComputedStyle?getComputedStyle(r[0],null):r[0].currentStyle;for(i.margin=(parseInt(h.marginLeft)||0)+(parseInt(h.marginRight)||0)+(Math.round(parseFloat(h.borderLeftWidth))||0)+(Math.round(parseFloat(h.borderRightWidth))||0),j=0;j<r.length;j++){var g=r[j],l=parseInt(g.getAttribute("data-w")),s=l*(i.rowHeight/parseInt(g.getAttribute("data-h"))),d=t(g).find(i.object);n.push([g,l,s,d,d.data("src")])}e(a,n,i),t(window).off("resize.flexImages"+a.data("flex-t")),t(window).on("resize.flexImages"+o,function(){e(a,n,i)}),a.data("flex-t",o)})}}(jQuery);[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/js/lineat.js b/static/themes/landscape/source/js/lineat.js[m
[1mindex 6213930..fa6667e 100644[m
[1m--- a/static/themes/landscape/source/js/lineat.js[m
[1m+++ b/static/themes/landscape/source/js/lineat.js[m
[36m@@ -1,47 +1,47 @@[m
[31m-window.addEventListener("load",mapInfo);[m
[31m-[m
[31m-var h_mapinfo = document.getElementById("mapinfo");[m
[31m-var h_thisinfo = document.getElementById("thisinfo");[m
[31m-[m
[31m-/**[m
[31m- * スマホ・タブレットサイズのデバイスがmapから来た時の対処[m
[31m- */[m
[31m-function mapInfo(){[m
[31m-  var h_mapinfo = document.getElementById("mapinfo");[m
[31m-  var h_thisinfo = document.getElementById("thisinfo"); [m
[31m-  if(getParam("map") == "true"){[m
[31m-    var htmltext = "mapから来ましたね。<br>";[m
[31m-    WriteInfo(h_mapinfo,htmltext);[m
[31m-    WriteInfo(h_thisinfo,"");[m
[31m-  }[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * 指定したパラメータを取得[m
[31m- * @param {str} name : パラメータ名[m
[31m- * @return {object} p_obj[name] : パラメータに対応する値 [m
[31m- */[m
[31m-function getParam(name) {[m
[31m-  var p_obj = new Object;[m
[31m-  //console.log(reloadCount);[m
[31m-  var p_all = location.search.substring(1).split('&');[m
[31m-  // パラメータを指定しない場合、return Outside[m
[31m-  if(p_all == ""){[m
[31m-    return "false";[m
[31m-  }[m
[31m-  // pair[i]が存在しない場合はいらない[m
[31m-  for(i=0;p_all[i];i++){[m
[31m-    var keyValue = p_all[i].split('=');[m
[31m-    p_obj[keyValue[0]]=keyValue[1];[m
[31m-  }[m
[31m-  return p_obj[name];[m
[31m-}[m
[31m-[m
[31m-/**[m
[31m- * 指定したIDの箇所にhtmlを埋め込む[m
[31m- * @param {document.getElementById()} id [m
[31m- * @param {str} htmltext [m
[31m- */[m
[31m-function WriteInfo(id,htmltext){[m
[31m-  id.innerHTML = htmltext;[m
[32m+[m[32mwindow.addEventListener("load",mapInfo);[m[41m[m
[32m+[m[41m[m
[32m+[m[32mvar h_mapinfo = document.getElementById("mapinfo");[m[41m[m
[32m+[m[32mvar h_thisinfo = document.getElementById("thisinfo");[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * スマホ・タブレットサイズのデバイスがmapから来た時の対処[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction mapInfo(){[m[41m[m
[32m+[m[32m  var h_mapinfo = document.getElementById("mapinfo");[m[41m[m
[32m+[m[32m  var h_thisinfo = document.getElementById("thisinfo");[m[41m [m
[32m+[m[32m  if(getParam("map") == "true"){[m[41m[m
[32m+[m[32m    var htmltext = "mapから来ましたね。<br>";[m[41m[m
[32m+[m[32m    WriteInfo(h_mapinfo,htmltext);[m[41m[m
[32m+[m[32m    WriteInfo(h_thisinfo,"");[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * 指定したパラメータを取得[m[41m[m
[32m+[m[32m * @param {str} name : パラメータ名[m[41m[m
[32m+[m[32m * @return {object} p_obj[name] : パラメータに対応する値[m[41m [m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction getParam(name) {[m[41m[m
[32m+[m[32m  var p_obj = new Object;[m[41m[m
[32m+[m[32m  //console.log(reloadCount);[m[41m[m
[32m+[m[32m  var p_all = location.search.substring(1).split('&');[m[41m[m
[32m+[m[32m  // パラメータを指定しない場合、return Outside[m[41m[m
[32m+[m[32m  if(p_all == ""){[m[41m[m
[32m+[m[32m    return "false";[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m  // pair[i]が存在しない場合はいらない[m[41m[m
[32m+[m[32m  for(i=0;p_all[i];i++){[m[41m[m
[32m+[m[32m    var keyValue = p_all[i].split('=');[m[41m[m
[32m+[m[32m    p_obj[keyValue[0]]=keyValue[1];[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m  return p_obj[name];[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * 指定したIDの箇所にhtmlを埋め込む[m[41m[m
[32m+[m[32m * @param {document.getElementById()} id[m[41m [m
[32m+[m[32m * @param {str} htmltext[m[41m [m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction WriteInfo(id,htmltext){[m[41m[m
[32m+[m[32m  id.innerHTML = htmltext;[m[41m[m
 }[m
\ No newline at end of file[m
[1mdiff --git a/static/themes/landscape/source/js/map.js b/static/themes/landscape/source/js/map.js[m
[1mindex 056e764..3c2bda1 100644[m
[1m--- a/static/themes/landscape/source/js/map.js[m
[1m+++ b/static/themes/landscape/source/js/map.js[m
[36m@@ -1,1166 +1,1282 @@[m
[31m-/*[m
[31m-変数命名規則[m
[31m-g_-- : 全体マップにおくオブジェクト[m
[31m-j_-- : JSONから持ってきたデータ[m
[31m-a_-- : 外・エリアごとに配置するオブジェクト[m
[31m-c_-- : 構内マップTOPにおくオブジェクト[m
[31m-b_-- : 構内マップの各棟についてのオブジェクト[m
[31m-f_-- : 構内のフロア内オブジェクト[m
[31m-m_-- : MAP画像[m
[31m-h_-- : html(DOM)[m
[31m-e_-- : eventチェック用[m
[31m-z_-- : Hexoに入れた時の座標調整用[m
[31m-p_-- : URLパラメータ[m
[31m-d_-- : デバッグ用[m
[31m-// *z : 後から座標指定しなきゃダメなところ[m
[31m-// ** comment  後から実装するべきところ[m
[31m-// *p : pathが配置されていること[m
[31m-*/[m
[31m-[m
[31m-window.addEventListener("load",WidthCheck);[m
[31m- /**[m
[31m- * windowの横幅を見て、スマホ～タブレットサイズの場合別リンクに飛ばす。[m
[31m- */[m
[31m-function WidthCheck(){[m
[31m-  console.log(window.innerWidth);[m
[31m-  if(window.innerWidth < 1100) GoLINELink();[m
[31m-  else Load();[m
[31m-}[m
[31m-/**[m
[31m- * 別リンクに飛ばす(window.location.assign("url")))[m
[31m- */[m
[31m-function GoLINELink(){[m
[31m-  console.log("end");[m
[31m-  window.location.assign("https://kunugida2018.tokyo-ct.ac.jp/lineat/?map=true");[m
[31m-  window.msg.textContent = "Moving...";[m
[31m-  setInterval(()=>window.msg.textContent+=".", 10);[m
[31m-}[m
[31m-// 読み込んで初期化して表示するMAP位置[m
[31m-var currentMapID = "OutsideTop";[m
[31m-var reloadCount  = 0;[m
[31m-var p_location;[m
[31m-// 読み込み・再読み込み（リロード時にも入る）[m
[31m-function Load(){[m
[31m-  // reload時の処理 ----------------------------------------[m
[31m-  p_location = "reload";[m
[31m-  reloadCount+=1;// リロードした回数をカウントする[m
[31m-  var queue = new createjs.LoadQueue(true);[m
[31m-  var manifest = [[m
[31m-    {"src":"/data/mapImgData.json","id":"mapImgs"},[m
[31m-    {"src":"/data/boothsample.json","id":"booth"},[m
[31m-    {"src":"/data/boothID.json","id":"boothID"}[m
[31m-  ];[m
[31m-  queue.loadManifest(manifest,true);[m
[31m-  queue.addEventListener("complete",init);[m
[31m-}[m
[31m-[m
[31m-// 指定したパラメータを取得 key : name[m
[31m-function getParam(name) {[m
[31m-    var p_obj = new Object;[m
[31m-    //console.log(reloadCount);[m
[31m-    var p_all = location.search.substring(1).split('&');[m
[31m-    // パラメータを指定しない場合、return Outside[m
[31m-    if(p_all == ""){[m
[31m-      return "OutsideTop";[m
[31m-    }[m
[31m-    // pair[i]が存在しない場合はいらない[m
[31m-    for(i=0;p_all[i];i++){[m
[31m-      var keyValue = p_all[i].split('=');[m
[31m-      p_obj[keyValue[0]]=keyValue[1];[m
[31m-    }[m
[31m-    return p_obj[name];[m
[31m-}[m
[31m-// JSONデータが読み込まれたら入る[m
[31m-function init(event){[m
[31m-  var j_mapImgsData   = event.target.getResult("mapImgs");　// mapImgData.json[m
[31m-  var j_boothData     = event.target.getResult("booth");[m
[31m-  var j_boothID       = event.target.getResult("boothID");[m
[31m-  // URLパラメータの取得 ----------------------------------------------------------------------------------------------[m
[31m-  //console.log(getParam("booth"));[m
[31m-  // 一覧ページから入る処理[m
[31m-  if(reloadCount==1) p_location = getParam("booth");[m
[31m-  console.log(p_location);[m
[31m-  // - canvas stageの定義 --------------------------------------------------------------------------------------------[m
[31m-  var canvasContainer = document.getElementById("wrap");[m
[31m-  var canvasElement   = document.getElementById("myCanvas");[m
[31m-  var dh_pindata      = document.getElementById("pin");[m
[31m-  var h_boothdata     = document.getElementById("boothdata");[m
[31m-  // CanvasSizeの大きさ画面サイズに設定する（初期化）[m
[31m-  var Sizing = function(){[m
[31m-    canvasElement.height = canvasElement.offsetHeight;[m
[31m-    canvasElement.width  = canvasElement.offsetWidth;[m
[31m-  }[m
[31m-  // CanvasSizeの大きさ画面サイズに設定する（初期化）[m
[31m-  Sizing();[m
[31m-  // - stageの定義[m
[31m-  var stage = new createjs.StageGL(canvasElement);[m
[31m-  // ---------------------------------------------------------------------------------------------------------------   [m
[31m-  var DisplayContainer = new createjs.Container();                                  // 表示用コンテナ[m
[31m-  stage.addChild(DisplayContainer);[m
[31m-  DisplayContainer.cache(0,0,canvasElement.width,canvasElement.height);[m
[31m-  stage.setClearColor('#343434');[m
[31m-  var gm_general      = new createjs.Bitmap("/img/" + j_mapImgsData.Generalview); // 構外MAP全体画像　すべての基準はこの画像になる。// *p[m
[31m-  main();[m
[31m-  // -- タッチ操作有効化[m
[31m-  if(createjs.Touch.isSupported() == true){[m
[31m-    createjs.Touch.enable(stage);[m
[31m-  }[m
[31m-  // -- 画像の読み込み >> 画像のサイズを返す------------------------[m
[31m-  // return 配列 [0] : width [1] : height[m
[31m-  function getImageSize(bitmap){[m
[31m-    return new Promise(function(resolve,reject){[m
[31m-      bitmap.image.onload = function(){[m
[31m-        var size =[this.width,this.height];[m
[31m-        resolve(size);[m
[31m-      }[m
[31m-    });[m
[31m-  }[m
[31m-[m
[31m-  // -- canvasのサイズを変更する ---------------------------------[m
[31m-  function ChangeCanvasSize(width,height){[m
[31m-    canvasElement.style.width = width;[m
[31m-    canvasElement.style.height = height;[m
[31m-  }[m
[31m-[m
[31m-  // -- main main(async) : このあとの処理は全てここ　------------------------------------------------------------------[m
[31m-  async function main(){[m
[31m-    [m
[31m-    // :: canvas の大きさの調整----------------------------------------------------------------------------------------[m
[31m-    // 基準となる画像（構外MAP全体画像）のサイズを取得する。[m
[31m-    var bmp_size = await getImageSize(gm_general); // size[0] : width  size[1] : height[m
[31m-    //画像のスケールの計算[m
[31m-    gm_general.scaleX = canvasContainer.offsetWidth / bmp_size[0];[m
[31m-    gm_general.scaleY = gm_general.scaleX;[m
[31m-    //canvasSizeの調整　全体MAP画像の大きさと同じ大きさにする[m
[31m-    ChangeCanvasSize(gm_general.image.width * gm_general.scaleX,gm_general.image.height * gm_general.scaleY);[m
[31m-    // 高さを中心に合わせる (基準）(縦横比によって可変する値)[m
[31m-    var z_General = {};[m
[31m-    z_General.x = 0;[m
[31m-    z_General.y = (canvasElement.height-(gm_general.image.height * gm_general.scaleY))/2;[m
[31m-    gm_general.y = z_General.y;[m
[31m-    [m
[31m-    // :: 親子構造の構築-----------------------------------------------------------------------------------------------[m
[31m-    // 構外MAP内に配置するオブジェクトの定義[m
[31m-    var OutsideContainer   = new createjs.Container();   // 構外マップで表示されるオブジェクト[m
[31m-    var areaContainers     = [];                         // 各エリアのデータ [A,B,C,D,E,F][m
[31m-    var g_rects            = [];                         // エリアの四角 [エリア][m
[31m-    var g_areaTexts        = ["A","B","C","D","E","F"];  // エリアのテキスト情報[m
[31m-    // --- 1. 全体マップの配置 ----------------------------------------------------------------------------------------[m
[31m-    // --- 1.1 構外MAP全体画像の配置 --------------------------------------------------------------[m
[31m-    OutsideContainer.addChild(gm_general); [m
[31m-    // --- 1.2 エリア分け用のオブジェクトの配置----------------------------------------------------[m
[31m-    for(var i=0;i<j_mapImgsData.AreaRects.length;i++){[m
[31m-      // ---- 1.2.1 エリア用の四角の配置 ----------------------------------------------------------[m
[31m-      var j_rect          = j_mapImgsData.AreaRects[i];[m
[31m-      g_rects[i]          = new createjs.Shape();[m
[31m-      g_rects[i].graphics.beginFill(j_rect.color); // ** 色分けしたいなら後で配列を宣言しましょう[m
[31m-      g_rects[i].graphics.drawRoundRect(0,0,j_rect.width * gm_general.scaleX,j_rect.height * gm_general.scaleY, 20* gm_general.scaleX);[m
[31m-      g_rects[i].x        = j_rect.x * gm_general.scaleX + z_General.x ; // 位置座標セット[m
[31m-      g_rects[i].y        = j_rect.y * gm_general.scaleY + z_General.y ; // 位置座標セット[m
[31m-      g_rects[i].alpha    = 0.15;                       // 透明度[m
[31m-      // ---- 1.2.2 エリア用の四角に対する枠線用オブジェクトの配置 --------------------------------[m
[31m-      var g_rectStroke = new createjs.Shape();[m
[31m-      g_rectStroke.graphics.beginStroke(j_rect.color);[m
[31m-      g_rectStroke.graphics.setStrokeStyle(5 * gm_general.scaleX); // * gm_general.scaleX[m
[31m-      g_rectStroke.graphics.drawRoundRect(0,0,j_rect.width * gm_general.scaleX,j_rect.height * gm_general.scaleY,20 * gm_general.scaleX);      [m
[31m-      g_rectStroke.x      = g_rects[i].x;[m
[31m-      g_rectStroke.y      = g_rects[i].y;[m
[31m-      // ---- 1.2.3 エリア用の四角に乗せるテキストオブジェクトの配置-------------------------------[m
[31m-      var textSize        = 100 * gm_general.scaleX;[m
[31m-      var g_text          = new createjs.Text(g_areaTexts[i], textSize +"px selif",j_rect.color);[m
[31m-      g_text.x            = (j_rect.x + parseInt(j_rect.width /2) ) * gm_general.scaleX + z_General.x;[m
[31m-      g_text.y            = (j_rect.y + parseInt(j_rect.height/2) ) * gm_general.scaleY + z_General.y;[m
[31m-      g_text.textAlign    = "center";[m
[31m-      g_text.textBaseline = "middle";[m
[31m-      // ---- 1.2.4 配置しかく用オブジェクトを配置する --------------------------------------------[m
[31m-      OutsideContainer.addChild(g_rects[i]);[m
[31m-      OutsideContainer.addChild(g_rectStroke);[m
[31m-      OutsideContainer.addChild(g_text);[m
[31m-    }[m
[31m-    // --- 1.2 構外MAP全体へ画像の配置 --------------------------------------------------------------[m
[31m-    var toCampusArrow = new createjs.Bitmap("/img/" + j_mapImgsData.ToCampusArrow); // *p[m
[31m-    // 位置、角度のセット[m
[31m-    toCampusArrow.scaleX   = gm_general.scaleX * 0.9;[m
[31m-    toCampusArrow.scaleY   = gm_general.scaleY * 0.9;[m
[31m-    toCampusArrow.x        = 2600 * gm_general.scaleX + z_General.x; // *z 座標を入れよう[m
[31m-    toCampusArrow.y        = 200 * gm_general.scaleY + z_General.y;  // *z[m
[31m-    OutsideContainer.addChild(toCampusArrow);[m
[31m-[m
[31m-    // --- 2. 小エリアの配置 ------------------------------------------------------------------------------------------[m
[31m-    var am_sizes_tmp       = [];                         // await時間短縮用[m
[31m-    var am_sizes           = [];                         // エリアごとに分けたときの画像のサイズ[m
[31m-    var am_imgs            = [];                         // エリアごとに分けたときの画像[m
[31m-    var a_toGenerals       = [];                         // エリアから全体に戻るときの画像[m
[31m-    var outSidePins_r      = [];                         // 校外のピンたちの上に隠れている四角（outSidePins_r[Area][num]) [m
[31m-    var a_pinContainers    = [];                         // エリアごとのピン（画像）が格納されたコンテナが格納 [エリア][番号][m
[31m-    var a_toDisplayPins    = [];                         // ピン非表示する画像[m
[31m-    var a_toHidePins       = [];                         // ピンを表示する画像[m
[31m-    // --- 2.1 各エリアの拡大画像の大きさの取得---------------------------------------------------[m
[31m-    for(var i=0;i<j_mapImgsData.OutsideAreas.length;i++){[m
[31m-      var am_img      = new createjs.Bitmap("/img/" + j_mapImgsData.OutsideAreas[i].img); // *p[m
[31m-      am_sizes_tmp[i] = getImageSize(am_img);[m
[31m-    }[m
[31m-    // await時間短縮[m
[31m-    for(var i=0;i<j_mapImgsData.OutsideAreas.length;i++)am_sizes[i] = await am_sizes_tmp[i];[m
[31m-    // --- 2.2 小エリア内オブジェクトの配置--------------------------------------------------------[m
[31m-    for(var i=0;i<j_mapImgsData.OutsideAreas.length;i++){[m
[31m-      var a_PageContainer = new createjs.Container(); // i番目のエリアのデータが全部入る[m
[31m-      var a_PinContainer  = new createjs.Container(); // ピンがいっぱい入る[m
[31m-      // ---- 2.2.1 各エリアの拡大画像の配置 ------------------------------------------------------[m
[31m-      var am_img          = new createjs.Bitmap("/img/" + j_mapImgsData.OutsideAreas[i].img);// *p[m
[31m-      var am_size         = am_sizes[i];[m
[31m-      am_imgs.push(am_img);[m
[31m-      // ---- canvasのサイズに画像を合わせる。----------------------------------------------------[m
[31m-      if((canvasElement.width/am_size[0]) * am_size[1] > canvasElement.height){[m
[31m-        // 縦横比が合わないと高さがcanvasを超える問題の対処[m
[31m-        am_img.scaleX = canvasElement.height / am_size[1];[m
[31m-        am_img.scaleY = am_img.scaleX;[m
[31m-        am_img.x = ( (canvasElement.width - am_img.scaleY * am_size[0])/2 );[m
[31m-      }else{[m
[31m-        // scale : 現在のcanvasSize / am_img.width [m
[31m-        am_img.scaleX = canvasElement.width / am_size[0];[m
[31m-        am_img.scaleY = am_img.scaleX;[m
[31m-        am_img.y = ( (canvasElement.height - am_img.scaleX * am_size[1])/2 );[m
[31m-      }[m
[31m-      // ------------------------------------------------------------------------------------------[m
[31m-      a_PageContainer.addChild(am_img);[m
[31m-      // ---- 2.2.2 各エリアに配置されるピンの設置 ------------------------------------------------[m
[31m-      // 青ピント赤ピンのサイズは同じ[m
[31m-      var a_pins         = []; //　エリアにおけるピンの画像が入る [エリア][m
[31m-      var a_pin1Tmp      = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_1); // *p  // blue[m
[31m-      var pin1Size       = await getImageSize(a_pin1Tmp); // pinの画像サイズを取得[m
[31m-      for(var j=0;j<j_mapImgsData.OutsideAreas[i].pins.length;j++){[m
[31m-        // ----- 2.2.2.1 エリアにおけるピンの画像の設置 -------------------------------------------[m
[31m-        var a_pin        = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_1); // *p[m
[31m-        a_pin.scaleX     = gm_general.scaleX;[m
[31m-        a_pin.scaleY     = gm_general.scaleY;[m
[31m-        a_pin.x          = j_mapImgsData.OutsideAreas[i].pins[j].x * am_img.scaleX + am_img.x;[m
[31m-        a_pin.y          = j_mapImgsData.OutsideAreas[i].pins[j].y * am_img.scaleY + am_img.y;[m
[31m-        a_PinContainer.addChild(a_pin);[m
[31m-        // ----- 2.2.2.1.2 エリアにおけるピンの画像の設置 2 (red) ---------------------------------[m
[31m-        var a_pin2       = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_2); // *p[m
[31m-        a_pin2.scaleX    = gm_general.scaleX;[m
[31m-        a_pin2.scaleY    = gm_general.scaleY;[m
[31m-        a_pin2.alpha     = 0;[m
[31m-        a_pin2.x         = j_mapImgsData.OutsideAreas[i].pins[j].x * am_img.scaleX + am_img.x;[m
[31m-        a_pin2.y         = j_mapImgsData.OutsideAreas[i].pins[j].y * am_img.scaleY + am_img.y;[m
[31m-        a_PinContainer.addChild(a_pin2);     [m
[31m-        // ----- 2.2.2.2 エリアにおけるピンの画像の上に配置する四角の設置 -------------------------[m
[31m-        var a_pin_rect   = new createjs.Shape();[m
[31m-        a_pin_rect.graphics.beginFill("White");[m
[31m-        a_pin_rect.graphics.drawRect(0,0,pin1Size[0] * a_pin.scaleX,pin1Size[1] * a_pin.scaleY);      [m
[31m-        a_pin_rect.x     = a_pin.x;[m
[31m-        a_pin_rect.y     = a_pin.y;[m
[31m-        a_pin_rect.alpha = 0.0059; // *z 透明度の変更[m
[31m-        // a_pin_rect.alpha = 0.5;[m
[31m-        a_PinContainer.addChild(a_pin_rect);[m
[31m-        a_pins.push(a_pin_rect);//pinの上に係る四角形たちを入れる（クリック判定は透明の四角形）[m
[31m-      }[m
[31m-      outSidePins_r.push(a_pins);[m
[31m-      a_PageContainer.addChild(a_PinContainer);[m
[31m-      a_pinContainers.push(a_PinContainer);[m
[31m-      // ---- 2.2.3 各エリアに配置される「Generalへ戻る画像」の設置 -------------------------------[m
[31m-      var a_toGeneral = new createjs.Bitmap("/img/" + j_mapImgsData.GotoGeneralImg); // *p[m
[31m-      a_toGeneral.scaleX = gm_general.scaleX;[m
[31m-      a_toGeneral.scaleY = gm_general.scaleY;[m
[31m-      a_toGeneral.x      = j_mapImgsData.OutsideAreas[i].goGeneral.x * gm_general.scaleX + am_img.x;[m
[31m-      a_toGeneral.y      = j_mapImgsData.OutsideAreas[i].goGeneral.y * gm_general.scaleY + am_img.y;[m
[31m-      a_PageContainer.addChild(a_toGeneral);[m
[31m-      a_toGenerals.push(a_toGeneral);[m
[31m-      // ---- 2.2.4 各エリアに配置される「ピンを表示する画像」の設置 ------------------------------[m
[31m-      var a_toDisplayPin = new createjs.Bitmap("/img/" + j_mapImgsData.ToDisplayPinImg); // *p[m
[31m-      a_toDisplayPin.scaleX = gm_general.scaleX * 0.9;[m
[31m-      a_toDisplayPin.scaleY = gm_general.scaleY * 0.9;[m
[31m-      a_toDisplayPin.x      = j_mapImgsData.OutsideAreas[i].toDisplayPins.x * gm_general.scaleX + am_img.x;[m
[31m-      a_toDisplayPin.y      = j_mapImgsData.OutsideAreas[i].toDisplayPins.y * gm_general.scaleY + am_img.y;[m
[31m-      a_toDisplayPin.alpha  = 0;[m
[31m-      a_PageContainer.addChild(a_toDisplayPin);[m
[31m-      a_toDisplayPins.push(a_toDisplayPin);[m
[31m-      // ---- 2.2.5 各エリアに配置される「ピンを非表示にする画像」の設置 --------------------------[m
[31m-      var a_toHidePin    = new createjs.Bitmap("/img/" + j_mapImgsData.ToHidePinImg); // *p[m
[31m-      a_toHidePin.scaleX = gm_general.scaleX * 0.9;[m
[31m-      a_toHidePin.scaleY = gm_general.scaleY * 0.9;[m
[31m-      a_toHidePin.x      = j_mapImgsData.OutsideAreas[i].toHidePins.x * gm_general.scaleX + am_img.x;[m
[31m-      a_toHidePin.y      = j_mapImgsData.OutsideAreas[i].toHidePins.y * gm_general.scaleY + am_img.y;[m
[31m-      a_toHidePin.alpha  = 1;[m
[31m-      a_PageContainer.addChild(a_toHidePin);[m
[31m-      a_toHidePins.push(a_toHidePin);[m
[31m-      // このページのデータを格納[m
[31m-      areaContainers.push(a_PageContainer);[m
[31m-    }[m
[31m-[m
[31m-    // --- 3. 構内マップの配置 ----------------------------------------------------------------------------------------[m
[31m-    var InsideTopContainer = new createjs.Container();   // 構内マップで表示されるオブジェクトが格納されている。[m
[31m-    var cm_img             = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.top); // *p[m
[31m-    // --- 3.1 構内マップTOPの画像サイズの取得 ----------------------------------------------------[m
[31m-    var cm_size = await getImageSize(cm_img);[m
[31m-    var c_rects = []; // 構内から棟に[m
[31m-    // --- 3.2 canvasのサイズに構内マップTOP画像を合わせる ----------------------------------------[m
[31m-    if((canvasElement.width/cm_size[0]) * cm_size[1] > canvasElement.height){[m
[31m-      // 縦横比が合わないと高さがcanvasを超える問題の対処[m
[31m-      cm_img.scaleX = canvasElement.height / cm_size[1];[m
[31m-      cm_img.scaleY = cm_img.scaleX;[m
[31m-      cm_img.x = ( (canvasElement.width - cm_img.scaleY * cm_size[0])/2 );[m
[31m-    }else{[m
[31m-      // scale : 現在のcanvasSize / am_img.width [m
[31m-      cm_img.scaleX = canvasElement.width / cm_size[0];[m
[31m-      cm_img.scaleY = cm_img.scaleX;[m
[31m-      cm_img.y = ( (canvasElement.height - cm_img.scaleX * cm_size[1])/2 );[m
[31m-    }[m
[31m-    InsideTopContainer.addChild(cm_img);[m
[31m-    // ---  3.2「構外への矢印画像」の設置 ---------------------------------------------------------[m
[31m-    var toOutsideArrow = new createjs.Bitmap("/img/" + j_mapImgsData.ToOutsideArrow); // *p[m
[31m-    // 位置、角度のセット[m
[31m-    toOutsideArrow.scaleX = gm_general.scaleX * 0.9;[m
[31m-    toOutsideArrow.scaleY = gm_general.scaleY * 0.9;[m
[31m-    toOutsideArrow.x      = 80 * gm_general.scaleX + cm_img.x; // *z 座標を入れよう[m
[31m-    toOutsideArrow.y      = 0 * gm_general.scaleY + cm_img.y; // *z[m
[31m-    InsideTopContainer.addChild(toOutsideArrow);[m
[31m-    // --- 3.3 構内から棟に飛ぶ時の四角 (吹き出しを出すものもある) --------------------------------[m
[31m-    for(var i=0;i<j_mapImgsData.Campus.buildingRects.length;i++){[m
[31m-      var c_rect   = new createjs.Shape();[m
[31m-      var j_rect   = j_mapImgsData.Campus.buildingRects[i];[m
[31m-      c_rect.graphics.beginFill("White");[m
[31m-      c_rect.graphics.drawRect(0,0,j_rect.width * gm_general.scaleX,j_rect.height * gm_general.scaleY);[m
[31m-      c_rect.x     = j_rect.x * gm_general.scaleX + cm_img.x; // 位置座標セット[m
[31m-      c_rect.y     = j_rect.y * gm_general.scaleY + cm_img.y; // 位置座標セット[m
[31m-      c_rect.alpha = 0.0059;                       // 透明度[m
[31m-      // c_rect.alpha = 0.5;[m
[31m-      InsideTopContainer.addChild(c_rect);[m
[31m-      c_rects.push(c_rect);[m
[31m-    }[m
[31m-    // --- 3.4 構内マップに表示される吹き出し画像・吹き出しの上に表示されるオブジェクトの設置 -----[m
[31m-    var balloonContainers = []; // 吹き出しと同時に表示されるオブジェクトが格納される[m
[31m-    var c_balloons        = []; // 吹き出したち[m
[31m-    var c_balloonsRects   = []; // 吹き出しの上の全てのオブジェクト [吹き出し番号][吹き出し内番号][m
[31m-    //吹き出しとその上に配置されるオブジェクトの配置[m
[31m-    for(var i=0;i<j_mapImgsData.Campus.balloons.length;i++){[m
[31m-      var BalloonContainer = new createjs.Container();                       // 吹き出しとその上に乗る四角が格納[m
[31m-      var j_balloon        = j_mapImgsData.Campus.balloons[i];[m
[31m-      var j_balloonRect    = j_mapImgsData.Campus.balloonRects[i]; [m
[31m-      // ---- 3.4.1 吹き出し画像の設置 ------------------------------------------------------------[m
[31m-      var c_balloon        = new createjs.Bitmap("/img/" + j_balloon.img); // 吹き出し画像 // *p[m
[31m-      var c_balloonRects   = [];                                             // i番目吹き出しに載せられる四角たちが格納されている。[m
[31m-      c_balloon.scaleX     = gm_general.scaleX * 0.26; // *z スケール調整[m
[31m-      c_balloon.scaleY     = gm_general.scaleY *0.26; // *z[m
[31m-      c_balloon.x          = j_balloon.x * gm_general.scaleX + cm_img.x;[m
[31m-      c_balloon.y          = j_balloon.y * gm_general.scaleY + cm_img.y;[m
[31m-      BalloonContainer.addChild(c_balloon);[m
[31m-      c_balloons.push(c_balloon);[m
[31m-      // ---- 3.4.2 吹き出しの上の四角形たちの設置 ------------------------------------------------[m
[31m-      for(var j=0;j<j_balloonRect.length;j++){[m
[31m-        var c_balloonRect   = new createjs.Shape();[m
[31m-        c_balloonRect.graphics.beginFill("White");[m
[31m-        c_balloonRect.graphics.drawRect(0,0,j_balloonRect[j].width * gm_general.scaleX,j_balloonRect[j].height * gm_general.scaleY);[m
[31m-        c_balloonRect.x     = j_balloonRect[j].x * gm_general.scaleX + cm_img.x; // 位置座標セット[m
[31m-        c_balloonRect.y     = j_balloonRect[j].y * gm_general.scaleY + cm_img.y; // 位置座標セット[m
[31m-        c_balloonRect.alpha = 0.0059;                      // 透明度[m
[31m-        // c_balloonRect.alpha = 0.5;[m
[31m-        BalloonContainer.addChild(c_balloonRect);[m
[31m-        c_balloonRects.push(c_balloonRect);[m
[31m-      }[m
[31m-      c_balloonsRects.push(c_balloonRects);[m
[31m-      balloonContainers.push(BalloonContainer);[m
[31m-    }[m
[31m-[m
[31m-    // --- 4. 棟と階のMAPの配置 ---------------------------------------------------------------------------------------[m
[31m-    var BuildingFloorContainers = []; // 棟・階のデータが格納されたコンテナが格納される[棟][階][m
[31m-    var bfm_sizes_tmp           = []; // await時間短縮用 [棟][階][m
[31m-    var bfm_sizes               = []; // 棟・階におけるマップ画像のサイズ[棟][階][m
[31m-    var bf_toCampusTops         = []; // 構内マップTOPへ飛ぶ矢印 [棟][階][m
[31m-    var bf_pins                 = []; // 構内の全てのピン格納用　bf_pins[棟][階][ピン番号][m
[31m-    var bf_toUpper              = []; // 上の階へ [棟][階][m
[31m-    var bf_toLower              = []; // 下の階へ [棟][階][m
[31m-    var bf_toDisplayPins        = []; // ピンを表示する[棟][階][m
[31m-    var bf_toHidePins           = []; // ピンを非表示にする[棟][階][m
[31m-    /*[m
[31m-    棟・階は０から始まり、2.3.5.8棟しかフロアを表示しないため、プログラム上でのi棟j階は実際の値とは違う。[m
[31m-    その辺はJSONでも全て共通させている。イベントの検知～イベントに対応する処理で実際の階に結び付ける。[m
[31m-    棟（実際の棟）　     階  （実際の階） [m
[31m-    0     (2)         0,1,2,3 (1,2,3,4)[m
[31m-    1     (3)         0,1,2,3 (1,2,3,4)[m
[31m-    2     (5)         0,1     (1,2)[m
[31m-    3     (8)         0,1     (1,2)[m
[31m-    */[m
[31m-    // --- 4.1 各フロア拡大画像のサイズの取得 -----------------------------------------------------[m
[31m-    for(var i=0;i<j_mapImgsData.Campus.buildings.length;i++){[m
[31m-      bfm_sizes_tmp[i] = []; // 2次元配列化[m
[31m-      for(var j=0;j<j_mapImgsData.Campus.buildings[i].floorImg.length;j++){[m
[31m-        var fm_img = new createjs.Bitmap("/img/"+ j_mapImgsData.Campus.buildings[i].floorImg[j]); // *p[m
[31m-        bfm_sizes_tmp[i][j] = getImageSize(fm_img);[m
[31m-      }[m
[31m-    }[m
[31m-    // await時間短縮[m
[31m-    for(var i=0;i<j_mapImgsData.Campus.buildings.length;i++){[m
[31m-      bfm_sizes[i]=[];[m
[31m-      for(var j=0;j<j_mapImgsData.Campus.buildings[i].floorImg.length;j++){[m
[31m-        bfm_sizes[i][j] = await bfm_sizes_tmp[i][j];[m
[31m-      }[m
[31m-    }[m
[31m-    // --- 4.2 各フロアオブジェクトの配置 ---------------------------------------------------------[m
[31m-    for(var i=0;i<j_mapImgsData.Campus.buildings.length;i++){[m
[31m-      var FloorContainers = []; // i棟のフロアデータが格納されたコンテナが入る[m
[31m-      bf_toCampusTops[i]  = []; // i棟の中にある全体への画像が格納される（後に.push）[m
[31m-      bf_toUpper[i]       = []; // 上の階へ [i棟][階][m
[31m-      bf_toLower[i]       = []; // 下の階へ [i棟][階][m
[31m-      bf_toDisplayPins[i] = []; // ピンを表示する[棟][階][m
[31m-      bf_toHidePins[i]    = []; // ピンを非表示にする[棟][階][m
[31m-      var b_pins          = []; // 建物におけるピン画像が入る[m
[31m-      for(var j=0;j<j_mapImgsData.Campus.buildings[i].floorImg.length;j++){[m
[31m-        var FloorContainer = new createjs.Container(); // j階のオブジェクトが全て格納される[m
[31m-        // ---- 4.2.1 各フロアの拡大画像の配置 ----------------------------------------------------[m
[31m-        var fm_img         = new createjs.Bitmap("/img/"+ j_mapImgsData.Campus.buildings[i].floorImg[j]); // *p[m
[31m-        var fm_size        = bfm_sizes[i][j];[m
[31m-        // ---- 4.2.2 canvasのサイズに各フロア画像を合わせる。-------------------------------------[m
[31m-        if((canvasElement.width/fm_size[0]) * fm_size[1] > canvasElement.height){[m
[31m-          // 縦横比が合わないと高さがcanvasを超える問題の対処[m
[31m-          fm_img.scaleX = canvasElement.height / fm_size[1];[m
[31m-          fm_img.scaleY = fm_img.scaleX;[m
[31m-          fm_img.x = ( (canvasElement.width - fm_img.scaleY * fm_size[0])/2 );[m
[31m-        }else{[m
[31m-          // scale : 現在のcanvasSize / am_img.width [m
[31m-          fm_img.scaleX = canvasElement.width / fm_size[0];[m
[31m-          fm_img.scaleY = fm_img.scaleX;[m
[31m-          fm_img.y = ( (canvasElement.height - fm_img.scaleX * fm_size[1])/2 );[m
[31m-        }[m
[31m-        FloorContainer.addChild(fm_img);[m
[31m-        // ---- 4.2.3 ピンの設置 ------------------------------------------------------------------[m
[31m-        var f_pins         = [];                       // i棟j階におけるピン画像が全て格納される [m
[31m-        var f_PinContainer = new createjs.Container(); // i棟j階におけるピン画像が全て格納されたコンテナ[m
[31m-        // ---- 4.2.4 ピン画像・サイズの取得 ------------------------------------------------------[m
[31m-        var f_pin1Tmp = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_1); // *p[m
[31m-        var f_pin1Size = await getImageSize(f_pin1Tmp); // pinの画像サイズを取得[m
[31m-        for(var k=0;k<j_mapImgsData.Campus.buildings[i].pins[j].length;k++){[m
[31m-          // ---- 4.2.5.1 ピン画像を設置 ----------------------------------------------------------[m
[31m-          var f_pin    = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_1); // フロア内k番目のピン // *p[m
[31m-          f_pin.scaleX = gm_general.scaleX;[m
[31m-          f_pin.scaleY = gm_general.scaleY;[m
[31m-          f_pin.x      = j_mapImgsData.Campus.buildings[i].pins[j][k].x * gm_general.scaleX + fm_img.x;[m
[31m-          f_pin.y      = j_mapImgsData.Campus.buildings[i].pins[j][k].y * gm_general.scaleY + fm_img.y;[m
[31m-          f_PinContainer.addChild(f_pin);[m
[31m-          // ---- 4.2.5.2 ピン画像を設置 (red) ----------------------------------------------------[m
[31m-          var f_pin2    = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_2); // フロア内k番目のピン // *p[m
[31m-          f_pin2.scaleX = gm_general.scaleX;[m
[31m-          f_pin2.scaleY = gm_general.scaleY;[m
[31m-          f_pin2.alpha  = 0;[m
[31m-          f_pin2.x      = j_mapImgsData.Campus.buildings[i].pins[j][k].x * gm_general.scaleX + fm_img.x;[m
[31m-          f_pin2.y      = j_mapImgsData.Campus.buildings[i].pins[j][k].y * gm_general.scaleY + fm_img.y;[m
[31m-          f_PinContainer.addChild(f_pin2);[m
[31m-          // ---- 4.2.6 ピン画像の上に配置する四角の設置 ------------------------------------------[m
[31m-          var f_pin_rect = new createjs.Shape();                                // フロア内k番目のピンの上に置く四角[m
[31m-          f_pin_rect.graphics.beginFill("White");[m
[31m-          f_pin_rect.graphics.drawRect(0,0,f_pin1Size[0] * f_pin.scaleX,f_pin1Size[1] * f_pin.scaleY);      [m
[31m-          f_pin_rect.x = f_pin.x;[m
[31m-          f_pin_rect.y = f_pin.y;[m
[31m-          f_pin_rect.alpha = 0.0059; // *z 透明度の変更[m
[31m-          // f_pin_rect.alpha = 0.5;[m
[31m-          f_PinContainer.addChild(f_pin_rect);[m
[31m-          f_pins.push(f_pin_rect);//pinの上に係る四角形たちを入れる（クリック判定は透明の四角形）[m
[31m-        }[m
[31m-        b_pins.push(f_pins);[m
[31m-        FloorContainer.addChild(f_PinContainer);[m
[31m-        // ---- 4.2.7 「上の階へ」「3階へ（8棟）」画像の設置 --------------------------------------[m
[31m-        /*[m
[31m-        建物の一番上など、上の階が存在しない所には設置しない。[m
[31m-        主に、jsonから設置する階データを検索し、配置している。[m
[31m-        */[m
[31m-        var f_goULcheck = 0; // 設置できたら1、設置しないなら0[m
[31m-        for(var k=0;k<j_mapImgsData.Campus.buildings[i].goUpper.length;k++){[m
[31m-          // このフロア(j)に上の階へのオブジェクトのデータが格納されていたら[m
[31m-          if(j_mapImgsData.Campus.buildings[i].goUpper[k].floor == j){[m
[31m-            // 上の階へbuttonの設置[m
[31m-            //8棟3階の処理　ここだけ3階への画像になる[m
[31m-            if(i== 3 && j == 0){[m
[31m-              bf_toUpper[i][j] = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goUpperFloorImg_8); // *p[m
[31m-            }else{[m
[31m-              bf_toUpper[i][j] = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goUpperFloorImg); // *p[m
[31m-            }[m
[31m-            bf_toUpper[i][j].scaleX = gm_general.scaleX;[m
[31m-            bf_toUpper[i][j].scaleY = gm_general.scaleY;[m
[31m-            bf_toUpper[i][j].x      = j_mapImgsData.Campus.buildings[i].goUpper[k].x * gm_general.scaleX + fm_img.x;[m
[31m-            bf_toUpper[i][j].y      = j_mapImgsData.Campus.buildings[i].goUpper[k].y * gm_general.scaleY + fm_img.y;[m
[31m-            FloorContainer.addChild(bf_toUpper[i][j]);[m
[31m-            f_goULcheck = 1;[m
[31m-          }[m
[31m-        }[m
[31m-        if(f_goULcheck == 0)bf_toUpper[i][j] = -1; // 上の階へがない場合-1を格納[m
[31m-        // ---- 4.2.8 「上の階へ」「1階へ（8棟）」画像の設置 --------------------------------------[m
[31m-        /*[m
[31m-        建物の一番下など、下の階が存在しない所には設置しない。[m
[31m-        主に、jsonから設置する階データを検索し、配置している。[m
[31m-        */[m
[31m-        f_goULcheck = 0; // 初期化[m
[31m-        for(var k=0;k<j_mapImgsData.Campus.buildings[i].goLower.length;k++){[m
[31m-          // このフロア(j)に下の階へのオブジェクトのデータが格納されていたら[m
[31m-          if(j_mapImgsData.Campus.buildings[i].goLower[k].floor == j){[m
[31m-            // 下の階へbuttonの設置[m
[31m-            if(i== 3 && j == 1){[m
[31m-              //8棟3階の処理　ここだけ1階への画像になる[m
[31m-              bf_toLower[i][j] = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goLowerFloorImg_8); // *p[m
[31m-            }else{[m
[31m-              // それ以外の普通の棟[m
[31m-              bf_toLower[i][j] = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goLowerFloorImg); // *p[m
[31m-            }[m
[31m-            bf_toLower[i][j].scaleX = gm_general.scaleX;[m
[31m-            bf_toLower[i][j].scaleY = gm_general.scaleY;[m
[31m-            bf_toLower[i][j].x      = j_mapImgsData.Campus.buildings[i].goLower[k].x * gm_general.scaleY + fm_img.x;[m
[31m-            bf_toLower[i][j].y      = j_mapImgsData.Campus.buildings[i].goLower[k].y * gm_general.scaleY + fm_img.y;[m
[31m-            FloorContainer.addChild(bf_toLower[i][j]);[m
[31m-            f_goULcheck = 1;[m
[31m-          }[m
[31m-        }[m
[31m-        if(f_goULcheck == 0)bf_toLower[i][j] = -1; // 下の階へがない場合-1を格納[m
[31m-        // ---- 4.2.9 「構内TOPへ」画像の設置 -----------------------------------------------------[m
[31m-        var f_toCampusTop = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goTopArrow); // *p[m
[31m-        f_toCampusTop.scaleX = gm_general.scaleX;[m
[31m-        f_toCampusTop.scaleY = gm_general.scaleY;[m
[31m-        f_toCampusTop.x      = j_mapImgsData.Campus.buildings[i].goTop[j].x * gm_general.scaleX + fm_img.x;[m
[31m-        f_toCampusTop.y      = j_mapImgsData.Campus.buildings[i].goTop[j].y * gm_general.scaleY + fm_img.y;[m
[31m-        FloorContainer.addChild(f_toCampusTop);[m
[31m-        bf_toCampusTops[i].push(f_toCampusTop);[m
[31m-        [m
[31m-        // ---- 4.2.10 「ピンを表示する画像」の設置 -----------------------------------------------[m
[31m-        var f_toDisplayPin = new createjs.Bitmap("/img/" + j_mapImgsData.ToDisplayPinImg); // *p[m
[31m-        f_toDisplayPin.scaleX = gm_general.scaleX * 0.9;[m
[31m-        f_toDisplayPin.scaleY = gm_general.scaleY * 0.9;[m
[31m-        f_toDisplayPin.x      = j_mapImgsData.Campus.buildings[i].toDisplayPins[j].x * gm_general.scaleX + fm_img.x;[m
[31m-        f_toDisplayPin.y      = j_mapImgsData.Campus.buildings[i].toDisplayPins[j].y * gm_general.scaleY + fm_img.y;[m
[31m-        f_toDisplayPin.alpha  = 0;[m
[31m-        FloorContainer.addChild(f_toDisplayPin);[m
[31m-        bf_toDisplayPins[i].push(f_toDisplayPin);[m
[31m-        // ---- 4.2.11 「ピンを非表示にする画像」の設置 -------------------------------------------[m
[31m-        var f_toHidePin = new createjs.Bitmap("/img/" + j_mapImgsData.ToHidePinImg); // *p[m
[31m-        f_toHidePin.scaleX = gm_general.scaleX * 0.9;[m
[31m-        f_toHidePin.scaleY = gm_general.scaleY * 0.9;[m
[31m-        f_toHidePin.x      = j_mapImgsData.Campus.buildings[i].toHidePins[j].x * gm_general.scaleX + fm_img.x;[m
[31m-        f_toHidePin.y      = j_mapImgsData.Campus.buildings[i].toHidePins[j].y * gm_general.scaleY + fm_img.y;[m
[31m-        f_toHidePin.alpha  = 1;[m
[31m-        FloorContainer.addChild(f_toHidePin);[m
[31m-        bf_toHidePins[i].push(f_toHidePin);[m
[31m-        // このページのデータを格納[m
[31m-        FloorContainers.push(FloorContainer);[m
[31m-      }[m
[31m-      bf_pins.push(b_pins);[m
[31m-      bf_toCampusTops.push(bf_toCampusTops[i]); // forループ出たときi+1されるので-1をしている[m
[31m-      BuildingFloorContainers.push(FloorContainers);[m
[31m-    }[m
[31m-    bf_toCampusTops.pop(); // 末尾の要素を削除（末尾の要素が一つ多いエラーの削除）[m
[31m-[m
[31m-    // :: イベントの検知 ----------------------------------------------------------------------------------------------[m
[31m-    var e_balloons        = []; //吹き出しが出ていれば 1 出ていなければ0[m
[31m-    var e_buildNum        = [2,3,5,8]; // 棟の実際の番号（イベント時に結びつける）[m
[31m-    var e_balloonBuildNum = [2,3,8]; // 吹き出しが存在する棟の番号[m
[31m-    for(var i=0;i<j_mapImgsData.Campus.balloons.length;i++)e_balloons.push(0);[m
[31m-    EventListener();　// Eventを感知して処理する関数[m
[31m-[m
[31m-    // :: 初期状態にする。（構外全体MAPを表示）------------------------------------------------------------------------[m
[31m-    if(p_location == "reload") ReloadMapInit();[m
[31m-    else InitMap();[m
[31m-[m
[31m-[m
[31m-    // 最初の読み時の処理 （一回目の読み込み時のみ適用）[m
[31m-    function InitMap(){[m
[31m-      var location = new Object();[m
[31m-      location["target"] = new Object();[m
[31m-      for(var i=0;i<outSidePins_r.length;i++){[m
[31m-        for(var j=0;j<outSidePins_r[i].length;j++){[m
[31m-          switch(p_location){[m
[31m-            case g_areaTexts[i] +(j+1):[m
[31m-              DisplayContainer.addChild(areaContainers[i]);[m
[31m-              location.target.eventParam  = i;[m
[31m-              location.target.eventParam2 = j;[m
[31m-              OutsideWriteInfo(location);[m
[31m-              return;[m
[31m-          }[m
[31m-        }[m
[31m-      }[m
[31m-      for(var i=0;i<bf_pins.length;i++){[m
[31m-        for(var j=0;j<bf_pins[i].length;j++){[m
[31m-          for(var k=0;k<bf_pins[i][j].length;k++){[m
[31m-            switch(p_location){[m
[31m-              case String(e_buildNum[i])+String(j+1)+String(k+1):[m
[31m-                DisplayContainer.addChild(BuildingFloorContainers[i][j]);[m
[31m-                location.target.eventParam  = i;[m
[31m-                location.target.eventParam2 = j;[m
[31m-                location.target.eventParam3 = k;[m
[31m-                InsideWriteInfo(location);[m
[31m-                return;[m
[31m-            }[m
[31m-          }[m
[31m-        }[m
[31m-      }[m
[31m-      if(p_location == "OutsideTop"){[m
[31m-        DisplayContainer.addChild(OutsideContainer);[m
[31m-      }[m
[31m-    }[m
[31m-[m
[31m-    // 再読み込みしたときに正しく表示する関数[m
[31m-    function ReloadMapInit(){[m
[31m-      for(var i=0;i<g_areaTexts.length;i++){[m
[31m-        switch(currentMapID){[m
[31m-          case "Area"+g_areaTexts[i]:[m
[31m-            DisplayContainer.addChild(areaContainers[i]);[m
[31m-            return;[m
[31m-        }[m
[31m-      }[m
[31m-      for(var i=0;i<BuildingFloorContainers.length;i++){[m
[31m-        for(var j=0;j<BuildingFloorContainers[i].length;j++){[m
[31m-          switch(currentMapID){[m
[31m-            case "BF"+ e_buildNum[i]+(parseInt(j)+1):[m
[31m-              DisplayContainer.addChild(BuildingFloorContainers[i][j]);[m
[31m-              return;[m
[31m-          }[m
[31m-        }[m
[31m-      }[m
[31m-      switch(currentMapID){[m
[31m-        case "OutsideTop":[m
[31m-          DisplayContainer.addChild(OutsideContainer);[m
[31m-          return;[m
[31m-        case "InsideTop":[m
[31m-          DisplayContainer.addChild(InsideTopContainer);[m
[31m-          return;[m
[31m-      }[m
[31m-    }[m
[31m-    [m
[31m-    // -- イベントを感知して処理する関数 ------------------------------------------------------------------------------[m
[31m-    function EventListener(){[m
[31m-      // 1. 構内への矢印に対する処理[m
[31m-      toCampusArrow.addEventListener("click",GeneraltoCampusTop);[m
[31m-      // 2. 構外への矢印に対する処理[m
[31m-      toOutsideArrow.addEventListener("click",CampusToptoGeneral);[m
[31m-      // 3. エリアを示す四角に対する処理[m
[31m-      for(var i=0;i<g_rects.length;i++){[m
[31m-        g_rects[i].addEventListener("click",GeneraltoArea); [m
[31m-        g_rects[i].eventParam = i ;[m
[31m-        // 4. エリア内にとんだときに全体エリアに飛ぶ処理[m
[31m-        a_toGenerals[i].addEventListener("click",AreatoGeneral);[m
[31m-        a_toGenerals[i].eventParam = i;[m
[31m-        // 5. 構外MAPピンに対する処理[m
[31m-        for(var j=0;j<j_mapImgsData.OutsideAreas[i].pins.length;j++){[m
[31m-          outSidePins_r[i][j].addEventListener("click",OutsideWriteInfo);[m
[31m-          outSidePins_r[i][j].eventParam  = i;[m
[31m-          outSidePins_r[i][j].eventParam2 = j;[m
[31m-        }[m
[31m-        // 12. ピンを表示するボタンに対する処理[m
[31m-        a_toDisplayPins[i].addEventListener("click",DisplayPins);[m
[31m-        a_toDisplayPins[i].eventParam = i;[m
[31m-        // 13. ピンを非表示にするボタンに対する処理[m
[31m-        a_toHidePins[i].addEventListener("click",HidePins);[m
[31m-        a_toHidePins[i].eventParam = i;[m
[31m-      }[m
[31m-      // 6. 構内の棟を示す四角に対する処理 >> 吹き出しの出現[m
[31m-      for(var i=0;i<c_rects.length;i++){[m
[31m-        //c_rects : 吹き出しを出すための四角[m
[31m-        c_rects[i].addEventListener("click",SetBalloon); // CampusTop to Buildings [m
[31m-        c_rects[i].eventParam = i ;[m
[31m-      }[m
[31m-      // 7. 構内の吹き出しの中身に対する処理[m
[31m-      for(var i=0;i<c_balloons.length;i++){[m
[31m-        for(var j=0;j<c_balloonsRects[i].length;j++){[m
[31m-          c_balloonsRects[i][j].addEventListener("click",BalloontoCampus);[m
[31m-          c_balloonsRects[i][j].eventParam  = i;[m
[31m-          c_balloonsRects[i][j].eventParam2 = j;[m
[31m-        }[m
[31m-      }[m
[31m-      // 8. 構内TOPへに対する処理[m
[31m-      for(var i=0;i<bf_toCampusTops.length;i++){[m
[31m-        for(var j=0;j<bf_toCampusTops[i].length;j++){[m
[31m-          bf_toCampusTops[i][j].addEventListener("click",FloortoCampusTop);[m
[31m-          bf_toCampusTops[i][j].eventParam  = i;[m
[31m-          bf_toCampusTops[i][j].eventParam2 = j;[m
[31m-        }[m
[31m-      }[m
[31m-      // 9. 構内の各ピンに対する処理[m
[31m-      for(var i=0;i<bf_pins.length;i++){[m
[31m-        for(var j=0;j<bf_pins[i].length;j++){[m
[31m-          for(var k=0;k<bf_pins[i][j].length;k++){[m
[31m-            bf_pins[i][j][k].addEventListener("click",InsideWriteInfo);[m
[31m-            bf_pins[i][j][k].eventParam  = i;[m
[31m-            bf_pins[i][j][k].eventParam2 = j;[m
[31m-            bf_pins[i][j][k].eventParam3 = k;[m
[31m-          }[m
[31m-          // 14. ピンを表示するボタンに対する処理[m
[31m-          bf_toDisplayPins[i][j].addEventListener("click",DisplayPins);[m
[31m-          bf_toDisplayPins[i][j].eventParam  = i;[m
[31m-          bf_toDisplayPins[i][j].eventParam2 = j;[m
[31m-          // 15. ピンを表示するボタンに対する処理[m
[31m-          bf_toHidePins[i][j].addEventListener("click",HidePins);[m
[31m-          bf_toHidePins[i][j].eventParam  = i;[m
[31m-          bf_toHidePins[i][j].eventParam2 = j;[m
[31m-        }[m
[31m-      }[m
[31m-      // 10. 上の階へのボタンに対する処理[m
[31m-      for(var i=0;i<bf_toUpper.length;i++){[m
[31m-        for(var j=0;j<bf_toUpper[i].length;j++){[m
[31m-          if(bf_toUpper[i][j]!=-1){[m
[31m-            bf_toUpper[i][j].addEventListener("click",FloortoUpperFloor);[m
[31m-            bf_toUpper[i][j].eventParam  = i;[m
[31m-            bf_toUpper[i][j].eventParam2 = j;[m
[31m-          }[m
[31m-        }[m
[31m-      }[m
[31m-      // 11. 下の階へのボタンに対する処理[m
[31m-      for(var i=0;i<bf_toLower.length;i++){[m
[31m-        for(var j=0;j<bf_toLower[i].length;j++){[m
[31m-          if(bf_toLower[i][j]!=-1){[m
[31m-            bf_toLower[i][j].addEventListener("click",FloortoLowerFloor);[m
[31m-            bf_toLower[i][j].eventParam  = i;[m
[31m-            bf_toLower[i][j].eventParam2 = j;[m
[31m-          }[m
[31m-        }[m
[31m-      } [m
[31m-    }//ここまでEventListener[m
[31m-[m
[31m-    // :: イベントに対する処理　関数群 --------------------------------------------------------------------------------[m
[31m-    // 全体画面から各エリアへ飛ぶ -------------------------------------------------------[m
[31m-    function GeneraltoArea(event){[m
[31m-      var i = event.target.eventParam;[m
[31m-      currentMapID = "Area" + g_areaTexts[i];[m
[31m-      MapChange(OutsideContainer,areaContainers[i]);[m
[31m-    }[m
[31m-    // 構外の各エリアから全体へ ---------------------------------------------------------[m
[31m-    function AreatoGeneral(event){[m
[31m-      var i = event.target.eventParam;[m
[31m-      currentMapID = "OutsideTop";[m
[31m-      MapChange(areaContainers[i],OutsideContainer);[m
[31m-      InitPinColor();[m
[31m-    }[m
[31m-    // 全体から構内topへ ---------------------------------------------------------------[m
[31m-    function GeneraltoCampusTop(event){[m
[31m-      //MapChange(OutsideContainer,InsideTopContainer);[m
[31m-      currentMapID = "InsideTop";[m
[31m-      MapChangeAnimation_Slide(OutsideContainer,InsideTopContainer,"right");[m
[31m-    }[m
[31m-    // 構内Topから全体へ ----------------------------------------------------------------[m
[31m-    function CampusToptoGeneral(event){[m
[31m-      // 吹き出しが出ていたらそれを消す[m
[31m-      for(var k=0;k<c_balloons.length;k++){[m
[31m-        if(e_balloons[k] == 1){[m
[31m-          InsideTopContainer.removeChild(balloonContainers[k]);[m
[31m-          e_balloons[k] = 0;[m
[31m-        }[m
[31m-      }[m
[31m-      //MapChange(InsideTopContainer,OutsideContainer);[m
[31m-      currentMapID = "OutsideTop";[m
[31m-      MapChangeAnimation_Slide(InsideTopContainer,OutsideContainer,"left");      [m
[31m-    }[m
[31m-    // 構内Topから吹き出しを出力 --------------------------------------------------------[m
[31m-    function SetBalloon(event){[m
[31m-      var i = event.target.eventParam;[m
[31m-      // 吹き出しに対応していなければその棟の1階にジャンプ[m
[31m-      var check = false;[m
[31m-      var e_balloonTarget; // 吹き出し対応リストの添え字（吹き出し対応のみ）[m
[31m-      for(var j=0;j<e_balloonBuildNum.length;j++){[m
[31m-        if(e_balloonBuildNum[j] == e_buildNum[i]){[m
[31m-          // 吹き出しに対応していたら[m
[31m-          // j : 棟番号がiのときの吹き出し対応リストの添え字[m
[31m-          e_balloonTarget = j ;[m
[31m-          check = true;[m
[31m-          break;[m
[31m-        }[m
[31m-      }[m
[31m-      if(check==false){[m
[31m-        // 吹き出しに対応していないオブジェクト（5棟など）[m
[31m-        currentMapID = "BF" + e_buildNum[i] + "1";[m
[31m-        MapChange(InsideTopContainer,BuildingFloorContainers[i][0]);[m
[31m-        return;[m
[31m-      }[m
[31m-      // すでに出ている吹き出しをクリックしたとき[m
[31m-      if(e_balloons[e_balloonTarget] == 1){[m
[31m-        InsideTopContainer.removeChild(balloonContainers[e_balloonTarget]);[m
[31m-        e_balloons[e_balloonTarget] = 0;[m
[31m-        return;[m
[31m-      }[m
[31m-      // クリックしたときにほかの吹き出しが開いていた時[m
[31m-      for(var j=0;j<c_balloons.length;j++){[m
[31m-        if(e_balloons[j] == 1){[m
[31m-          InsideTopContainer.removeChild(balloonContainers[j]);[m
[31m-          e_balloons[j] = 0;[m
[31m-        }[m
[31m-      }[m
[31m-      InsideTopContainer.addChild(balloonContainers[e_balloonTarget]);[m
[31m-      e_balloons[e_balloonTarget] = 1;[m
[31m-    }[m
[31m-    // 吹き出しから各棟の階へ -----------------------------------------------------------[m
[31m-    function BalloontoCampus(event){[m
[31m-      var i = event.target.eventParam;[m
[31m-      var j = event.target.eventParam2;[m
[31m-      // e_ballons[i] 棟の吹き出しのj階をクリックした[m
[31m-      //console.log(String(e_balloonBuildNum[i])+"棟の"+String(j)+"階をクリックしました");[m
[31m-      // i,jをBuildingFloorContainerないの適切な値に変更する[m
[31m-      //e_balloonBuildNum = [2,3,8] >> BuildingFloorContainers[i] = [0,1,3]  (2は5棟)[m
[31m-      var buildingIndex = [0,1,3]; //吹き出しから飛べる棟番号(e_balloonBuildNumに対応)[m
[31m-      // 今開いている吹き出しを検索して閉じる[m
[31m-      for(var k=0;k<c_balloons.length;k++){[m
[31m-        if(e_balloons[k] == 1){[m
[31m-          InsideTopContainer.removeChild(balloonContainers[k]);[m
[31m-          e_balloons[k] = 0;[m
[31m-        }[m
[31m-      }[m
[31m-      currentMapID = "BF"+ e_balloonBuildNum[i]+(parseInt(j)+1);[m
[31m-      MapChange(InsideTopContainer,BuildingFloorContainers[buildingIndex[i]][j]);[m
[31m-      //MapChangeAnimation_Fade(InsideTopContainer,BuildingFloorContainers[buildingIndex[i]][j])[m
[31m-    }[m
[31m-    // フロアから構内のトップへ ---------------------------------------------------------[m
[31m-    function FloortoCampusTop(event){[m
[31m-      var i = event.target.eventParam;[m
[31m-      var j = event.target.eventParam2;[m
[31m-      //MapChange(BuildingFloorContainers[i][j],InsideTopContainer);[m
[31m-      currentMapID = "InsideTop";[m
[31m-      MapChangeAnimation_Slide(BuildingFloorContainers[i][j],InsideTopContainer,"left");     [m
[31m-      InitPinColor(); [m
[31m-    }[m
[31m-    // 上の階へ -------------------------------------------------------------------------[m
[31m-    function FloortoUpperFloor(event){[m
[31m-      var i = event.target.eventParam;[m
[31m-      var j = event.target.eventParam2;[m
[31m-      if(bf_toUpper[i][j]==-1)return;[m
[31m-      // MapChange(BuildingFloorContainers[i][j],BuildingFloorContainers[i][j+1]);[m
[31m-      currentMapID = "BF" + e_buildNum[i]+(parseInt(j)+2);[m
[31m-      MapChangeAnimation_Slide(BuildingFloorContainers[i][j],BuildingFloorContainers[i][j+1],"top");[m
[31m-      InitPinColor();[m
[31m-    }[m
[31m-    // 下の階へ -------------------------------------------------------------------------[m
[31m-    function FloortoLowerFloor(event){[m
[31m-      var i = event.target.eventParam;[m
[31m-      var j = event.target.eventParam2;[m
[31m-      if(bf_toLower[i][j]==-1)return;[m
[31m-      currentMapID = "BF" + e_buildNum[i]+(parseInt(j));[m
[31m-      //MapChange(BuildingFloorContainers[i][j],BuildingFloorContainers[i][j-1]);[m
[31m-      MapChangeAnimation_Slide(BuildingFloorContainers[i][j],BuildingFloorContainers[i][j-1],"bottom");[m
[31m-      InitPinColor();[m
[31m-    }[m
[31m-    // ピンを表示 -----------------------------------------------------------------------[m
[31m-    function DisplayPins(event){[m
[31m-      var TimeLine = new createjs.Timeline();[m
[31m-      var changetime = 400;[m
[31m-      for(var i=0;i<a_pinContainers.length;i++){[m
[31m-        for(var j=0;j<a_pinContainers[i].children.length/3;j++){[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(a_pinContainers[i].children[3*j],{override:false})[m
[31m-              .to({alpha : 1},changetime)[m
[31m-          );[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(a_pinContainers[i].children[3*j+1],{override:false})[m
[31m-              .to({alpha : 0},changetime)[m
[31m-          );[m
[31m-          a_pinContainers[i].children[3*j +2].visible = true;[m
[31m-        }[m
[31m-        TimeLine.addTween([m
[31m-          createjs.Tween.get(a_toDisplayPins[i],{override:false})[m
[31m-            .to({alpha : 0},changetime)[m
[31m-        );[m
[31m-        TimeLine.addTween([m
[31m-          createjs.Tween.get(a_toHidePins[i],{override:false})[m
[31m-            .to({alpha : 1},changetime)[m
[31m-        );[m
[31m-      }[m
[31m-      for(var i=0;i<bf_toDisplayPins.length;i++){[m
[31m-        for(var j=0;j<bf_toDisplayPins[i].length;j++){[m
[31m-          // f_PinContainersにアクセスする[m
[31m-          for(var k=0;k<BuildingFloorContainers[i][j].children[1].children.length/3;k++){[m
[31m-            TimeLine.addTween([m
[31m-              createjs.Tween.get(BuildingFloorContainers[i][j].children[1].children[3*k],{override:false})[m
[31m-                .to({alpha : 1},changetime)[m
[31m-            );[m
[31m-            TimeLine.addTween([m
[31m-              createjs.Tween.get(BuildingFloorContainers[i][j].children[1].children[3*k+1],{override:false})[m
[31m-                .to({alpha : 0},changetime)[m
[31m-            );[m
[31m-            BuildingFloorContainers[i][j].children[1].children[3*k+2].visible = true;[m
[31m-          }[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(bf_toDisplayPins[i][j],{override:false})[m
[31m-              .to({alpha : 0},changetime)[m
[31m-          );[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(bf_toHidePins[i][j],{override:false})[m
[31m-              .to({alpha : 1},changetime)[m
[31m-          );[m
[31m-        }[m
[31m-      }[m
[31m-    }[m
[31m-    // ピンを非表示 ---------------------------------------------------------------------[m
[31m-    function HidePins(event){[m
[31m-      var TimeLine = new createjs.Timeline();[m
[31m-      var changetime = 400;[m
[31m-      for(var i=0;i<a_pinContainers.length;i++){[m
[31m-        for(var j=0;j<a_pinContainers[i].children.length/3;j++){[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(a_pinContainers[i].children[3*j],{override:false})[m
[31m-              .to({alpha : 0},changetime)[m
[31m-          );[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(a_pinContainers[i].children[3*j+1],{override:false})[m
[31m-              .to({alpha : 0},changetime)[m
[31m-          );[m
[31m-          a_pinContainers[i].children[3*j+2].visible = false;[m
[31m-        }[m
[31m-        TimeLine.addTween([m
[31m-          createjs.Tween.get(a_toDisplayPins[i],{override:false})[m
[31m-            .to({alpha : 1},changetime)[m
[31m-        );[m
[31m-        TimeLine.addTween([m
[31m-          createjs.Tween.get(a_toHidePins[i],{override:false})[m
[31m-            .to({alpha : 0},changetime)[m
[31m-        );[m
[31m-      }[m
[31m-      for(var i=0;i<bf_toDisplayPins.length;i++){[m
[31m-        for(var j=0;j<bf_toDisplayPins[i].length;j++){[m
[31m-          // f_PinContainersにアクセスする[m
[31m-          for(var k=0;k<BuildingFloorContainers[i][j].children[1].children.length/3;k++){[m
[31m-            TimeLine.addTween([m
[31m-              createjs.Tween.get(BuildingFloorContainers[i][j].children[1].children[3*k],{override:false})[m
[31m-                .to({alpha : 0},changetime)[m
[31m-            );[m
[31m-            TimeLine.addTween([m
[31m-              createjs.Tween.get(BuildingFloorContainers[i][j].children[1].children[3*k+1],{override:false})[m
[31m-                .to({alpha : 0},changetime)[m
[31m-            );[m
[31m-            BuildingFloorContainers[i][j].children[1].children[3*k+2].visible = false;[m
[31m-          }[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(bf_toDisplayPins[i][j],{override:false})[m
[31m-              .to({alpha : 1},changetime)[m
[31m-          );[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(bf_toHidePins[i][j],{override:false})[m
[31m-              .to({alpha : 0},changetime)[m
[31m-          );[m
[31m-        }[m
[31m-      }[m
[31m-      TimeLine.gotoAndPlay("start");[m
[31m-    }[m
[31m-[m
[31m-    // ピンの色の初期化 -----------------------------------------------------------------[m
[31m-    function InitPinColor(){[m
[31m-      // 全てのピンを青色に変化させる[m
[31m-      var TimeLine = new createjs.Timeline();[m
[31m-      var changetime = 0;[m
[31m-      for(var i=0;i<a_pinContainers.length;i++){[m
[31m-        for(var j=0;j<a_pinContainers[i].children.length/3;j++){[m
[31m-          a_pinContainers[i].children[3*j  ].alpha   = 1;[m
[31m-          a_pinContainers[i].children[3*j+1].alpha   = 0;[m
[31m-          a_pinContainers[i].children[3*j+2].visible = true; //rect[m
[31m-        }[m
[31m-      }[m
[31m-      for(var i=0;i<bf_toDisplayPins.length;i++){[m
[31m-        for(var j=0;j<bf_toDisplayPins[i].length;j++){[m
[31m-          // f_PinContainersにアクセスする[m
[31m-          for(var k=0;k<BuildingFloorContainers[i][j].children[1].children.length/3;k++){[m
[31m-            BuildingFloorContainers[i][j].children[1].children[3*k  ].alpha   = 1;[m
[31m-            BuildingFloorContainers[i][j].children[1].children[3*k+1].alpha   = 0;[m
[31m-            BuildingFloorContainers[i][j].children[1].children[3*k+2].visible = true; // rect[m
[31m-          }[m
[31m-        }[m
[31m-      }[m
[31m-      TimeLine.gotoAndPlay("start");[m
[31m-    }[m
[31m-    // ピンの色を変える(構外）-----------------------------------------------------------[m
[31m-    function OutsideChangePinColor(area,pinNum){[m
[31m-      var TimeLine = new createjs.Timeline();[m
[31m-      var changetime = 400;[m
[31m-      // a_pinContainers[area].children[3*pinNum]; >> red Pin[m
[31m-      // a_pinContainrs[area].children[3*pinNum+1] >> blue Pin[m
[31m-      TimeLine.addTween([m
[31m-        createjs.Tween.get(a_pinContainers[area].children[3*pinNum],{override:true})[m
[31m-          .to({alpha:0},changetime)[m
[31m-      );[m
[31m-      TimeLine.addTween([m
[31m-        createjs.Tween.get(a_pinContainers[area].children[3*pinNum+1],{override:true})[m
[31m-          .to({alpha:1},changetime)[m
[31m-      );[m
[31m-      TimeLine.gotoAndPlay("start");[m
[31m-    }[m
[31m-    // ピンの色を変える（構内）----------------------------------------------------------[m
[31m-    function InsideChangePinColor(building,floor,pinNum){[m
[31m-      var TimeLine = new createjs.Timeline();[m
[31m-      var changetime = 400;[m
[31m-      // BuildingFloorContainers[building][floor].children[1].children[3*pinNum]; >> red Pin[m
[31m-      // BuildingFloorContainers[building][floor].children[1].children[3*pinNum]; >> blue Pin[m
[31m-      TimeLine.addTween([m
[31m-        createjs.Tween.get(BuildingFloorContainers[building][floor].children[1].children[3*pinNum],{override:true})[m
[31m-          .to({alpha:0},changetime)[m
[31m-      );[m
[31m-      TimeLine.addTween([m
[31m-        createjs.Tween.get(BuildingFloorContainers[building][floor].children[1].children[3*pinNum+1],{override:true})[m
[31m-          .to({alpha:1},changetime)[m
[31m-      );[m
[31m-      TimeLine.gotoAndPlay("start");[m
[31m-    }[m
[31m-[m
[31m-    // BoothData(html)をbooth.jsonから取得する ------------------------------------------[m
[31m-    function GetBoothData(boothID){[m
[31m-      return j_boothData[boothID];[m
[31m-    }[m
[31m-[m
[31m-    // DOMに情報を書き込む（構外）-------------------------------------------------------[m
[31m-    function OutsideWriteInfo(event){[m
[31m-      var i = event.target.eventParam;[m
[31m-      var j = event.target.eventParam2;[m
[31m-      InitPinColor();[m
[31m-      OutsideChangePinColor(i,j);[m
[31m-      dh_pindata.textContent = "エリア"+g_areaTexts[i]+"の"+(parseInt(j)+1)+"番目";[m
[31m-      var boothID = j_boothID["Outside" + g_areaTexts[i] + (parseInt(j)+1)];[m
[31m-      h_boothdata.innerHTML  = GetBoothData(boothID);[m
[31m-    }[m
[31m-    // DOMに情報を書き込む（構内）-------------------------------------------------------[m
[31m-    function InsideWriteInfo(event){[m
[31m-      var i = event.target.eventParam;[m
[31m-      var j = event.target.eventParam2;[m
[31m-      var k = event.target.eventParam3;[m
[31m-      InitPinColor();[m
[31m-      InsideChangePinColor(i,j,k);[m
[31m-      dh_pindata.textContent = e_buildNum[i]+"棟"+(parseInt(j)+1)+"階の"+(parseInt(k)+1)+"番目のピン";[m
[31m-      var boothID = j_boothID["Inside" + e_buildNum[i] + (parseInt(j)+1) + (parseInt(k)+1)];[m
[31m-      h_boothdata.innerHTML  = GetBoothData(boothID);[m
[31m-    }[m
[31m-[m
[31m-    // ここまでイベントに対する処理の関数群 ---------------------------------------------------------------------------[m
[31m-[m
[31m-    // ページ切り替えについての関数群 ---------------------------------------------------------------------------------[m
[31m-    // 現在のページから次のページに切り替わる -------------------------------------------[m
[31m-    function MapChange(CurrentContainer,NextContainer){[m
[31m-      DisplayContainer.removeChild(CurrentContainer);[m
[31m-      DisplayContainer.addChild(NextContainer);[m
[31m-    }[m
[31m-    // 現在のページから次のページに切り替わる （フェードアニメーション）-----------------[m
[31m-    function MapChangeAnimation_Fade(CurrentContainer,NextContainer){[m
[31m-      var TimeLine   = new createjs.Timeline(); // タイムライン[m
[31m-      var changetime = 600; // アニメーションにかかる時間（ms)[m
[31m-      // 現在のページの処理[m
[31m-      TimeLine.addTween([m
[31m-        // changetime[ms]をかけて現在のページの透明度を０にする[m
[31m-        createjs.Tween.get(CurrentContainer,{override:false})[m
[31m-          .to({alpha:0},changetime)[m
[31m-          .call(function(){[m
[31m-            // アニメーションが終了したら現在のページを消す(透明度を元に戻しておく)[m
[31m-            CurrentContainer.alpha = 1;[m
[31m-            DisplayContainer.removeChild(CurrentContainer);[m
[31m-          })[m
[31m-      );[m
[31m-      // 次のページの処理[m
[31m-      NextContainer.alpha = 0;[m
[31m-      DisplayContainer.addChild(NextContainer);[m
[31m-      TimeLine.addTween([m
[31m-        // changetime[ms]をかけて現在の透明度を１にする[m
[31m-        createjs.Tween.get(NextContainer,{oevrride:true})[m
[31m-          .to({alpha:1},changetime)[m
[31m-      )[m
[31m-      TimeLine.gotoAndPlay("start");[m
[31m-    }[m
[31m-    // 現在のページから次のページに切り替わる （スライドアニメーション）-----------------[m
[31m-    function MapChangeAnimation_Slide(CurrentContainer,NextContainer,direction){[m
[31m-      /*[m
[31m-      direction : top    : 上の階に行くときに使う。[m
[31m-      direction : bottom : 下の階へ行くときに使う。[m
[31m-      direction : left   : 構外マップへ行くとき[m
[31m-      direction : right  : 構内マップへ行くとき[m
[31m-      */[m
[31m-      var TimeLine   = new createjs.Timeline(); // タイムライン[m
[31m-      var changetime = 600; // アニメーションにかかる時間（ms)[m
[31m-      // direction : 方向別に処理を分ける[m
[31m-      switch(direction){[m
[31m-        case "top":[m
[31m-          // 現在のページの処理[m
[31m-          TimeLine.addTween([m
[31m-            // changetime[ms]で下方向に移動させる[m
[31m-            createjs.Tween.get(CurrentContainer,{override:false},changetime)[m
[31m-              .to({y:canvasElement.height},changetime,createjs.Ease.cubicInOut)[m
[31m-              .call(function(){[m
[31m-                // アニメーション終了時に現在表示していたマップの座標を0に戻し、消す[m
[31m-                CurrentContainer.y=0;[m
[31m-                DisplayContainer.removeChild(CurrentContainer);[m
[31m-              })[m
[31m-          );[m
[31m-          // 次のページの処理[m
[31m-          // 初期化[m
[31m-          NextContainer.y = -1 * canvasElement.height;[m
[31m-          DisplayContainer.addChild(NextContainer);[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(NextContainer,{override:false})[m
[31m-              // changetime[ms]で下方向に移動させる[m
[31m-              .to({y:0},changetime,createjs.Ease.cubicInOut)[m
[31m-          );[m
[31m-          break;[m
[31m-        case "bottom":[m
[31m-          // 現在のページの処理[m
[31m-          TimeLine.addTween([m
[31m-            // changetime[ms]で上方向に移動させる[m
[31m-            createjs.Tween.get(CurrentContainer,{override:false},changetime)[m
[31m-              .to({y:-1*canvasElement.height},changetime,createjs.Ease.cubicInOut)[m
[31m-              .call(function(){[m
[31m-                // アニメーション終了時に現在表示していたマップの座標を0に戻し、消す[m
[31m-                CurrentContainer.y=0;[m
[31m-                DisplayContainer.removeChild(CurrentContainer);[m
[31m-              })[m
[31m-          );[m
[31m-          // 次のページの処理[m
[31m-          // 初期化[m
[31m-          NextContainer.y = canvasElement.height;[m
[31m-          DisplayContainer.addChild(NextContainer);[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(NextContainer,{override:false})[m
[31m-              // changetime[ms]で上方向に移動させる[m
[31m-              .to({y:0},changetime,createjs.Ease.cubicInOut)[m
[31m-          );[m
[31m-          break;[m
[31m-        case "right":[m
[31m-          // 現在のページの処理[m
[31m-          TimeLine.addTween([m
[31m-            // changetime[ms]で左方向に移動させる[m
[31m-            createjs.Tween.get(CurrentContainer,{override:false},changetime)[m
[31m-              .to({x:-1*canvasElement.width},changetime,createjs.Ease.cubicInOut)[m
[31m-              .call(function(){[m
[31m-                // アニメーション終了時に現在表示していたマップの座標を0に戻し、消す[m
[31m-                CurrentContainer.x=0;[m
[31m-                DisplayContainer.removeChild(CurrentContainer);[m
[31m-              })[m
[31m-          );[m
[31m-          // 次のページの処理[m
[31m-          // 初期化[m
[31m-          NextContainer.x = canvasElement.width;[m
[31m-          DisplayContainer.addChild(NextContainer);[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(NextContainer,{override:false})[m
[31m-              // changetime[ms]で左方向に移動させる[m
[31m-              .to({x:0},changetime,createjs.Ease.cubicInOut)[m
[31m-          );[m
[31m-          break;[m
[31m-        case "left":[m
[31m-          // 現在のページの処理[m
[31m-          TimeLine.addTween([m
[31m-            // changetime[ms]で右方向に移動させる[m
[31m-            createjs.Tween.get(CurrentContainer,{override:false},changetime)[m
[31m-              .to({x:canvasElement.width},changetime,createjs.Ease.cubicInOut)[m
[31m-              .call(function(){[m
[31m-                // アニメーション終了時に現在表示していたマップの座標を0に戻し、消す[m
[31m-                CurrentContainer.x=0;[m
[31m-                DisplayContainer.removeChild(CurrentContainer);[m
[31m-              })[m
[31m-          );[m
[31m-          // 次のページの処理[m
[31m-          // 初期化[m
[31m-          NextContainer.x = -1 * canvasElement.width;[m
[31m-          DisplayContainer.addChild(NextContainer);[m
[31m-          TimeLine.addTween([m
[31m-            createjs.Tween.get(NextContainer,{override:false})[m
[31m-              // changetime[ms]で右方向に移動させる[m
[31m-              .to({x:0},changetime,createjs.Ease.cubicInOut)[m
[31m-          );[m
[31m-          break;[m
[31m-      }[m
[31m-      TimeLine.gotoAndPlay("start");[m
[31m-    }[m
[31m-    // ここまでMAP切り替えの関数群 ------------------------------------------------------------------------------------[m
[31m-  }[m
[31m-  // ここまでmain ----------------------------------------------------------------------------------------------------[m
[31m-  // リサイズ時の処理 -------------------------------------------------------------------[m
[31m-  window.addEventListener('resize',Load); // 再ロードさせる[m
[31m-  // 画面更新 ---------------------------------------------------------------------------[m
[31m-  createjs.Ticker.timingMode = createjs.Ticker.RAF;[m
[31m-  createjs.Ticker.on("tick",function(){[m
[31m-    stage.update();[m
[31m-    DisplayContainer.updateCache();[m
[31m-  });[m
[32m+[m[32m/*[m[41m[m
[32m+[m[32m変数命名規則[m[41m[m
[32m+[m[32mg_-- : 全体マップにおくオブジェクト[m[41m[m
[32m+[m[32mj_-- : JSONから持ってきたデータ[m[41m[m
[32m+[m[32ma_-- : 外・エリアごとに配置するオブジェクト[m[41m[m
[32m+[m[32mc_-- : 構内マップTOPにおくオブジェクト[m[41m[m
[32m+[m[32mb_-- : 構内マップの各棟についてのオブジェクト[m[41m[m
[32m+[m[32mf_-- : 構内のフロア内オブジェクト[m[41m[m
[32m+[m[32mm_-- : MAP画像[m[41m[m
[32m+[m[32mh_-- : html(DOM)[m[41m[m
[32m+[m[32me_-- : eventチェック用[m[41m[m
[32m+[m[32mz_-- : Hexoに入れた時の座標調整用[m[41m[m
[32m+[m[32mp_-- : URLパラメータ[m[41m[m
[32m+[m[32md_-- : デバッグ用[m[41m[m
[32m+[m[32m// *z : 後から座標指定しなきゃダメなところ[m[41m[m
[32m+[m[32m// ** comment  後から実装するべきところ[m[41m[m
[32m+[m[32m// *p : pathが配置されていること[m[41m[m
[32m+[m[32m*/[m[41m[m
[32m+[m[41m[m
[32m+[m[32mwindow.addEventListener("load",WidthCheck);[m[41m[m
[32m+[m[32m /**[m[41m[m
[32m+[m[32m * windowの横幅を見て、スマホ～タブレットサイズの場合別リンクに飛ばす。[m[41m[m
[32m+[m[32m * 1050px以上の場合、読み込み[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction WidthCheck(){[m[41m[m
[32m+[m[32m  console.log(window.innerWidth);[m[41m[m
[32m+[m[32m  if(window.innerWidth < 1050) GoLINELink();[m[41m[m
[32m+[m[32m  else Load();[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * 別リンクに飛ばす(window.location.assign("url")))[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction GoLINELink(){[m[41m[m
[32m+[m[32m  console.log("end");[m[41m[m
[32m+[m[32m  window.location.assign("https://kunugida2018.tokyo-ct.ac.jp/lineat/?map=true");[m[41m[m
[32m+[m[32m  window.msg.textContent = "Moving...";[m[41m[m
[32m+[m[32m  setInterval(()=>window.msg.textContent+=".", 10);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[32m// 読み込んで初期化して表示するMAP位置[m[41m[m
[32m+[m[32mvar currentMapID = "OutsideTop";[m[41m[m
[32m+[m[32mvar reloadCount  = 0;[m[41m[m
[32m+[m[32mvar p_location;[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * PCで閲覧時（画面サイズが1050px)以下の時に読み込まれる[m[41m[m
[32m+[m[32m * また、windowサイズ変更時に入る[m[41m[m
[32m+[m[32m * manifestに入ったJSONを全て読み込むとinitに入る[m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction Load(){[m[41m[m
[32m+[m[32m  // reload時の処理 ----------------------------------------[m[41m[m
[32m+[m[32m  p_location = "reload";[m[41m[m
[32m+[m[32m  reloadCount+=1;// リロードした回数をカウントする[m[41m[m
[32m+[m[32m  var queue = new createjs.LoadQueue(true);[m[41m[m
[32m+[m[32m  var manifest = [[m[41m[m
[32m+[m[32m    {"src":"/data/mapImgData.json","id":"mapImgs"},[m[41m[m
[32m+[m[32m    {"src":"/data/boothsample.json","id":"booth"},[m[41m[m
[32m+[m[32m    {"src":"/data/boothID.json","id":"boothID"},[m[41m[m
[32m+[m[32m    {"src":"/data/labo.json","id":"labo"}[m[41m[m
[32m+[m[32m  ];[m[41m[m
[32m+[m[32m  queue.loadManifest(manifest,true);[m[41m[m
[32m+[m[32m  queue.addEventListener("complete",init);[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[41m[m
[32m+[m[32m// 指定したパラメータを取得 key : name[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * パラメータ[name]に対応する値を取得する[m[41m[m
[32m+[m[32m * @param {string} name[m[41m [m
[32m+[m[32m * @return {string} p_obj[name][m[41m[m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction getParam(name) {[m[41m[m
[32m+[m[32m    var p_obj = new Object;[m[41m[m
[32m+[m[32m    //console.log(reloadCount);[m[41m[m
[32m+[m[32m    var p_all = location.search.substring(1).split('&');[m[41m[m
[32m+[m[32m    // パラメータを指定しない場合、return Outside[m[41m[m
[32m+[m[32m    if(p_all == ""){[m[41m[m
[32m+[m[32m      return "OutsideTop";[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // pair[i]が存在しない場合はいらない[m[41m[m
[32m+[m[32m    for(i=0;p_all[i];i++){[m[41m[m
[32m+[m[32m      var keyValue = p_all[i].split('=');[m[41m[m
[32m+[m[32m      p_obj[keyValue[0]]=keyValue[1];[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    return p_obj[name];[m[41m[m
[32m+[m[32m}[m[41m[m
[32m+[m[32m/**[m[41m[m
[32m+[m[32m * JSONが読み込まれたら入る。これからはこの関数内で全て処理される。[m[41m[m
[32m+[m[32m * @param {obj} event[m[41m [m
[32m+[m[32m */[m[41m[m
[32m+[m[32mfunction init(event){[m[41m[m
[32m+[m[32m  var j_mapImgsData   = event.target.getResult("mapImgs");　// mapImgData.json[m[41m[m
[32m+[m[32m  var j_boothData     = event.target.getResult("booth");[m[41m[m
[32m+[m[32m  var j_boothID       = event.target.getResult("boothID");[m[41m[m
[32m+[m[32m  var j_laboData      = event.target.getResult("labo");[m[41m[m
[32m+[m[32m  // URLパラメータの取得 ----------------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m  //console.log(getParam("booth"));[m[41m[m
[32m+[m[32m  // 一覧ページから入る処理[m[41m[m
[32m+[m[32m  if(reloadCount==1) p_location = getParam("booth");[m[41m[m
[32m+[m[32m  console.log(p_location);[m[41m[m
[32m+[m[32m  // - canvas stageの定義 --------------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m  var canvasContainer = document.getElementById("wrap");[m[41m[m
[32m+[m[32m  var canvasElement   = document.getElementById("myCanvas");[m[41m[m
[32m+[m[32m  var dh_pindata      = document.getElementById("pin");[m[41m[m
[32m+[m[32m  var h_boothdata     = document.getElementById("boothdata");[m[41m[m
[32m+[m[32m  // CanvasElementの大きさ画面サイズに設定する（初期化）[m[41m[m
[32m+[m[32m  var Sizing = function(){[m[41m[m
[32m+[m[32m    canvasElement.height = canvasElement.offsetHeight;[m[41m[m
[32m+[m[32m    canvasElement.width  = canvasElement.offsetWidth;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m  Sizing();[m[41m[m
[32m+[m[32m  // - stageの定義[m[41m[m
[32m+[m[32m  var stage = new createjs.StageGL(canvasElement);[m[41m[m
[32m+[m[32m  // ---------------------------------------------------------------------------------------------------------------[m[41m   [m
[32m+[m[32m  var DisplayContainer = new createjs.Container();                                  // 表示用コンテナ[m[41m[m
[32m+[m[32m  stage.addChild(DisplayContainer);[m[41m[m
[32m+[m[32m  DisplayContainer.cache(0,0,canvasElement.width,canvasElement.height);[m[41m[m
[32m+[m[32m  stage.setClearColor('#343434');[m[41m[m
[32m+[m[32m  var gm_general      = new createjs.Bitmap("/img/" + j_mapImgsData.Generalview); // 構外MAP全体画像　すべての基準はこの画像になる。// *p[m[41m[m
[32m+[m[32m  main();[m[41m[m
[32m+[m[32m  // -- タッチ操作有効化[m[41m[m
[32m+[m[32m  if(createjs.Touch.isSupported() == true){[m[41m[m
[32m+[m[32m    createjs.Touch.enable(stage);[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m  /**[m[41m[m
[32m+[m[32m   * Bitmapを読み込み、サイズを取得する[m[41m[m
[32m+[m[32m   * @param {createjs.BitmapClass} bitmap[m[41m[m
[32m+[m[32m   * @return {array} size[0]:width size[1]:height[m[41m [m
[32m+[m[32m   */[m[41m[m
[32m+[m[32m  function getImageSize(bitmap){[m[41m[m
[32m+[m[32m    return new Promise(function(resolve,reject){[m[41m[m
[32m+[m[32m      bitmap.image.onload = function(){[m[41m[m
[32m+[m[32m        var size =[this.width,this.height];[m[41m[m
[32m+[m[32m        resolve(size);[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m    });[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m  /**[m[41m[m
[32m+[m[32m   * canvasのサイズを変更する[m[41m[m
[32m+[m[32m   * @param {int} width[m[41m [m
[32m+[m[32m   * @param {int} height[m[41m [m
[32m+[m[32m   */[m[41m[m
[32m+[m[32m  function ChangeCanvasSize(width,height){[m[41m[m
[32m+[m[32m    canvasElement.style.width = width;[m[41m[m
[32m+[m[32m    canvasElement.style.height = height;[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m  /**[m[41m[m
[32m+[m[32m   * 初期設定以降はこの関数に入る[m[41m[m
[32m+[m[32m   */[m[41m[m
[32m+[m[32m  async function main(){[m[41m[m
[32m+[m[41m    [m
[32m+[m[32m    // :: canvas の大きさの調整----------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    // 基準となる画像（構外MAP全体画像）のサイズを取得する。[m[41m[m
[32m+[m[32m    var bmp_size = await getImageSize(gm_general); // size[0] : width  size[1] : height[m[41m[m
[32m+[m[32m    //画像のスケールの計算[m[41m[m
[32m+[m[32m    gm_general.scaleX = canvasContainer.offsetWidth / bmp_size[0];[m[41m[m
[32m+[m[32m    gm_general.scaleY = gm_general.scaleX;[m[41m[m
[32m+[m[32m    //canvasSizeの調整　全体MAP画像の大きさと同じ大きさにする[m[41m[m
[32m+[m[32m    ChangeCanvasSize(gm_general.image.width * gm_general.scaleX,gm_general.image.height * gm_general.scaleY);[m[41m[m
[32m+[m[32m    // 高さを中心に合わせる (基準）(縦横比によって可変する値)[m[41m[m
[32m+[m[32m    var z_General = {};[m[41m[m
[32m+[m[32m    z_General.x = 0;[m[41m[m
[32m+[m[32m    z_General.y = (canvasElement.height-(gm_general.image.height * gm_general.scaleY))/2;[m[41m[m
[32m+[m[32m    gm_general.y = z_General.y;[m[41m[m
[32m+[m[41m    [m
[32m+[m[32m    // :: 親子構造の構築-----------------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    // 構外MAP内に配置するオブジェクトの定義[m[41m[m
[32m+[m[32m    var OutsideContainer   = new createjs.Container();   // 構外マップで表示されるオブジェクト[m[41m[m
[32m+[m[32m    var areaContainers     = [];                         // 各エリアのデータ [A,B,C,D,E,F][m[41m[m
[32m+[m[32m    var g_rects            = [];                         // エリアの四角 [エリア][m[41m[m
[32m+[m[32m    var g_areaTexts        = ["A","B","C","D","E","F"];  // エリアのテキスト情報[m[41m[m
[32m+[m[32m    // --- 1. 全体マップの配置 ----------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    // --- 1.1 構外MAP全体画像の配置 --------------------------------------------------------------[m[41m[m
[32m+[m[32m    OutsideContainer.addChild(gm_general);[m[41m [m
[32m+[m[32m    // --- 1.2 エリア分け用のオブジェクトの配置----------------------------------------------------[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.AreaRects.length;i++){[m[41m[m
[32m+[m[32m      // ---- 1.2.1 エリア用の四角の配置 ----------------------------------------------------------[m[41m[m
[32m+[m[32m      var j_rect          = j_mapImgsData.AreaRects[i];[m[41m[m
[32m+[m[32m      g_rects[i]          = new createjs.Shape();[m[41m[m
[32m+[m[32m      g_rects[i].graphics.beginFill(j_rect.color); // ** 色分けしたいなら後で配列を宣言しましょう[m[41m[m
[32m+[m[32m      g_rects[i].graphics.drawRoundRect(0,0,j_rect.width * gm_general.scaleX,j_rect.height * gm_general.scaleY, 20* gm_general.scaleX);[m[41m[m
[32m+[m[32m      g_rects[i].x        = j_rect.x * gm_general.scaleX + z_General.x ; // 位置座標セット[m[41m[m
[32m+[m[32m      g_rects[i].y        = j_rect.y * gm_general.scaleY + z_General.y ; // 位置座標セット[m[41m[m
[32m+[m[32m      g_rects[i].alpha    = 0.15;                       // 透明度[m[41m[m
[32m+[m[32m      // ---- 1.2.2 エリア用の四角に対する枠線用オブジェクトの配置 --------------------------------[m[41m[m
[32m+[m[32m      var g_rectStroke = new createjs.Shape();[m[41m[m
[32m+[m[32m      g_rectStroke.graphics.beginStroke(j_rect.color);[m[41m[m
[32m+[m[32m      g_rectStroke.graphics.setStrokeStyle(5 * gm_general.scaleX); // * gm_general.scaleX[m[41m[m
[32m+[m[32m      g_rectStroke.graphics.drawRoundRect(0,0,j_rect.width * gm_general.scaleX,j_rect.height * gm_general.scaleY,20 * gm_general.scaleX);[m[41m      [m
[32m+[m[32m      g_rectStroke.x      = g_rects[i].x;[m[41m[m
[32m+[m[32m      g_rectStroke.y      = g_rects[i].y;[m[41m[m
[32m+[m[32m      // ---- 1.2.3 エリア用の四角に乗せるテキストオブジェクトの配置-------------------------------[m[41m[m
[32m+[m[32m      var textSize        = 100 * gm_general.scaleX;[m[41m[m
[32m+[m[32m      var g_text          = new createjs.Text(g_areaTexts[i], textSize +"px selif",j_rect.color);[m[41m[m
[32m+[m[32m      g_text.x            = (j_rect.x + parseInt(j_rect.width /2) ) * gm_general.scaleX + z_General.x;[m[41m[m
[32m+[m[32m      g_text.y            = (j_rect.y + parseInt(j_rect.height/2) ) * gm_general.scaleY + z_General.y;[m[41m[m
[32m+[m[32m      g_text.textAlign    = "center";[m[41m[m
[32m+[m[32m      g_text.textBaseline = "middle";[m[41m[m
[32m+[m[32m      // ---- 1.2.4 配置しかく用オブジェクトを配置する --------------------------------------------[m[41m[m
[32m+[m[32m      OutsideContainer.addChild(g_rects[i]);[m[41m[m
[32m+[m[32m      OutsideContainer.addChild(g_rectStroke);[m[41m[m
[32m+[m[32m      OutsideContainer.addChild(g_text);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // --- 1.2 構外MAP全体へ画像の配置 --------------------------------------------------------------[m[41m[m
[32m+[m[32m    var toCampusArrow = new createjs.Bitmap("/img/" + j_mapImgsData.ToCampusArrow); // *p[m[41m[m
[32m+[m[32m    // 位置、角度のセット[m[41m[m
[32m+[m[32m    toCampusArrow.scaleX   = gm_general.scaleX * 0.9;[m[41m[m
[32m+[m[32m    toCampusArrow.scaleY   = gm_general.scaleY * 0.9;[m[41m[m
[32m+[m[32m    toCampusArrow.x        = 2600 * gm_general.scaleX + z_General.x; // *z 座標を入れよう[m[41m[m
[32m+[m[32m    toCampusArrow.y        = 200 * gm_general.scaleY + z_General.y;  // *z[m[41m[m
[32m+[m[32m    OutsideContainer.addChild(toCampusArrow);[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // --- 2. 小エリアの配置 ------------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    var am_sizes_tmp       = [];                         // await時間短縮用[m[41m[m
[32m+[m[32m    var am_sizes           = [];                         // エリアごとに分けたときの画像のサイズ[m[41m[m
[32m+[m[32m    var am_imgs            = [];                         // エリアごとに分けたときの画像[m[41m[m
[32m+[m[32m    var a_toGenerals       = [];                         // エリアから全体に戻るときの画像[m[41m[m
[32m+[m[32m    var outSidePins_r      = [];                         // 校外のピンたちの上に隠れている四角（outSidePins_r[Area][num])[m[41m [m
[32m+[m[32m    var a_pinContainers    = [];                         // エリアごとのピン（画像）が格納されたコンテナが格納 [エリア][番号][m[41m[m
[32m+[m[32m    var a_toDisplayPins    = [];                         // ピン非表示する画像[m[41m[m
[32m+[m[32m    var a_toHidePins       = [];                         // ピンを表示する画像[m[41m[m
[32m+[m[32m    // --- 2.1 各エリアの拡大画像の大きさの取得---------------------------------------------------[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.OutsideAreas.length;i++){[m[41m[m
[32m+[m[32m      var am_img      = new createjs.Bitmap("/img/" + j_mapImgsData.OutsideAreas[i].img); // *p[m[41m[m
[32m+[m[32m      am_sizes_tmp[i] = getImageSize(am_img);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // await時間短縮[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.OutsideAreas.length;i++)am_sizes[i] = await am_sizes_tmp[i];[m[41m[m
[32m+[m[32m    // --- 2.2 小エリア内オブジェクトの配置--------------------------------------------------------[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.OutsideAreas.length;i++){[m[41m[m
[32m+[m[32m      var a_PageContainer = new createjs.Container(); // i番目のエリアのデータが全部入る[m[41m[m
[32m+[m[32m      var a_PinContainer  = new createjs.Container(); // ピンがいっぱい入る[m[41m[m
[32m+[m[32m      // ---- 2.2.1 各エリアの拡大画像の配置 ------------------------------------------------------[m[41m[m
[32m+[m[32m      var am_img          = new createjs.Bitmap("/img/" + j_mapImgsData.OutsideAreas[i].img);// *p[m[41m[m
[32m+[m[32m      var am_size         = am_sizes[i];[m[41m[m
[32m+[m[32m      am_imgs.push(am_img);[m[41m[m
[32m+[m[32m      // ---- canvasのサイズに画像を合わせる。----------------------------------------------------[m[41m[m
[32m+[m[32m      if((canvasElement.width/am_size[0]) * am_size[1] > canvasElement.height){[m[41m[m
[32m+[m[32m        // 縦横比が合わないと高さがcanvasを超える問題の対処[m[41m[m
[32m+[m[32m        am_img.scaleX = canvasElement.height / am_size[1];[m[41m[m
[32m+[m[32m        am_img.scaleY = am_img.scaleX;[m[41m[m
[32m+[m[32m        am_img.x = ( (canvasElement.width - am_img.scaleY * am_size[0])/2 );[m[41m[m
[32m+[m[32m      }else{[m[41m[m
[32m+[m[32m        // scale : 現在のcanvasSize / am_img.width[m[41m [m
[32m+[m[32m        am_img.scaleX = canvasElement.width / am_size[0];[m[41m[m
[32m+[m[32m        am_img.scaleY = am_img.scaleX;[m[41m[m
[32m+[m[32m        am_img.y = ( (canvasElement.height - am_img.scaleX * am_size[1])/2 );[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      // ------------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m      a_PageContainer.addChild(am_img);[m[41m[m
[32m+[m[32m      // ---- 2.2.2 各エリアに配置されるピンの設置 ------------------------------------------------[m[41m[m
[32m+[m[32m      // 青ピント赤ピンのサイズは同じ[m[41m[m
[32m+[m[32m      var a_pins         = []; //　エリアにおけるピンの画像が入る [エリア][m[41m[m
[32m+[m[32m      var a_pin1Tmp      = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_1); // *p  // blue[m[41m[m
[32m+[m[32m      var pin1Size       = await getImageSize(a_pin1Tmp); // pinの画像サイズを取得[m[41m[m
[32m+[m[32m      for(var j=0;j<j_mapImgsData.OutsideAreas[i].pins.length;j++){[m[41m[m
[32m+[m[32m        // ----- 2.2.2.1 エリアにおけるピンの画像の設置 -------------------------------------------[m[41m[m
[32m+[m[32m        var a_pin        = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_1); // *p[m[41m[m
[32m+[m[32m        a_pin.scaleX     = gm_general.scaleX;[m[41m[m
[32m+[m[32m        a_pin.scaleY     = gm_general.scaleY;[m[41m[m
[32m+[m[32m        a_pin.x          = j_mapImgsData.OutsideAreas[i].pins[j].x * am_img.scaleX + am_img.x;[m[41m[m
[32m+[m[32m        a_pin.y          = j_mapImgsData.OutsideAreas[i].pins[j].y * am_img.scaleY + am_img.y;[m[41m[m
[32m+[m[32m        a_PinContainer.addChild(a_pin);[m[41m[m
[32m+[m[32m        // ----- 2.2.2.1.2 エリアにおけるピンの画像の設置 2 (red) ---------------------------------[m[41m[m
[32m+[m[32m        var a_pin2       = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_2); // *p[m[41m[m
[32m+[m[32m        a_pin2.scaleX    = gm_general.scaleX;[m[41m[m
[32m+[m[32m        a_pin2.scaleY    = gm_general.scaleY;[m[41m[m
[32m+[m[32m        a_pin2.alpha     = 0;[m[41m[m
[32m+[m[32m        a_pin2.x         = j_mapImgsData.OutsideAreas[i].pins[j].x * am_img.scaleX + am_img.x;[m[41m[m
[32m+[m[32m        a_pin2.y         = j_mapImgsData.OutsideAreas[i].pins[j].y * am_img.scaleY + am_img.y;[m[41m[m
[32m+[m[32m        a_PinContainer.addChild(a_pin2);[m[41m     [m
[32m+[m[32m        // ----- 2.2.2.2 エリアにおけるピンの画像の上に配置する四角の設置 -------------------------[m[41m[m
[32m+[m[32m        var a_pin_rect   = new createjs.Shape();[m[41m[m
[32m+[m[32m        a_pin_rect.graphics.beginFill("White");[m[41m[m
[32m+[m[32m        a_pin_rect.graphics.drawRect(0,0,pin1Size[0] * a_pin.scaleX,pin1Size[1] * a_pin.scaleY);[m[41m      [m
[32m+[m[32m        a_pin_rect.x     = a_pin.x;[m[41m[m
[32m+[m[32m        a_pin_rect.y     = a_pin.y;[m[41m[m
[32m+[m[32m        a_pin_rect.alpha = 0.0059; // *z 透明度の変更[m[41m[m
[32m+[m[32m        // a_pin_rect.alpha = 0.5;[m[41m[m
[32m+[m[32m        a_PinContainer.addChild(a_pin_rect);[m[41m[m
[32m+[m[32m        a_pins.push(a_pin_rect);//pinの上に係る四角形たちを入れる（クリック判定は透明の四角形）[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      outSidePins_r.push(a_pins);[m[41m[m
[32m+[m[32m      a_PageContainer.addChild(a_PinContainer);[m[41m[m
[32m+[m[32m      a_pinContainers.push(a_PinContainer);[m[41m[m
[32m+[m[32m      // ---- 2.2.3 各エリアに配置される「Generalへ戻る画像」の設置 -------------------------------[m[41m[m
[32m+[m[32m      var a_toGeneral = new createjs.Bitmap("/img/" + j_mapImgsData.GotoGeneralImg); // *p[m[41m[m
[32m+[m[32m      a_toGeneral.scaleX = gm_general.scaleX;[m[41m[m
[32m+[m[32m      a_toGeneral.scaleY = gm_general.scaleY;[m[41m[m
[32m+[m[32m      a_toGeneral.x      = j_mapImgsData.OutsideAreas[i].goGeneral.x * gm_general.scaleX + am_img.x;[m[41m[m
[32m+[m[32m      a_toGeneral.y      = j_mapImgsData.OutsideAreas[i].goGeneral.y * gm_general.scaleY + am_img.y;[m[41m[m
[32m+[m[32m      a_PageContainer.addChild(a_toGeneral);[m[41m[m
[32m+[m[32m      a_toGenerals.push(a_toGeneral);[m[41m[m
[32m+[m[32m      // ---- 2.2.4 各エリアに配置される「ピンを表示する画像」の設置 ------------------------------[m[41m[m
[32m+[m[32m      var a_toDisplayPin = new createjs.Bitmap("/img/" + j_mapImgsData.ToDisplayPinImg); // *p[m[41m[m
[32m+[m[32m      a_toDisplayPin.scaleX = gm_general.scaleX * 0.9;[m[41m[m
[32m+[m[32m      a_toDisplayPin.scaleY = gm_general.scaleY * 0.9;[m[41m[m
[32m+[m[32m      a_toDisplayPin.x      = j_mapImgsData.OutsideAreas[i].toDisplayPins.x * gm_general.scaleX + am_img.x;[m[41m[m
[32m+[m[32m      a_toDisplayPin.y      = j_mapImgsData.OutsideAreas[i].toDisplayPins.y * gm_general.scaleY + am_img.y;[m[41m[m
[32m+[m[32m      a_toDisplayPin.alpha  = 0;[m[41m[m
[32m+[m[32m      a_PageContainer.addChild(a_toDisplayPin);[m[41m[m
[32m+[m[32m      a_toDisplayPins.push(a_toDisplayPin);[m[41m[m
[32m+[m[32m      // ---- 2.2.5 各エリアに配置される「ピンを非表示にする画像」の設置 --------------------------[m[41m[m
[32m+[m[32m      var a_toHidePin    = new createjs.Bitmap("/img/" + j_mapImgsData.ToHidePinImg); // *p[m[41m[m
[32m+[m[32m      a_toHidePin.scaleX = gm_general.scaleX * 0.9;[m[41m[m
[32m+[m[32m      a_toHidePin.scaleY = gm_general.scaleY * 0.9;[m[41m[m
[32m+[m[32m      a_toHidePin.x      = j_mapImgsData.OutsideAreas[i].toHidePins.x * gm_general.scaleX + am_img.x;[m[41m[m
[32m+[m[32m      a_toHidePin.y      = j_mapImgsData.OutsideAreas[i].toHidePins.y * gm_general.scaleY + am_img.y;[m[41m[m
[32m+[m[32m      a_toHidePin.alpha  = 1;[m[41m[m
[32m+[m[32m      a_PageContainer.addChild(a_toHidePin);[m[41m[m
[32m+[m[32m      a_toHidePins.push(a_toHidePin);[m[41m[m
[32m+[m[32m      // このページのデータを格納[m[41m[m
[32m+[m[32m      areaContainers.push(a_PageContainer);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // --- 3. 構内マップの配置 ----------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    var InsideTopContainer = new createjs.Container();   // 構内マップで表示されるオブジェクトが格納されている。[m[41m[m
[32m+[m[32m    var cm_img             = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.top); // *p[m[41m[m
[32m+[m[32m    // --- 3.1 構内マップTOPの画像サイズの取得 ----------------------------------------------------[m[41m[m
[32m+[m[32m    var cm_size = await getImageSize(cm_img);[m[41m[m
[32m+[m[32m    var c_rects = []; // 構内から棟に[m[41m[m
[32m+[m[32m    // --- 3.2 canvasのサイズに構内マップTOP画像を合わせる ----------------------------------------[m[41m[m
[32m+[m[32m    if((canvasElement.width/cm_size[0]) * cm_size[1] > canvasElement.height){[m[41m[m
[32m+[m[32m      // 縦横比が合わないと高さがcanvasを超える問題の対処[m[41m[m
[32m+[m[32m      cm_img.scaleX = canvasElement.height / cm_size[1];[m[41m[m
[32m+[m[32m      cm_img.scaleY = cm_img.scaleX;[m[41m[m
[32m+[m[32m      cm_img.x = ( (canvasElement.width - cm_img.scaleY * cm_size[0])/2 );[m[41m[m
[32m+[m[32m    }else{[m[41m[m
[32m+[m[32m      // scale : 現在のcanvasSize / am_img.width[m[41m [m
[32m+[m[32m      cm_img.scaleX = canvasElement.width / cm_size[0];[m[41m[m
[32m+[m[32m      cm_img.scaleY = cm_img.scaleX;[m[41m[m
[32m+[m[32m      cm_img.y = ( (canvasElement.height - cm_img.scaleX * cm_size[1])/2 );[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    InsideTopContainer.addChild(cm_img);[m[41m[m
[32m+[m[32m    // ---  3.2「構外への矢印画像」の設置 ---------------------------------------------------------[m[41m[m
[32m+[m[32m    var toOutsideArrow = new createjs.Bitmap("/img/" + j_mapImgsData.ToOutsideArrow); // *p[m[41m[m
[32m+[m[32m    // 位置、角度のセット[m[41m[m
[32m+[m[32m    toOutsideArrow.scaleX = gm_general.scaleX * 0.9;[m[41m[m
[32m+[m[32m    toOutsideArrow.scaleY = gm_general.scaleY * 0.9;[m[41m[m
[32m+[m[32m    toOutsideArrow.x      = 80 * gm_general.scaleX + cm_img.x; // *z 座標を入れよう[m[41m[m
[32m+[m[32m    toOutsideArrow.y      = 0 * gm_general.scaleY + cm_img.y; // *z[m[41m[m
[32m+[m[32m    InsideTopContainer.addChild(toOutsideArrow);[m[41m[m
[32m+[m[32m    // --- 3.3 構内から棟に飛ぶ時の四角 (吹き出しを出すものもある) --------------------------------[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.Campus.buildingRects.length;i++){[m[41m[m
[32m+[m[32m      var c_rect   = new createjs.Shape();[m[41m[m
[32m+[m[32m      var j_rect   = j_mapImgsData.Campus.buildingRects[i];[m[41m[m
[32m+[m[32m      c_rect.graphics.beginFill("White");[m[41m[m
[32m+[m[32m      c_rect.graphics.drawRect(0,0,j_rect.width * gm_general.scaleX,j_rect.height * gm_general.scaleY);[m[41m[m
[32m+[m[32m      c_rect.x     = j_rect.x * gm_general.scaleX + cm_img.x; // 位置座標セット[m[41m[m
[32m+[m[32m      c_rect.y     = j_rect.y * gm_general.scaleY + cm_img.y; // 位置座標セット[m[41m[m
[32m+[m[32m      c_rect.alpha = 0.0059;                       // 透明度[m[41m[m
[32m+[m[32m      // c_rect.alpha = 0.5;[m[41m[m
[32m+[m[32m      InsideTopContainer.addChild(c_rect);[m[41m[m
[32m+[m[32m      c_rects.push(c_rect);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // --- 3.4 構内マップに表示される吹き出し画像・吹き出しの上に表示されるオブジェクトの設置 -----[m[41m[m
[32m+[m[32m    var balloonContainers = []; // 吹き出しと同時に表示されるオブジェクトが格納される[m[41m[m
[32m+[m[32m    var c_balloons        = []; // 吹き出したち[m[41m[m
[32m+[m[32m    var c_balloonsRects   = []; // 吹き出しの上の全てのオブジェクト [吹き出し番号][吹き出し内番号][m[41m[m
[32m+[m[32m    //吹き出しとその上に配置されるオブジェクトの配置[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.Campus.balloons.length;i++){[m[41m[m
[32m+[m[32m      var BalloonContainer = new createjs.Container();                       // 吹き出しとその上に乗る四角が格納[m[41m[m
[32m+[m[32m      var j_balloon        = j_mapImgsData.Campus.balloons[i];[m[41m[m
[32m+[m[32m      var j_balloonRect    = j_mapImgsData.Campus.balloonRects[i];[m[41m [m
[32m+[m[32m      // ---- 3.4.1 吹き出し画像の設置 ------------------------------------------------------------[m[41m[m
[32m+[m[32m      var c_balloon        = new createjs.Bitmap("/img/" + j_balloon.img); // 吹き出し画像 // *p[m[41m[m
[32m+[m[32m      var c_balloonRects   = [];                                             // i番目吹き出しに載せられる四角たちが格納されている。[m[41m[m
[32m+[m[32m      c_balloon.scaleX     = gm_general.scaleX * 0.26; // *z スケール調整[m[41m[m
[32m+[m[32m      c_balloon.scaleY     = gm_general.scaleY *0.26; // *z[m[41m[m
[32m+[m[32m      c_balloon.x          = j_balloon.x * gm_general.scaleX + cm_img.x;[m[41m[m
[32m+[m[32m      c_balloon.y          = j_balloon.y * gm_general.scaleY + cm_img.y;[m[41m[m
[32m+[m[32m      BalloonContainer.addChild(c_balloon);[m[41m[m
[32m+[m[32m      c_balloons.push(c_balloon);[m[41m[m
[32m+[m[32m      // ---- 3.4.2 吹き出しの上の四角形たちの設置 ------------------------------------------------[m[41m[m
[32m+[m[32m      for(var j=0;j<j_balloonRect.length;j++){[m[41m[m
[32m+[m[32m        var c_balloonRect   = new createjs.Shape();[m[41m[m
[32m+[m[32m        c_balloonRect.graphics.beginFill("White");[m[41m[m
[32m+[m[32m        c_balloonRect.graphics.drawRect(0,0,j_balloonRect[j].width * gm_general.scaleX,j_balloonRect[j].height * gm_general.scaleY);[m[41m[m
[32m+[m[32m        c_balloonRect.x     = j_balloonRect[j].x * gm_general.scaleX + cm_img.x; // 位置座標セット[m[41m[m
[32m+[m[32m        c_balloonRect.y     = j_balloonRect[j].y * gm_general.scaleY + cm_img.y; // 位置座標セット[m[41m[m
[32m+[m[32m        c_balloonRect.alpha = 0.0059;                      // 透明度[m[41m[m
[32m+[m[32m        // c_balloonRect.alpha = 0.5;[m[41m[m
[32m+[m[32m        BalloonContainer.addChild(c_balloonRect);[m[41m[m
[32m+[m[32m        c_balloonRects.push(c_balloonRect);[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      c_balloonsRects.push(c_balloonRects);[m[41m[m
[32m+[m[32m      balloonContainers.push(BalloonContainer);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // --- 4. 棟と階のMAPの配置 ---------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    var BuildingFloorContainers = []; // 棟・階のデータが格納されたコンテナが格納される[棟][階][m[41m[m
[32m+[m[32m    var bfm_sizes_tmp           = []; // await時間短縮用 [棟][階][m[41m[m
[32m+[m[32m    var bfm_sizes               = []; // 棟・階におけるマップ画像のサイズ[棟][階][m[41m[m
[32m+[m[32m    var bf_toCampusTops         = []; // 構内マップTOPへ飛ぶ矢印 [棟][階][m[41m[m
[32m+[m[32m    var bf_pins                 = []; // 構内の全てのピン格納用　bf_pins[棟][階][ピン番号][m[41m[m
[32m+[m[32m    var bf_toUpper              = []; // 上の階へ [棟][階][m[41m[m
[32m+[m[32m    var bf_toLower              = []; // 下の階へ [棟][階][m[41m[m
[32m+[m[32m    var bf_toDisplayPins        = []; // ピンを表示する[棟][階][m[41m[m
[32m+[m[32m    var bf_toHidePins           = []; // ピンを非表示にする[棟][階][m[41m[m
[32m+[m[32m    /*[m[41m[m
[32m+[m[32m    棟・階は０から始まり、2.3.5.8棟しかフロアを表示しないため、プログラム上でのi棟j階は実際の値とは違う。[m[41m[m
[32m+[m[32m    その辺はJSONでも全て共通させている。イベントの検知～イベントに対応する処理で実際の階に結び付ける。[m[41m[m
[32m+[m[32m    棟（実際の棟）　     階  （実際の階）[m[41m [m
[32m+[m[32m    0     (2)         0,1,2,3 (1,2,3,4)[m[41m[m
[32m+[m[32m    1     (3)         0,1,2,3 (1,2,3,4)[m[41m[m
[32m+[m[32m    2     (5)         0,1     (1,2)[m[41m[m
[32m+[m[32m    3     (8)         0,1     (1,2)[m[41m[m
[32m+[m[32m    */[m[41m[m
[32m+[m[32m    // --- 4.1 各フロア拡大画像のサイズの取得 -----------------------------------------------------[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.Campus.buildings.length;i++){[m[41m[m
[32m+[m[32m      bfm_sizes_tmp[i] = []; // 2次元配列化[m[41m[m
[32m+[m[32m      for(var j=0;j<j_mapImgsData.Campus.buildings[i].floorImg.length;j++){[m[41m[m
[32m+[m[32m        var fm_img = new createjs.Bitmap("/img/"+ j_mapImgsData.Campus.buildings[i].floorImg[j]); // *p[m[41m[m
[32m+[m[32m        bfm_sizes_tmp[i][j] = getImageSize(fm_img);[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // await時間短縮[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.Campus.buildings.length;i++){[m[41m[m
[32m+[m[32m      bfm_sizes[i]=[];[m[41m[m
[32m+[m[32m      for(var j=0;j<j_mapImgsData.Campus.buildings[i].floorImg.length;j++){[m[41m[m
[32m+[m[32m        bfm_sizes[i][j] = await bfm_sizes_tmp[i][j];[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // --- 4.2 各フロアオブジェクトの配置 ---------------------------------------------------------[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.Campus.buildings.length;i++){[m[41m[m
[32m+[m[32m      var FloorContainers = []; // i棟のフロアデータが格納されたコンテナが入る[m[41m[m
[32m+[m[32m      bf_toCampusTops[i]  = []; // i棟の中にある全体への画像が格納される（後に.push）[m[41m[m
[32m+[m[32m      bf_toUpper[i]       = []; // 上の階へ [i棟][階][m[41m[m
[32m+[m[32m      bf_toLower[i]       = []; // 下の階へ [i棟][階][m[41m[m
[32m+[m[32m      bf_toDisplayPins[i] = []; // ピンを表示する[棟][階][m[41m[m
[32m+[m[32m      bf_toHidePins[i]    = []; // ピンを非表示にする[棟][階][m[41m[m
[32m+[m[32m      var b_pins          = []; // 建物におけるピン画像が入る[m[41m[m
[32m+[m[32m      for(var j=0;j<j_mapImgsData.Campus.buildings[i].floorImg.length;j++){[m[41m[m
[32m+[m[32m        var FloorContainer = new createjs.Container(); // j階のオブジェクトが全て格納される[m[41m[m
[32m+[m[32m        // ---- 4.2.1 各フロアの拡大画像の配置 ----------------------------------------------------[m[41m[m
[32m+[m[32m        var fm_img         = new createjs.Bitmap("/img/"+ j_mapImgsData.Campus.buildings[i].floorImg[j]); // *p[m[41m[m
[32m+[m[32m        var fm_size        = bfm_sizes[i][j];[m[41m[m
[32m+[m[32m        // ---- 4.2.2 canvasのサイズに各フロア画像を合わせる。-------------------------------------[m[41m[m
[32m+[m[32m        if((canvasElement.width/fm_size[0]) * fm_size[1] > canvasElement.height){[m[41m[m
[32m+[m[32m          // 縦横比が合わないと高さがcanvasを超える問題の対処[m[41m[m
[32m+[m[32m          fm_img.scaleX = canvasElement.height / fm_size[1];[m[41m[m
[32m+[m[32m          fm_img.scaleY = fm_img.scaleX;[m[41m[m
[32m+[m[32m          fm_img.x = ( (canvasElement.width - fm_img.scaleY * fm_size[0])/2 );[m[41m[m
[32m+[m[32m        }else{[m[41m[m
[32m+[m[32m          // scale : 現在のcanvasSize / am_img.width[m[41m [m
[32m+[m[32m          fm_img.scaleX = canvasElement.width / fm_size[0];[m[41m[m
[32m+[m[32m          fm_img.scaleY = fm_img.scaleX;[m[41m[m
[32m+[m[32m          fm_img.y = ( (canvasElement.height - fm_img.scaleX * fm_size[1])/2 );[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        FloorContainer.addChild(fm_img);[m[41m[m
[32m+[m[32m        // ---- 4.2.3 ピンの設置 ------------------------------------------------------------------[m[41m[m
[32m+[m[32m        var f_pins         = [];                       // i棟j階におけるピン画像が全て格納される[m[41m [m
[32m+[m[32m        var f_PinContainer = new createjs.Container(); // i棟j階におけるピン画像が全て格納されたコンテナ[m[41m[m
[32m+[m[32m        // ---- 4.2.4 ピン画像・サイズの取得 ------------------------------------------------------[m[41m[m
[32m+[m[32m        var f_pin1Tmp = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_1); // *p[m[41m[m
[32m+[m[32m        var f_pin1Size = await getImageSize(f_pin1Tmp); // pinの画像サイズを取得[m[41m[m
[32m+[m[32m        for(var k=0;k<j_mapImgsData.Campus.buildings[i].pins[j].length;k++){[m[41m[m
[32m+[m[32m          // ---- 4.2.5.1 ピン画像を設置 ----------------------------------------------------------[m[41m[m
[32m+[m[32m          var f_pin    = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_1); // フロア内k番目のピン // *p[m[41m[m
[32m+[m[32m          f_pin.scaleX = gm_general.scaleX;[m[41m[m
[32m+[m[32m          f_pin.scaleY = gm_general.scaleY;[m[41m[m
[32m+[m[32m          f_pin.x      = j_mapImgsData.Campus.buildings[i].pins[j][k].x * gm_general.scaleX + fm_img.x;[m[41m[m
[32m+[m[32m          f_pin.y      = j_mapImgsData.Campus.buildings[i].pins[j][k].y * gm_general.scaleY + fm_img.y;[m[41m[m
[32m+[m[32m          f_PinContainer.addChild(f_pin);[m[41m[m
[32m+[m[32m          // ---- 4.2.5.2 ピン画像を設置 (red) ----------------------------------------------------[m[41m[m
[32m+[m[32m          var f_pin2    = new createjs.Bitmap("/img/"+j_mapImgsData.PinImg_2); // フロア内k番目のピン // *p[m[41m[m
[32m+[m[32m          f_pin2.scaleX = gm_general.scaleX;[m[41m[m
[32m+[m[32m          f_pin2.scaleY = gm_general.scaleY;[m[41m[m
[32m+[m[32m          f_pin2.alpha  = 0;[m[41m[m
[32m+[m[32m          f_pin2.x      = j_mapImgsData.Campus.buildings[i].pins[j][k].x * gm_general.scaleX + fm_img.x;[m[41m[m
[32m+[m[32m          f_pin2.y      = j_mapImgsData.Campus.buildings[i].pins[j][k].y * gm_general.scaleY + fm_img.y;[m[41m[m
[32m+[m[32m          f_PinContainer.addChild(f_pin2);[m[41m[m
[32m+[m[32m          // ---- 4.2.6 ピン画像の上に配置する四角の設置 ------------------------------------------[m[41m[m
[32m+[m[32m          var f_pin_rect = new createjs.Shape();                                // フロア内k番目のピンの上に置く四角[m[41m[m
[32m+[m[32m          f_pin_rect.graphics.beginFill("White");[m[41m[m
[32m+[m[32m          f_pin_rect.graphics.drawRect(0,0,f_pin1Size[0] * f_pin.scaleX,f_pin1Size[1] * f_pin.scaleY);[m[41m      [m
[32m+[m[32m          f_pin_rect.x = f_pin.x;[m[41m[m
[32m+[m[32m          f_pin_rect.y = f_pin.y;[m[41m[m
[32m+[m[32m          f_pin_rect.alpha = 0.0059; // *z 透明度の変更[m[41m[m
[32m+[m[32m          // f_pin_rect.alpha = 0.5;[m[41m[m
[32m+[m[32m          f_PinContainer.addChild(f_pin_rect);[m[41m[m
[32m+[m[32m          f_pins.push(f_pin_rect);//pinの上に係る四角形たちを入れる（クリック判定は透明の四角形）[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        b_pins.push(f_pins);[m[41m[m
[32m+[m[32m        FloorContainer.addChild(f_PinContainer);[m[41m[m
[32m+[m[32m        // ---- 4.2.7 「上の階へ」「3階へ（8棟）」画像の設置 --------------------------------------[m[41m[m
[32m+[m[32m        /*[m[41m[m
[32m+[m[32m        建物の一番上など、上の階が存在しない所には設置しない。[m[41m[m
[32m+[m[32m        主に、jsonから設置する階データを検索し、配置している。[m[41m[m
[32m+[m[32m        */[m[41m[m
[32m+[m[32m        var f_goULcheck = 0; // 設置できたら1、設置しないなら0[m[41m[m
[32m+[m[32m        for(var k=0;k<j_mapImgsData.Campus.buildings[i].goUpper.length;k++){[m[41m[m
[32m+[m[32m          // このフロア(j)に上の階へのオブジェクトのデータが格納されていたら[m[41m[m
[32m+[m[32m          if(j_mapImgsData.Campus.buildings[i].goUpper[k].floor == j){[m[41m[m
[32m+[m[32m            // 上の階へbuttonの設置[m[41m[m
[32m+[m[32m            //8棟3階の処理　ここだけ3階への画像になる[m[41m[m
[32m+[m[32m            if(i== 3 && j == 0){[m[41m[m
[32m+[m[32m              bf_toUpper[i][j] = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goUpperFloorImg_8); // *p[m[41m[m
[32m+[m[32m            }else{[m[41m[m
[32m+[m[32m              bf_toUpper[i][j] = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goUpperFloorImg); // *p[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m            bf_toUpper[i][j].scaleX = gm_general.scaleX;[m[41m[m
[32m+[m[32m            bf_toUpper[i][j].scaleY = gm_general.scaleY;[m[41m[m
[32m+[m[32m            bf_toUpper[i][j].x      = j_mapImgsData.Campus.buildings[i].goUpper[k].x * gm_general.scaleX + fm_img.x;[m[41m[m
[32m+[m[32m            bf_toUpper[i][j].y      = j_mapImgsData.Campus.buildings[i].goUpper[k].y * gm_general.scaleY + fm_img.y;[m[41m[m
[32m+[m[32m            FloorContainer.addChild(bf_toUpper[i][j]);[m[41m[m
[32m+[m[32m            f_goULcheck = 1;[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        if(f_goULcheck == 0)bf_toUpper[i][j] = -1; // 上の階へがない場合-1を格納[m[41m[m
[32m+[m[32m        // ---- 4.2.8 「上の階へ」「1階へ（8棟）」画像の設置 --------------------------------------[m[41m[m
[32m+[m[32m        /*[m[41m[m
[32m+[m[32m        建物の一番下など、下の階が存在しない所には設置しない。[m[41m[m
[32m+[m[32m        主に、jsonから設置する階データを検索し、配置している。[m[41m[m
[32m+[m[32m        */[m[41m[m
[32m+[m[32m        f_goULcheck = 0; // 初期化[m[41m[m
[32m+[m[32m        for(var k=0;k<j_mapImgsData.Campus.buildings[i].goLower.length;k++){[m[41m[m
[32m+[m[32m          // このフロア(j)に下の階へのオブジェクトのデータが格納されていたら[m[41m[m
[32m+[m[32m          if(j_mapImgsData.Campus.buildings[i].goLower[k].floor == j){[m[41m[m
[32m+[m[32m            // 下の階へbuttonの設置[m[41m[m
[32m+[m[32m            if(i== 3 && j == 1){[m[41m[m
[32m+[m[32m              //8棟3階の処理　ここだけ1階への画像になる[m[41m[m
[32m+[m[32m              bf_toLower[i][j] = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goLowerFloorImg_8); // *p[m[41m[m
[32m+[m[32m            }else{[m[41m[m
[32m+[m[32m              // それ以外の普通の棟[m[41m[m
[32m+[m[32m              bf_toLower[i][j] = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goLowerFloorImg); // *p[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m            bf_toLower[i][j].scaleX = gm_general.scaleX;[m[41m[m
[32m+[m[32m            bf_toLower[i][j].scaleY = gm_general.scaleY;[m[41m[m
[32m+[m[32m            bf_toLower[i][j].x      = j_mapImgsData.Campus.buildings[i].goLower[k].x * gm_general.scaleY + fm_img.x;[m[41m[m
[32m+[m[32m            bf_toLower[i][j].y      = j_mapImgsData.Campus.buildings[i].goLower[k].y * gm_general.scaleY + fm_img.y;[m[41m[m
[32m+[m[32m            FloorContainer.addChild(bf_toLower[i][j]);[m[41m[m
[32m+[m[32m            f_goULcheck = 1;[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        if(f_goULcheck == 0)bf_toLower[i][j] = -1; // 下の階へがない場合-1を格納[m[41m[m
[32m+[m[32m        // ---- 4.2.9 「構内TOPへ」画像の設置 -----------------------------------------------------[m[41m[m
[32m+[m[32m        var f_toCampusTop = new createjs.Bitmap("/img/" + j_mapImgsData.Campus.goTopArrow); // *p[m[41m[m
[32m+[m[32m        f_toCampusTop.scaleX = gm_general.scaleX;[m[41m[m
[32m+[m[32m        f_toCampusTop.scaleY = gm_general.scaleY;[m[41m[m
[32m+[m[32m        f_toCampusTop.x      = j_mapImgsData.Campus.buildings[i].goTop[j].x * gm_general.scaleX + fm_img.x;[m[41m[m
[32m+[m[32m        f_toCampusTop.y      = j_mapImgsData.Campus.buildings[i].goTop[j].y * gm_general.scaleY + fm_img.y;[m[41m[m
[32m+[m[32m        FloorContainer.addChild(f_toCampusTop);[m[41m[m
[32m+[m[32m        bf_toCampusTops[i].push(f_toCampusTop);[m[41m[m
[32m+[m[41m        [m
[32m+[m[32m        // ---- 4.2.10 「ピンを表示する画像」の設置 -----------------------------------------------[m[41m[m
[32m+[m[32m        var f_toDisplayPin = new createjs.Bitmap("/img/" + j_mapImgsData.ToDisplayPinImg); // *p[m[41m[m
[32m+[m[32m        f_toDisplayPin.scaleX = gm_general.scaleX * 0.9;[m[41m[m
[32m+[m[32m        f_toDisplayPin.scaleY = gm_general.scaleY * 0.9;[m[41m[m
[32m+[m[32m        f_toDisplayPin.x      = j_mapImgsData.Campus.buildings[i].toDisplayPins[j].x * gm_general.scaleX + fm_img.x;[m[41m[m
[32m+[m[32m        f_toDisplayPin.y      = j_mapImgsData.Campus.buildings[i].toDisplayPins[j].y * gm_general.scaleY + fm_img.y;[m[41m[m
[32m+[m[32m        f_toDisplayPin.alpha  = 0;[m[41m[m
[32m+[m[32m        FloorContainer.addChild(f_toDisplayPin);[m[41m[m
[32m+[m[32m        bf_toDisplayPins[i].push(f_toDisplayPin);[m[41m[m
[32m+[m[32m        // ---- 4.2.11 「ピンを非表示にする画像」の設置 -------------------------------------------[m[41m[m
[32m+[m[32m        var f_toHidePin = new createjs.Bitmap("/img/" + j_mapImgsData.ToHidePinImg); // *p[m[41m[m
[32m+[m[32m        f_toHidePin.scaleX = gm_general.scaleX * 0.9;[m[41m[m
[32m+[m[32m        f_toHidePin.scaleY = gm_general.scaleY * 0.9;[m[41m[m
[32m+[m[32m        f_toHidePin.x      = j_mapImgsData.Campus.buildings[i].toHidePins[j].x * gm_general.scaleX + fm_img.x;[m[41m[m
[32m+[m[32m        f_toHidePin.y      = j_mapImgsData.Campus.buildings[i].toHidePins[j].y * gm_general.scaleY + fm_img.y;[m[41m[m
[32m+[m[32m        f_toHidePin.alpha  = 1;[m[41m[m
[32m+[m[32m        FloorContainer.addChild(f_toHidePin);[m[41m[m
[32m+[m[32m        bf_toHidePins[i].push(f_toHidePin);[m[41m[m
[32m+[m[32m        // このページのデータを格納[m[41m[m
[32m+[m[32m        FloorContainers.push(FloorContainer);[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      bf_pins.push(b_pins);[m[41m[m
[32m+[m[32m      bf_toCampusTops.push(bf_toCampusTops[i]); // forループ出たときi+1されるので-1をしている[m[41m[m
[32m+[m[32m      BuildingFloorContainers.push(FloorContainers);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    bf_toCampusTops.pop(); // 末尾の要素を削除（末尾の要素が一つ多いエラーの削除）[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // :: イベントの検知 ----------------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    var e_balloons        = []; //吹き出しが出ていれば 1 出ていなければ0[m[41m[m
[32m+[m[32m    var e_buildNum        = [2,3,5,7,8]; // 棟の実際の番号（イベント時に結びつける）[m[41m[m
[32m+[m[32m    var e_balloonBuildNum = [2,3,8]; // 吹き出しが存在する棟の番号[m[41m[m
[32m+[m[32m    for(var i=0;i<j_mapImgsData.Campus.balloons.length;i++)e_balloons.push(0);[m[41m[m
[32m+[m[32m    EventListener();　// Eventを感知して処理する関数[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // :: 初期状態にする。（構外全体MAPを表示）------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    if(p_location == "reload") ReloadMapInit();[m[41m[m
[32m+[m[32m    else InitMap();[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 最初の読み込み時の処理（一回目の読み込み時のみ適用[m[41m[m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function InitMap(){[m[41m[m
[32m+[m[32m      var location = new Object();[m[41m[m
[32m+[m[32m      location["target"] = new Object();[m[41m[m
[32m+[m[32m      for(var i=0;i<outSidePins_r.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<outSidePins_r[i].length;j++){[m[41m[m
[32m+[m[32m          switch(p_location){[m[41m[m
[32m+[m[32m            case g_areaTexts[i] +(j+1):[m[41m[m
[32m+[m[32m              DisplayContainer.addChild(areaContainers[i]);[m[41m[m
[32m+[m[32m              location.target.eventParam  = i;[m[41m[m
[32m+[m[32m              location.target.eventParam2 = j;[m[41m[m
[32m+[m[32m              OutsideWriteInfo(location);[m[41m[m
[32m+[m[32m              return;[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      for(var i=0;i<bf_pins.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<bf_pins[i].length;j++){[m[41m[m
[32m+[m[32m          for(var k=0;k<bf_pins[i][j].length;k++){[m[41m[m
[32m+[m[32m            switch(p_location){[m[41m[m
[32m+[m[32m              case String(e_buildNum[i])+String(j+1)+String(k+1):[m[41m[m
[32m+[m[32m                DisplayContainer.addChild(BuildingFloorContainers[i][j]);[m[41m[m
[32m+[m[32m                location.target.eventParam  = i;[m[41m[m
[32m+[m[32m                location.target.eventParam2 = j;[m[41m[m
[32m+[m[32m                location.target.eventParam3 = k;[m[41m[m
[32m+[m[32m                InsideWriteInfo(location);[m[41m[m
[32m+[m[32m                return;[m[41m[m
[32m+[m[32m            }[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      if(p_location == "OutsideTop"){[m[41m[m
[32m+[m[32m        DisplayContainer.addChild(OutsideContainer);[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 再読み込みしたときに正しく表示する関数[m[41m[m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function ReloadMapInit(){[m[41m[m
[32m+[m[32m      for(var i=0;i<g_areaTexts.length;i++){[m[41m[m
[32m+[m[32m        switch(currentMapID){[m[41m[m
[32m+[m[32m          case "Area"+g_areaTexts[i]:[m[41m[m
[32m+[m[32m            DisplayContainer.addChild(areaContainers[i]);[m[41m[m
[32m+[m[32m            return;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      for(var i=0;i<BuildingFloorContainers.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<BuildingFloorContainers[i].length;j++){[m[41m[m
[32m+[m[32m          switch(currentMapID){[m[41m[m
[32m+[m[32m            case "BF"+ e_buildNum[i]+(parseInt(j)+1):[m[41m[m
[32m+[m[32m              DisplayContainer.addChild(BuildingFloorContainers[i][j]);[m[41m[m
[32m+[m[32m              return;[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      switch(currentMapID){[m[41m[m
[32m+[m[32m        case "OutsideTop":[m[41m[m
[32m+[m[32m          DisplayContainer.addChild(OutsideContainer);[m[41m[m
[32m+[m[32m          return;[m[41m[m
[32m+[m[32m        case "InsideTop":[m[41m[m
[32m+[m[32m          DisplayContainer.addChild(InsideTopContainer);[m[41m[m
[32m+[m[32m          return;[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * イベントを感知して処理する関数[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function EventListener(){[m[41m[m
[32m+[m[32m      // 1. 構内への矢印に対する処理[m[41m[m
[32m+[m[32m      toCampusArrow.addEventListener("click",GeneraltoCampusTop);[m[41m[m
[32m+[m[32m      // 2. 構外への矢印に対する処理[m[41m[m
[32m+[m[32m      toOutsideArrow.addEventListener("click",CampusToptoGeneral);[m[41m[m
[32m+[m[32m      // 3. エリアを示す四角に対する処理[m[41m[m
[32m+[m[32m      for(var i=0;i<g_rects.length;i++){[m[41m[m
[32m+[m[32m        g_rects[i].addEventListener("click",GeneraltoArea);[m[41m [m
[32m+[m[32m        g_rects[i].eventParam = i ;[m[41m[m
[32m+[m[32m        // 4. エリア内にとんだときに全体エリアに飛ぶ処理[m[41m[m
[32m+[m[32m        a_toGenerals[i].addEventListener("click",AreatoGeneral);[m[41m[m
[32m+[m[32m        a_toGenerals[i].eventParam = i;[m[41m[m
[32m+[m[32m        // 5. 構外MAPピンに対する処理[m[41m[m
[32m+[m[32m        for(var j=0;j<j_mapImgsData.OutsideAreas[i].pins.length;j++){[m[41m[m
[32m+[m[32m          outSidePins_r[i][j].addEventListener("click",OutsideWriteInfo);[m[41m[m
[32m+[m[32m          outSidePins_r[i][j].eventParam  = i;[m[41m[m
[32m+[m[32m          outSidePins_r[i][j].eventParam2 = j;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        // 12. ピンを表示するボタンに対する処理[m[41m[m
[32m+[m[32m        a_toDisplayPins[i].addEventListener("click",DisplayPins);[m[41m[m
[32m+[m[32m        a_toDisplayPins[i].eventParam = i;[m[41m[m
[32m+[m[32m        // 13. ピンを非表示にするボタンに対する処理[m[41m[m
[32m+[m[32m        a_toHidePins[i].addEventListener("click",HidePins);[m[41m[m
[32m+[m[32m        a_toHidePins[i].eventParam = i;[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      // 6. 構内の棟を示す四角に対する処理 >> 吹き出しの出現[m[41m[m
[32m+[m[32m      for(var i=0;i<c_rects.length;i++){[m[41m[m
[32m+[m[32m        //c_rects : 吹き出しを出すための四角[m[41m[m
[32m+[m[32m        c_rects[i].addEventListener("click",SetBalloon); // CampusTop to Buildings[m[41m [m
[32m+[m[32m        c_rects[i].eventParam = i ;[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      // 7. 構内の吹き出しの中身に対する処理[m[41m[m
[32m+[m[32m      for(var i=0;i<c_balloons.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<c_balloonsRects[i].length;j++){[m[41m[m
[32m+[m[32m          c_balloonsRects[i][j].addEventListener("click",BalloontoCampus);[m[41m[m
[32m+[m[32m          c_balloonsRects[i][j].eventParam  = i;[m[41m[m
[32m+[m[32m          c_balloonsRects[i][j].eventParam2 = j;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      // 8. 構内TOPへに対する処理[m[41m[m
[32m+[m[32m      for(var i=0;i<bf_toCampusTops.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<bf_toCampusTops[i].length;j++){[m[41m[m
[32m+[m[32m          bf_toCampusTops[i][j].addEventListener("click",FloortoCampusTop);[m[41m[m
[32m+[m[32m          bf_toCampusTops[i][j].eventParam  = i;[m[41m[m
[32m+[m[32m          bf_toCampusTops[i][j].eventParam2 = j;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      // 9. 構内の各ピンに対する処理[m[41m[m
[32m+[m[32m      for(var i=0;i<bf_pins.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<bf_pins[i].length;j++){[m[41m[m
[32m+[m[32m          for(var k=0;k<bf_pins[i][j].length;k++){[m[41m[m
[32m+[m[32m            bf_pins[i][j][k].addEventListener("click",InsideWriteInfo);[m[41m[m
[32m+[m[32m            bf_pins[i][j][k].eventParam  = i;[m[41m[m
[32m+[m[32m            bf_pins[i][j][k].eventParam2 = j;[m[41m[m
[32m+[m[32m            bf_pins[i][j][k].eventParam3 = k;[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m          // 14. ピンを表示するボタンに対する処理[m[41m[m
[32m+[m[32m          bf_toDisplayPins[i][j].addEventListener("click",DisplayPins);[m[41m[m
[32m+[m[32m          bf_toDisplayPins[i][j].eventParam  = i;[m[41m[m
[32m+[m[32m          bf_toDisplayPins[i][j].eventParam2 = j;[m[41m[m
[32m+[m[32m          // 15. ピンを表示するボタンに対する処理[m[41m[m
[32m+[m[32m          bf_toHidePins[i][j].addEventListener("click",HidePins);[m[41m[m
[32m+[m[32m          bf_toHidePins[i][j].eventParam  = i;[m[41m[m
[32m+[m[32m          bf_toHidePins[i][j].eventParam2 = j;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      // 10. 上の階へのボタンに対する処理[m[41m[m
[32m+[m[32m      for(var i=0;i<bf_toUpper.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<bf_toUpper[i].length;j++){[m[41m[m
[32m+[m[32m          if(bf_toUpper[i][j]!=-1){[m[41m[m
[32m+[m[32m            bf_toUpper[i][j].addEventListener("click",FloortoUpperFloor);[m[41m[m
[32m+[m[32m            bf_toUpper[i][j].eventParam  = i;[m[41m[m
[32m+[m[32m            bf_toUpper[i][j].eventParam2 = j;[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      // 11. 下の階へのボタンに対する処理[m[41m[m
[32m+[m[32m      for(var i=0;i<bf_toLower.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<bf_toLower[i].length;j++){[m[41m[m
[32m+[m[32m          if(bf_toLower[i][j]!=-1){[m[41m[m
[32m+[m[32m            bf_toLower[i][j].addEventListener("click",FloortoLowerFloor);[m[41m[m
[32m+[m[32m            bf_toLower[i][j].eventParam  = i;[m[41m[m
[32m+[m[32m            bf_toLower[i][j].eventParam2 = j;[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m [m
[32m+[m[32m    }//ここまでEventListener[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // :: イベントに対する処理　関数群 --------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 全体画面から各エリアへ飛ぶ[m[41m[m
[32m+[m[32m     * @param {obj} event[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function GeneraltoArea(event){[m[41m[m
[32m+[m[32m      var i = event.target.eventParam;[m[41m[m
[32m+[m[32m      currentMapID = "Area" + g_areaTexts[i];[m[41m[m
[32m+[m[32m      MapChange(OutsideContainer,areaContainers[i]);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 構外の各エリアから全体へ[m[41m [m
[32m+[m[32m     * @param {obj} event[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function AreatoGeneral(event){[m[41m[m
[32m+[m[32m      var i = event.target.eventParam;[m[41m[m
[32m+[m[32m      currentMapID = "OutsideTop";[m[41m[m
[32m+[m[32m      MapChange(areaContainers[i],OutsideContainer);[m[41m[m
[32m+[m[32m      InitPinColor();[m[41m[m
[32m+[m[32m      ClearInfo();[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 全体から構内topへ[m[41m[m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function GeneraltoCampusTop(event){[m[41m[m
[32m+[m[32m      //MapChange(OutsideContainer,InsideTopContainer);[m[41m[m
[32m+[m[32m      currentMapID = "InsideTop";[m[41m[m
[32m+[m[32m      MapChangeAnimation_Slide(OutsideContainer,InsideTopContainer,"right");[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 構内Topから全体へ[m[41m[m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function CampusToptoGeneral(event){[m[41m[m
[32m+[m[32m      // 吹き出しが出ていたらそれを消す[m[41m[m
[32m+[m[32m      for(var k=0;k<c_balloons.length;k++){[m[41m[m
[32m+[m[32m        if(e_balloons[k] == 1){[m[41m[m
[32m+[m[32m          InsideTopContainer.removeChild(balloonContainers[k]);[m[41m[m
[32m+[m[32m          e_balloons[k] = 0;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      //MapChange(InsideTopContainer,OutsideContainer);[m[41m[m
[32m+[m[32m      currentMapID = "OutsideTop";[m[41m[m
[32m+[m[32m      MapChangeAnimation_Slide(InsideTopContainer,OutsideContainer,"left");[m[41m      [m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 構内Topから吹き出しを出力[m[41m[m
[32m+[m[32m     * @param {obj} event[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function SetBalloon(event){[m[41m[m
[32m+[m[32m      var i = event.target.eventParam;[m[41m[m
[32m+[m[32m      // 吹き出しに対応していなければその棟の1階にジャンプ[m[41m[m
[32m+[m[32m      var check = false;[m[41m[m
[32m+[m[32m      var e_balloonTarget; // 吹き出し対応リストの添え字（吹き出し対応のみ）[m[41m[m
[32m+[m[32m      for(var j=0;j<e_balloonBuildNum.length;j++){[m[41m[m
[32m+[m[32m        if(e_balloonBuildNum[j] == e_buildNum[i]){[m[41m[m
[32m+[m[32m          // 吹き出しに対応していたら[m[41m[m
[32m+[m[32m          // j : 棟番号がiのときの吹き出し対応リストの添え字[m[41m[m
[32m+[m[32m          e_balloonTarget = j ;[m[41m[m
[32m+[m[32m          check = true;[m[41m[m
[32m+[m[32m          break;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      if(check==false){[m[41m[m
[32m+[m[32m        // 吹き出しに対応していないオブジェクト（5棟など）[m[41m[m
[32m+[m[32m        currentMapID = "BF" + e_buildNum[i] + "1";[m[41m[m
[32m+[m[32m        if(e_buildNum[i] == 7){[m[41m[m
[32m+[m[32m          // ** 7棟の処理[m[41m[m
[32m+[m[32m          console.log("7tou");[m[41m[m
[32m+[m[32m        }else{[m[41m[m
[32m+[m[32m          MapChange(InsideTopContainer,BuildingFloorContainers[i][0]);[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        return;[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      // すでに出ている吹き出しをクリックしたとき[m[41m[m
[32m+[m[32m      if(e_balloons[e_balloonTarget] == 1){[m[41m[m
[32m+[m[32m        InsideTopContainer.removeChild(balloonContainers[e_balloonTarget]);[m[41m[m
[32m+[m[32m        e_balloons[e_balloonTarget] = 0;[m[41m[m
[32m+[m[32m        return;[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      // クリックしたときにほかの吹き出しが開いていた時[m[41m[m
[32m+[m[32m      for(var j=0;j<c_balloons.length;j++){[m[41m[m
[32m+[m[32m        if(e_balloons[j] == 1){[m[41m[m
[32m+[m[32m          InsideTopContainer.removeChild(balloonContainers[j]);[m[41m[m
[32m+[m[32m          e_balloons[j] = 0;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      InsideTopContainer.addChild(balloonContainers[e_balloonTarget]);[m[41m[m
[32m+[m[32m      e_balloons[e_balloonTarget] = 1;[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 吹き出しから各棟の階へ[m[41m[m
[32m+[m[32m     * @param {obj} event[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function BalloontoCampus(event){[m[41m[m
[32m+[m[32m      var i = event.target.eventParam;[m[41m[m
[32m+[m[32m      var j = event.target.eventParam2;[m[41m[m
[32m+[m[32m      // e_ballons[i] 棟の吹き出しのj階をクリックした[m[41m[m
[32m+[m[32m      //console.log(String(e_balloonBuildNum[i])+"棟の"+String(j)+"階をクリックしました");[m[41m[m
[32m+[m[32m      // i,jをBuildingFloorContainerないの適切な値に変更する[m[41m[m
[32m+[m[32m      //e_balloonBuildNum = [2,3,8] >> BuildingFloorContainers[i] = [0,1,3]  (2は5棟)[m[41m[m
[32m+[m[32m      var buildingIndex = [0,1,3]; //吹き出しから飛べる棟番号(e_balloonBuildNumに対応)[m[41m[m
[32m+[m[32m      // 今開いている吹き出しを検索して閉じる[m[41m[m
[32m+[m[32m      for(var k=0;k<c_balloons.length;k++){[m[41m[m
[32m+[m[32m        if(e_balloons[k] == 1){[m[41m[m
[32m+[m[32m          InsideTopContainer.removeChild(balloonContainers[k]);[m[41m[m
[32m+[m[32m          e_balloons[k] = 0;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      currentMapID = "BF"+ e_balloonBuildNum[i]+(parseInt(j)+1);[m[41m[m
[32m+[m[32m      MapChange(InsideTopContainer,BuildingFloorContainers[buildingIndex[i]][j]);[m[41m[m
[32m+[m[32m      //MapChangeAnimation_Fade(InsideTopContainer,BuildingFloorContainers[buildingIndex[i]][j])[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * フロアから構内TOPへ[m[41m[m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function FloortoCampusTop(event){[m[41m[m
[32m+[m[32m      var i = event.target.eventParam;[m[41m[m
[32m+[m[32m      var j = event.target.eventParam2;[m[41m[m
[32m+[m[32m      //MapChange(BuildingFloorContainers[i][j],InsideTopContainer);[m[41m[m
[32m+[m[32m      currentMapID = "InsideTop";[m[41m[m
[32m+[m[32m      MapChangeAnimation_Slide(BuildingFloorContainers[i][j],InsideTopContainer,"left");[m[41m[m
[32m+[m[32m      InitPinColor();[m[41m [m
[32m+[m[32m      ClearInfo();[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 上の階へ[m[41m[m
[32m+[m[32m     * @param {obj} event[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function FloortoUpperFloor(event){[m[41m[m
[32m+[m[32m      var i = event.target.eventParam;[m[41m[m
[32m+[m[32m      var j = event.target.eventParam2;[m[41m[m
[32m+[m[32m      if(bf_toUpper[i][j]==-1)return;[m[41m[m
[32m+[m[32m      // MapChange(BuildingFloorContainers[i][j],BuildingFloorContainers[i][j+1]);[m[41m[m
[32m+[m[32m      currentMapID = "BF" + e_buildNum[i]+(parseInt(j)+2);[m[41m[m
[32m+[m[32m      MapChangeAnimation_Slide(BuildingFloorContainers[i][j],BuildingFloorContainers[i][j+1],"top");[m[41m[m
[32m+[m[32m      InitPinColor();[m[41m[m
[32m+[m[32m      ClearInfo();[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 下の階へ[m[41m[m
[32m+[m[32m     * @param {obj} event[m[41m[m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function FloortoLowerFloor(event){[m[41m[m
[32m+[m[32m      var i = event.target.eventParam;[m[41m[m
[32m+[m[32m      var j = event.target.eventParam2;[m[41m[m
[32m+[m[32m      if(bf_toLower[i][j]==-1)return;[m[41m[m
[32m+[m[32m      currentMapID = "BF" + e_buildNum[i]+(parseInt(j));[m[41m[m
[32m+[m[32m      //MapChange(BuildingFloorContainers[i][j],BuildingFloorContainers[i][j-1]);[m[41m[m
[32m+[m[32m      MapChangeAnimation_Slide(BuildingFloorContainers[i][j],BuildingFloorContainers[i][j-1],"bottom");[m[41m[m
[32m+[m[32m      InitPinColor();[m[41m[m
[32m+[m[32m      ClearInfo();[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * ピンを表示（すべて）[m[41m[m
[32m+[m[32m     * @param {obj} event[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function DisplayPins(event){[m[41m[m
[32m+[m[32m      var TimeLine = new createjs.Timeline();[m[41m[m
[32m+[m[32m      var changetime = 400;[m[41m[m
[32m+[m[32m      for(var i=0;i<a_pinContainers.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<a_pinContainers[i].children.length/3;j++){[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(a_pinContainers[i].children[3*j],{override:false})[m[41m[m
[32m+[m[32m              .to({alpha : 1},changetime)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(a_pinContainers[i].children[3*j+1],{override:false})[m[41m[m
[32m+[m[32m              .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          a_pinContainers[i].children[3*j +2].visible = true;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        TimeLine.addTween([m[41m[m
[32m+[m[32m          createjs.Tween.get(a_toDisplayPins[i],{override:false})[m[41m[m
[32m+[m[32m            .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m        );[m[41m[m
[32m+[m[32m        TimeLine.addTween([m[41m[m
[32m+[m[32m          createjs.Tween.get(a_toHidePins[i],{override:false})[m[41m[m
[32m+[m[32m            .to({alpha : 1},changetime)[m[41m[m
[32m+[m[32m        );[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      for(var i=0;i<bf_toDisplayPins.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<bf_toDisplayPins[i].length;j++){[m[41m[m
[32m+[m[32m          // f_PinContainersにアクセスする[m[41m[m
[32m+[m[32m          for(var k=0;k<BuildingFloorContainers[i][j].children[1].children.length/3;k++){[m[41m[m
[32m+[m[32m            TimeLine.addTween([m[41m[m
[32m+[m[32m              createjs.Tween.get(BuildingFloorContainers[i][j].children[1].children[3*k],{override:false})[m[41m[m
[32m+[m[32m                .to({alpha : 1},changetime)[m[41m[m
[32m+[m[32m            );[m[41m[m
[32m+[m[32m            TimeLine.addTween([m[41m[m
[32m+[m[32m              createjs.Tween.get(BuildingFloorContainers[i][j].children[1].children[3*k+1],{override:false})[m[41m[m
[32m+[m[32m                .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m            );[m[41m[m
[32m+[m[32m            BuildingFloorContainers[i][j].children[1].children[3*k+2].visible = true;[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(bf_toDisplayPins[i][j],{override:false})[m[41m[m
[32m+[m[32m              .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(bf_toHidePins[i][j],{override:false})[m[41m[m
[32m+[m[32m              .to({alpha : 1},changetime)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 全てのピンを非表示[m[41m[m
[32m+[m[32m     * @param {obj} event[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function HidePins(event){[m[41m[m
[32m+[m[32m      var TimeLine = new createjs.Timeline();[m[41m[m
[32m+[m[32m      var changetime = 400;[m[41m[m
[32m+[m[32m      for(var i=0;i<a_pinContainers.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<a_pinContainers[i].children.length/3;j++){[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(a_pinContainers[i].children[3*j],{override:false})[m[41m[m
[32m+[m[32m              .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(a_pinContainers[i].children[3*j+1],{override:false})[m[41m[m
[32m+[m[32m              .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          a_pinContainers[i].children[3*j+2].visible = false;[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m        TimeLine.addTween([m[41m[m
[32m+[m[32m          createjs.Tween.get(a_toDisplayPins[i],{override:false})[m[41m[m
[32m+[m[32m            .to({alpha : 1},changetime)[m[41m[m
[32m+[m[32m        );[m[41m[m
[32m+[m[32m        TimeLine.addTween([m[41m[m
[32m+[m[32m          createjs.Tween.get(a_toHidePins[i],{override:false})[m[41m[m
[32m+[m[32m            .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m        );[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      for(var i=0;i<bf_toDisplayPins.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<bf_toDisplayPins[i].length;j++){[m[41m[m
[32m+[m[32m          // f_PinContainersにアクセスする[m[41m[m
[32m+[m[32m          for(var k=0;k<BuildingFloorContainers[i][j].children[1].children.length/3;k++){[m[41m[m
[32m+[m[32m            TimeLine.addTween([m[41m[m
[32m+[m[32m              createjs.Tween.get(BuildingFloorContainers[i][j].children[1].children[3*k],{override:false})[m[41m[m
[32m+[m[32m                .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m            );[m[41m[m
[32m+[m[32m            TimeLine.addTween([m[41m[m
[32m+[m[32m              createjs.Tween.get(BuildingFloorContainers[i][j].children[1].children[3*k+1],{override:false})[m[41m[m
[32m+[m[32m                .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m            );[m[41m[m
[32m+[m[32m            BuildingFloorContainers[i][j].children[1].children[3*k+2].visible = false;[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(bf_toDisplayPins[i][j],{override:false})[m[41m[m
[32m+[m[32m              .to({alpha : 1},changetime)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(bf_toHidePins[i][j],{override:false})[m[41m[m
[32m+[m[32m              .to({alpha : 0},changetime)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      TimeLine.gotoAndPlay("start");[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 全てのピンの色を青色に変化させる（初期化）[m[41m[m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function InitPinColor(){[m[41m[m
[32m+[m[32m      var TimeLine = new createjs.Timeline();[m[41m[m
[32m+[m[32m      var changetime = 0;[m[41m[m
[32m+[m[32m      for(var i=0;i<a_pinContainers.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<a_pinContainers[i].children.length/3;j++){[m[41m[m
[32m+[m[32m          a_pinContainers[i].children[3*j  ].alpha   = 1;[m[41m[m
[32m+[m[32m          a_pinContainers[i].children[3*j+1].alpha   = 0;[m[41m[m
[32m+[m[32m          a_pinContainers[i].children[3*j+2].visible = true; //rect[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      for(var i=0;i<bf_toDisplayPins.length;i++){[m[41m[m
[32m+[m[32m        for(var j=0;j<bf_toDisplayPins[i].length;j++){[m[41m[m
[32m+[m[32m          // f_PinContainersにアクセスする[m[41m[m
[32m+[m[32m          for(var k=0;k<BuildingFloorContainers[i][j].children[1].children.length/3;k++){[m[41m[m
[32m+[m[32m            BuildingFloorContainers[i][j].children[1].children[3*k  ].alpha   = 1;[m[41m[m
[32m+[m[32m            BuildingFloorContainers[i][j].children[1].children[3*k+1].alpha   = 0;[m[41m[m
[32m+[m[32m            BuildingFloorContainers[i][j].children[1].children[3*k+2].visible = true; // rect[m[41m[m
[32m+[m[32m          }[m[41m[m
[32m+[m[32m        }[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      TimeLine.gotoAndPlay("start");[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 構外のしてしたピンの色を変える（赤くする）[m[41m[m
[32m+[m[32m     * @param {int} area[m[41m [m
[32m+[m[32m     * @param {int} pinNum[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function OutsideChangePinColor(area,pinNum){[m[41m[m
[32m+[m[32m      var TimeLine = new createjs.Timeline();[m[41m[m
[32m+[m[32m      var changetime = 400;[m[41m[m
[32m+[m[32m      // a_pinContainers[area].children[3*pinNum]; >> red Pin[m[41m[m
[32m+[m[32m      // a_pinContainrs[area].children[3*pinNum+1] >> blue Pin[m[41m[m
[32m+[m[32m      TimeLine.addTween([m[41m[m
[32m+[m[32m        createjs.Tween.get(a_pinContainers[area].children[3*pinNum],{override:true})[m[41m[m
[32m+[m[32m          .to({alpha:0},changetime)[m[41m[m
[32m+[m[32m      );[m[41m[m
[32m+[m[32m      TimeLine.addTween([m[41m[m
[32m+[m[32m        createjs.Tween.get(a_pinContainers[area].children[3*pinNum+1],{override:true})[m[41m[m
[32m+[m[32m          .to({alpha:1},changetime)[m[41m[m
[32m+[m[32m      );[m[41m[m
[32m+[m[32m      TimeLine.gotoAndPlay("start");[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 構内の指定したピンの色を変える（赤くする）[m[41m[m
[32m+[m[32m     * @param {int} building[m[41m [m
[32m+[m[32m     * @param {int} floor[m[41m [m
[32m+[m[32m     * @param {int} pinNum[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function InsideChangePinColor(building,floor,pinNum){[m[41m[m
[32m+[m[32m      var TimeLine = new createjs.Timeline();[m[41m[m
[32m+[m[32m      var changetime = 400;[m[41m[m
[32m+[m[32m      // BuildingFloorContainers[building][floor].children[1].children[3*pinNum]; >> red Pin[m[41m[m
[32m+[m[32m      // BuildingFloorContainers[building][floor].children[1].children[3*pinNum]; >> blue Pin[m[41m[m
[32m+[m[32m      TimeLine.addTween([m[41m[m
[32m+[m[32m        createjs.Tween.get(BuildingFloorContainers[building][floor].children[1].children[3*pinNum],{override:true})[m[41m[m
[32m+[m[32m          .to({alpha:0},changetime)[m[41m[m
[32m+[m[32m      );[m[41m[m
[32m+[m[32m      TimeLine.addTween([m[41m[m
[32m+[m[32m        createjs.Tween.get(BuildingFloorContainers[building][floor].children[1].children[3*pinNum+1],{override:true})[m[41m[m
[32m+[m[32m          .to({alpha:1},changetime)[m[41m[m
[32m+[m[32m      );[m[41m[m
[32m+[m[32m      TimeLine.gotoAndPlay("start");[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * BoothData(html)をbooth.jsonから取得する[m[41m[m
[32m+[m[32m     * @param {string} boothID[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function GetLocationData(boothID){[m[41m[m
[32m+[m[32m      if(boothID.match(/labo/)){[m[41m[m
[32m+[m[32m        return j_laboData[boothID];[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      if(boothID == "consert"){[m[41m[m
[32m+[m[32m        console.log("consert");[m[41m[m
[32m+[m[32m        return "consert";[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      return j_boothData[boothID];[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * DOMに情報を書き込む（構外模擬店情報）[m[41m[m
[32m+[m[32m     * @param {obj} event[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function OutsideWriteInfo(event){[m[41m[m
[32m+[m[32m      var i = event.target.eventParam;[m[41m[m
[32m+[m[32m      var j = event.target.eventParam2;[m[41m[m
[32m+[m[32m      InitPinColor();[m[41m[m
[32m+[m[32m      OutsideChangePinColor(i,j);[m[41m[m
[32m+[m[32m      dh_pindata.textContent = "エリア"+g_areaTexts[i]+"の"+(parseInt(j)+1)+"番目";[m[41m[m
[32m+[m[32m      var boothID = j_boothID["Outside" + g_areaTexts[i] + (parseInt(j)+1)];[m[41m[m
[32m+[m[32m      h_boothdata.innerHTML  = GetLocationData(boothID);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // DOMに情報を書き込む（構内）-------------------------------------------------------[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * DOMに情報を書き込む（構内模擬店情報）[m[41m[m
[32m+[m[32m     * @param {obj} event[m[41m[m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function InsideWriteInfo(event){[m[41m[m
[32m+[m[32m      var i = event.target.eventParam;[m[41m[m
[32m+[m[32m      var j = event.target.eventParam2;[m[41m[m
[32m+[m[32m      var k = event.target.eventParam3;[m[41m[m
[32m+[m[32m      InitPinColor();[m[41m[m
[32m+[m[32m      InsideChangePinColor(i,j,k);[m[41m[m
[32m+[m[32m      if(i==3)i=4;[m[41m[m
[32m+[m[32m      dh_pindata.textContent = e_buildNum[i]+"棟"+(parseInt(j)+1)+"階の"+(parseInt(k)+1)+"番目のピン";[m[41m[m
[32m+[m[32m      var boothID = j_boothID["Inside" + e_buildNum[i] + (parseInt(j)+1) + (parseInt(k)+1)];[m[41m[m
[32m+[m[32m      h_boothdata.innerHTML  = GetLocationData(boothID);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * DOM情報を全て消去する[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function ClearInfo(){[m[41m[m
[32m+[m[32m      dh_pindata = "";[m[41m[m
[32m+[m[32m      h_boothdata.innerHTML = "";[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // ここまでイベントに対する処理の関数群 ---------------------------------------------------------------------------[m[41m[m
[32m+[m[41m[m
[32m+[m[41m[m
[32m+[m[32m    // ページ切り替えについての関数群 ---------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 現在のページから、次のページに切り替える（アニメーションなし）[m[41m[m
[32m+[m[32m     * @param {createjs.Container} CurrentContainer[m[41m [m
[32m+[m[32m     * @param {createjs.Container} NextContainer[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function MapChange(CurrentContainer,NextContainer){[m[41m[m
[32m+[m[32m      DisplayContainer.removeChild(CurrentContainer);[m[41m[m
[32m+[m[32m      DisplayContainer.addChild(NextContainer);[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 現在のぺ―ジから次のページに切り替わる （フェードアニメーション）[m[41m[m
[32m+[m[32m     * @param {createjs.Container} CurrentContainer[m[41m [m
[32m+[m[32m     * @param {createjs.Container} NextContainer[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function MapChangeAnimation_Fade(CurrentContainer,NextContainer){[m[41m[m
[32m+[m[32m      var TimeLine   = new createjs.Timeline(); // タイムライン[m[41m[m
[32m+[m[32m      var changetime = 600; // アニメーションにかかる時間（ms)[m[41m[m
[32m+[m[32m      // 現在のページの処理[m[41m[m
[32m+[m[32m      TimeLine.addTween([m[41m[m
[32m+[m[32m        // changetime[ms]をかけて現在のページの透明度を０にする[m[41m[m
[32m+[m[32m        createjs.Tween.get(CurrentContainer,{override:false})[m[41m[m
[32m+[m[32m          .to({alpha:0},changetime)[m[41m[m
[32m+[m[32m          .call(function(){[m[41m[m
[32m+[m[32m            // アニメーションが終了したら現在のページを消す(透明度を元に戻しておく)[m[41m[m
[32m+[m[32m            CurrentContainer.alpha = 1;[m[41m[m
[32m+[m[32m            DisplayContainer.removeChild(CurrentContainer);[m[41m[m
[32m+[m[32m          })[m[41m[m
[32m+[m[32m      );[m[41m[m
[32m+[m[32m      // 次のページの処理[m[41m[m
[32m+[m[32m      NextContainer.alpha = 0;[m[41m[m
[32m+[m[32m      DisplayContainer.addChild(NextContainer);[m[41m[m
[32m+[m[32m      TimeLine.addTween([m[41m[m
[32m+[m[32m        // changetime[ms]をかけて現在の透明度を１にする[m[41m[m
[32m+[m[32m        createjs.Tween.get(NextContainer,{oevrride:true})[m[41m[m
[32m+[m[32m          .to({alpha:1},changetime)[m[41m[m
[32m+[m[32m      )[m[41m[m
[32m+[m[32m      TimeLine.gotoAndPlay("start");[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    /**[m[41m[m
[32m+[m[32m     * 現在のページから次のページに切り替わる （スライドアニメーション）-[m[41m[m
[32m+[m[32m     * @param {createjs.Container} CurrentContainer[m[41m [m
[32m+[m[32m     * @param {createjs.Container} NextContainer[m[41m [m
[32m+[m[32m     * @param {createjs.Container} direction[m[41m [m
[32m+[m[32m     */[m[41m[m
[32m+[m[32m    function MapChangeAnimation_Slide(CurrentContainer,NextContainer,direction){[m[41m[m
[32m+[m[32m      /*[m[41m[m
[32m+[m[32m      direction : top    : 上の階に行くときに使う。[m[41m[m
[32m+[m[32m      direction : bottom : 下の階へ行くときに使う。[m[41m[m
[32m+[m[32m      direction : left   : 構外マップへ行くとき[m[41m[m
[32m+[m[32m      direction : right  : 構内マップへ行くとき[m[41m[m
[32m+[m[32m      */[m[41m[m
[32m+[m[32m      var TimeLine   = new createjs.Timeline(); // タイムライン[m[41m[m
[32m+[m[32m      var changetime = 600; // アニメーションにかかる時間（ms)[m[41m[m
[32m+[m[32m      // direction : 方向別に処理を分ける[m[41m[m
[32m+[m[32m      switch(direction){[m[41m[m
[32m+[m[32m        case "top":[m[41m[m
[32m+[m[32m          // 現在のページの処理[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            // changetime[ms]で下方向に移動させる[m[41m[m
[32m+[m[32m            createjs.Tween.get(CurrentContainer,{override:false},changetime)[m[41m[m
[32m+[m[32m              .to({y:canvasElement.height},changetime,createjs.Ease.cubicInOut)[m[41m[m
[32m+[m[32m              .call(function(){[m[41m[m
[32m+[m[32m                // アニメーション終了時に現在表示していたマップの座標を0に戻し、消す[m[41m[m
[32m+[m[32m                CurrentContainer.y=0;[m[41m[m
[32m+[m[32m                DisplayContainer.removeChild(CurrentContainer);[m[41m[m
[32m+[m[32m              })[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          // 次のページの処理[m[41m[m
[32m+[m[32m          // 初期化[m[41m[m
[32m+[m[32m          NextContainer.y = -1 * canvasElement.height;[m[41m[m
[32m+[m[32m          DisplayContainer.addChild(NextContainer);[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(NextContainer,{override:false})[m[41m[m
[32m+[m[32m              // changetime[ms]で下方向に移動させる[m[41m[m
[32m+[m[32m              .to({y:0},changetime,createjs.Ease.cubicInOut)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          break;[m[41m[m
[32m+[m[32m        case "bottom":[m[41m[m
[32m+[m[32m          // 現在のページの処理[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            // changetime[ms]で上方向に移動させる[m[41m[m
[32m+[m[32m            createjs.Tween.get(CurrentContainer,{override:false},changetime)[m[41m[m
[32m+[m[32m              .to({y:-1*canvasElement.height},changetime,createjs.Ease.cubicInOut)[m[41m[m
[32m+[m[32m              .call(function(){[m[41m[m
[32m+[m[32m                // アニメーション終了時に現在表示していたマップの座標を0に戻し、消す[m[41m[m
[32m+[m[32m                CurrentContainer.y=0;[m[41m[m
[32m+[m[32m                DisplayContainer.removeChild(CurrentContainer);[m[41m[m
[32m+[m[32m              })[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          // 次のページの処理[m[41m[m
[32m+[m[32m          // 初期化[m[41m[m
[32m+[m[32m          NextContainer.y = canvasElement.height;[m[41m[m
[32m+[m[32m          DisplayContainer.addChild(NextContainer);[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(NextContainer,{override:false})[m[41m[m
[32m+[m[32m              // changetime[ms]で上方向に移動させる[m[41m[m
[32m+[m[32m              .to({y:0},changetime,createjs.Ease.cubicInOut)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          break;[m[41m[m
[32m+[m[32m        case "right":[m[41m[m
[32m+[m[32m          // 現在のページの処理[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            // changetime[ms]で左方向に移動させる[m[41m[m
[32m+[m[32m            createjs.Tween.get(CurrentContainer,{override:false},changetime)[m[41m[m
[32m+[m[32m              .to({x:-1*canvasElement.width},changetime,createjs.Ease.cubicInOut)[m[41m[m
[32m+[m[32m              .call(function(){[m[41m[m
[32m+[m[32m                // アニメーション終了時に現在表示していたマップの座標を0に戻し、消す[m[41m[m
[32m+[m[32m                CurrentContainer.x=0;[m[41m[m
[32m+[m[32m                DisplayContainer.removeChild(CurrentContainer);[m[41m[m
[32m+[m[32m              })[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          // 次のページの処理[m[41m[m
[32m+[m[32m          // 初期化[m[41m[m
[32m+[m[32m          NextContainer.x = canvasElement.width;[m[41m[m
[32m+[m[32m          DisplayContainer.addChild(NextContainer);[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(NextContainer,{override:false})[m[41m[m
[32m+[m[32m              // changetime[ms]で左方向に移動させる[m[41m[m
[32m+[m[32m              .to({x:0},changetime,createjs.Ease.cubicInOut)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          break;[m[41m[m
[32m+[m[32m        case "left":[m[41m[m
[32m+[m[32m          // 現在のページの処理[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            // changetime[ms]で右方向に移動させる[m[41m[m
[32m+[m[32m            createjs.Tween.get(CurrentContainer,{override:false},changetime)[m[41m[m
[32m+[m[32m              .to({x:canvasElement.width},changetime,createjs.Ease.cubicInOut)[m[41m[m
[32m+[m[32m              .call(function(){[m[41m[m
[32m+[m[32m                // アニメーション終了時に現在表示していたマップの座標を0に戻し、消す[m[41m[m
[32m+[m[32m                CurrentContainer.x=0;[m[41m[m
[32m+[m[32m                DisplayContainer.removeChild(CurrentContainer);[m[41m[m
[32m+[m[32m              })[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          // 次のページの処理[m[41m[m
[32m+[m[32m          // 初期化[m[41m[m
[32m+[m[32m          NextContainer.x = -1 * canvasElement.width;[m[41m[m
[32m+[m[32m          DisplayContainer.addChild(NextContainer);[m[41m[m
[32m+[m[32m          TimeLine.addTween([m[41m[m
[32m+[m[32m            createjs.Tween.get(NextContainer,{override:false})[m[41m[m
[32m+[m[32m              // changetime[ms]で右方向に移動させる[m[41m[m
[32m+[m[32m              .to({x:0},changetime,createjs.Ease.cubicInOut)[m[41m[m
[32m+[m[32m          );[m[41m[m
[32m+[m[32m          break;[m[41m[m
[32m+[m[32m      }[m[41m[m
[32m+[m[32m      TimeLine.gotoAndPlay("start");[m[41m[m
[32m+[m[32m    }[m[41m[m
[32m+[m[32m    // ここまでMAP切り替えの関数群 ------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m  }[m[41m[m
[32m+[m[32m  // ここまでmain ----------------------------------------------------------------------------------------------------[m[41m[m
[32m+[m[32m  // リサイズ時の処理 -------------------------------------------------------------------[m[41m[m
[32m+[m[32m  window.addEventListener('resize',Load); // 再ロードさせる[m[41m[m
[32m+[m[32m  // 画面更新 ---------------------------------------------------------------------------[m[41m[m
[32m+[m[32m  createjs.Ticker.timingMode = createjs.Ticker.RAF;[m[41m[m
[32m+[m[32m  createjs.Ticker.on("tick",function(){[m[41m[m
[32m+[m[32m    stage.update();[m[41m[m
[32m+[m[32m    DisplayContainer.updateCache();[m[41m[m
[32m+[m[32m  });[m[41m[m
 }[m
\ No newline at end of file[m
